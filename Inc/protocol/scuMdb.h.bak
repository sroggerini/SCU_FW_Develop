<<<<<<< .mine
/**
* @file        scuMdb.h
*
* @brief       Uart for RS485 SCU mobus communication  - Definition -
*
* @author      Nick
*
* @riskClass   C
*
* @moduleID
*
* @vcsInfo
*     $Id: scuMdb.h 763 2025-06-05 15:05:27Z npiergi $
*
*     $Revision: 763 $
*
*     $Author: npiergi $
*
*     $Date: 2025-06-05 17:05:27 +0200 (gio, 05 giu 2025) $
*
*
* @copyright
*       Copyright (C) 2016 SCAME S.p.A. All rights reserved.
*       This file is copyrighted and the property of Aesys S.p.A.. It contains confidential and proprietary
*       information. Any copies of this file (in whole or in part) made by any method must also include a copy of this
*       legend.
*       Developed by:  SCAME S.p.A.
***********************************************************************************************************************/


#ifndef _SCUMDB_H
#define _SCUMDB_H
#include "wrapper.h"
#include "Em_Task.h"
#include "sbcGsy.h"


// -------------------------- global defines --------------------------------------------------------------------------------- //
#define   LAST_ITEM                         ((uint16_t)0xFFFF)

#define   CURR_MODBUS_VERSION               ((uint16_t)24)

/** nel caso di SCU slave SBC SEM può interrogare solo indirizzi 1 e 2  **/
#define   MAX_ID_FOR_SCU_S                  ((uint8_t)2)

#define   SCU_M_P_ADDR                       ((uint8_t)1)   /* SCU working as principal SCU connected to SBC master has fixed address at 1          */ 
#define   SCU_M_P_ADDR_LOG                   ((uint8_t)0)   /* SCU working as principal SCU connected to SBC master has fixed address logical at 0  */ 
#define   SCU_S_S_ADDR                       ((uint8_t)2)   /* SCU working as secondary SCU connected to SCU principal with address 2               */ 
#define   SCU_S_S_ADDR_LOG                   ((uint8_t)1)   /* SCU working as secondary SCU connected to SCU principal with address logical 1       */ 
#define   SCU_M_P_OFFSET_ADDR                ((uint8_t)100) /* for other SCU the principal SCU has address 100 + local address                      */ 
#define   MODBUS_BROADCAST_ADDR              ((uint8_t)0)   /* address for broadcast message over modbus RS485                                      */ 
#define   SCU_S_REPL_ADDR                    ((uint8_t)99)  /* in SEM enviroment a the address for replacement board                                */ 

#define   SCU_S_S_COLLAUDO_ADDR              ((uint8_t)11)  /* SCU working as secondary SCU (after factory testing procedure)                       */ 
#define   SCU_SLAVE_PRINCIPAL_ADDR           ((uint8_t)11)  /* SCU working as principal  slave in a pillar                                          */ 
#define   SCU_SLAVE_SECONDARY_MAX_ADDR       ((uint8_t)14)  /* SCU working as secondary has this max value  in a pillar                             */ 

#define   MODBUS_MAX_LEN                     ((uint8_t)250) /* max numeber of data bytes  over modbus RS485       0x7D = 125 * 2 = 250              */ 

#define   FILE_COMMAND_MASK                  ((uint16_t)0x000F)
#define   FILE_COMMAND_BROAD                 ((uint16_t)0x000F)

#define   TIMER_UART_WD                      pdMS_TO_TICKS((uint16_t)60000)
#define   TIMER_UART_GARD_TIME               pdMS_TO_TICKS((uint16_t)500)

#define   TIMER_MDB_UART_ID                  ((uint16_t)0)

/* 2 min gard time to be sure that SBC has been powered correctly */
#define   TIMER_SBC_GARD_ID                  ((uint16_t)0)
#define   TIMER_SBC_GARD_TIME                pdMS_TO_TICKS((uint32_t)120000) 
/* 1 min gard time to be sure that SLAVE has been powered correctly */
#define   TIMER_SLAVE_GARD_ID                ((uint16_t)1)
#define   TIMER_SLAVE_GARD_TIME              pdMS_TO_TICKS((uint32_t)130000) 
#define   TIMER_GARD_BLOCK_TIME              pdMS_TO_TICKS((uint32_t)(100))

/* ----------- numero buffer nella coda di ricezione  -------------*/
#define   NUM_BUFF_SCU_RX                   ((uint16_t)8)
#define   NUM_BUFF_SCU_RX_TIMEOUT           ((uint16_t)8)
     
#define   NUM_BUFF_SCU_MSG_DL_TX            ((uint16_t)16)      
#define   NUM_BUFF_SCU_MSG_DL_RX            ((uint16_t)16)      

/**** mask bit for modbus map register   ****/
/* BIT MASK for REG_ERR_0 */
#define   LID_MASK                          ((uint16_t)0x0002)
#define   RCBO_MASK                         ((uint16_t)0x0080)
#define   PEN_ERR_MASK                      ((uint16_t)0x0010)
#define   VAC230_ZC_MASK                    ((uint16_t)0x1000)
#define   MIRROR_SEM_MASK                   ((uint16_t)0x0040)
#define   RCDM_SEM_MASK                     ((uint16_t)0x0001)
#define   PULS_SEM_MASK                     ((uint16_t)0x8000)

#define   ALL_CONF_PARS_EXT_FLASH_ADDR      ((uint32_t)0x140000)

/**       ---------------------------  DATA LINK MANAGER ----------------------------- **/

/********* -----------  USART1 -- SCUs  -------- ***************************/
/* Definition for USART SCU  clock resources We use UART1 PA10=Rx,PA9=TX, and PA12=DE  */
#define UART_SCU                           USART1
#define UART_SCU_HANDLE                    huart1
#define UART_SCU_DEFAULT_BR                ((uint32_t)19200)
#define UART_SCU_SINAPSI_BR                ((uint32_t)115200)
#define UART_SCU_CLK_ENABLE()              __HAL_RCC_UART1_CLK_ENABLE() 
#define UART_SCU_RX_GPIO_CLK_ENABLE()      __GPIOA_CLK_ENABLE()
#define UART_SCU_TX_GPIO_CLK_ENABLE()      __GPIOA_CLK_ENABLE()
#define DMAx_SCU_CLK_ENABLE()              __DMA2_CLK_ENABLE()

/* Definition for USARTx Pins */
#define UART_SCU_TX_PIN                    GPIO_PIN_9
#define UART_SCU_TX_GPIO_PORT              GPIOA
#define UART_SCU_TX_AF                     GPIO_AF7_USART1
#define UART_SCU_RX_PIN                    GPIO_PIN_10
#define UART_SCU_RX_GPIO_PORT              GPIOA
#define UART_SCU_RX_AF                     GPIO_AF7_UART1
#define UART_SCU_DE_PIN                    GPIO_PIN_12
#define UART_SCU_DE_GPIO_PORT              GPIOA
#define UART_SCU_DE_AF                     GPIO_AF7_UART1

/* Definition for USARTx's DMA */
#ifndef GD32F4xx
#define UART_SCU_TX_DMA_STREAM              GPDMA1_Channel1
#define UART_SCU_RX_DMA_STREAM              GPDMA1_Channel0
#else
#define UART_SCU_TX_DMA_STREAM              DMA2_Stream7
#define UART_SCU_RX_DMA_STREAM              DMA2_Stream5
#endif

#define UART_SCU_TX_DMA_CHANNEL             DMA_CHANNEL_4
#define UART_SCU_RX_DMA_CHANNEL             DMA_CHANNEL_4

/* Definition for USARTx's NVIC */
#define UART_SCU_DMA                        DMA2
#define UART_SCU_DMA_STREAM                 DMA2_Stream5
#define UART_SCU_DMA_TX_IRQn                DMA2_Stream7_IRQn
#define UART_SCU_DMA_RX_IRQn                DMA2_Stream5_IRQn
#define UART_SCU_DMA_TX_IRQHandler          DMA2_Stream7_IRQHandler
#ifndef GD32F4xx
#define UART_SCU_DMA_RX_IRQHandler          DMA2_Stream5_IRQHandler
#endif

/* Definition for USARTx's NVIC */
#define UART_SCU_IRQn                       USART1_IRQn
#define UART_SCU_IRQHandler                 USART1_IRQHandler

/* Dimensione massimo campo dati del messaggio   */
#define SCU_DL_RX_PAYLOAD_MAX_LEN       ((uint16_t)64)
#define SCU_DL_RX_MSG_MAX_LEN           ((uint16_t)(SCU_DL_RX_PAYLOAD_MAX_LEN + (uint16_t)10))
#define SCU_DMA_RX_BUFFER_SIZE          SCU_DL_RX_MSG_MAX_LEN
#define SCU_DL_TX_MSG_MAX_LEN           SCU_DL_RX_MSG_MAX_LEN

/* ----------- numero buffer nella coda di ricezione  -------------*/
#define   NUM_BUFF_SCU_DL_RX                ((uint16_t)2) 
     
#define   NUM_BUFF_SCU_MSG_DL_TX            ((uint16_t)16)      
#define   NUM_BUFF_SCU_MSG_DL_RX            ((uint16_t)16)      

/* ----------- Indici campi modbus RTU   -------------*/
//#define   IDX_ID_SCU                    ((uint8_t) 0)                           /* Indice numero SCU nel comando Modbus                                                         */
//#define   IDX_FUNCTION                  ((uint8_t) 1)                           /* Indice Function nel comando Modbus                                                           */
//#define   IDX_REG_ADDR_H                ((uint8_t) 2)                           /* Indice Indirizzo registro byte high nel comando Modbus                                       */
//#define   IDX_REG_ADDR_L                ((uint8_t) 3)                           /* Indice Indirizzo registro byte low nel comando Modbus                                        */
//#define   IDX_N_WORD_H                  ((uint8_t) 4)                           /* Indice Numero word byte high nel comando Modbus                                              */
//#define   IDX_N_WORD_L                  ((uint8_t) 5)                           /* Indice Numero word byte low nel comando Modbus                                               */
//#define   IDX_N_BYTE                    ((uint8_t) 6)                           /* Indice Numero di byte nel comando Modbus (solo scrittura)                                    */
//#define   IDX_FIRST_DATA_BYTE           ((uint8_t) 7)                           /* Indice Primo byte di data nei comandi di scrittura                                           */        

/* ----------- Indici campi modbus TCP (richiesto per app ios)  -------------*/
#define   IDX_COUNTER_H                 ((uint8_t) 0)                            /* Indice contatore progressivo inizio pacchetto Modbus TCP                                      */
#define   IDX_COUNTER_L                 ((uint8_t) 1)                            /* Indice contatore progressivo inizio pacchetto Modbus TCP                                      */
#define   IDX_LEN_PAYL_H                ((uint8_t) 4)                            /* Indice Lunghezza payload nel protocollo MODBUS TCP byte high                                  */
#define   IDX_LEN_PAYL_L                ((uint8_t) 5)                            /* Indice Indirizzo registro byte low nel comando Modbus                                         */
#define   IDX_ID_SCU                    ((uint8_t) 6)                            /* Indice numero SCU nel comando Modbus                                                          */
#define   IDX_FUNCTION                  ((uint8_t) 7)                            /* Indice Function nel comando Modbus                                                            */
#define   IDX_REG_ADDR_H                ((uint8_t) 8)                            /* Indice Indirizzo registro byte high nel comando Modbus                                        */
#define   IDX_REG_ADDR_L                ((uint8_t) 9)                            /* Indice Indirizzo registro byte low nel comando Modbus                                         */
#define   IDX_N_WORD_H                  ((uint8_t) 10)                           /* Indice Numero word byte high nel comando Modbus                                               */
#define   IDX_N_WORD_L                  ((uint8_t) 11)                           /* Indice Numero word byte low nel comando Modbus                                                */
#define   IDX_N_BYTE                    ((uint8_t) 12)                           /* Indice Numero di byte nel comando Modbus (solo scrittura)                                     */
#define   IDX_FIRST_DATA_BYTE           ((uint8_t) 13)                           /* Indice Primo byte di data nei comandi di scrittura                                            */        


#define   IDX_CHNL_NUMB_CIPSEND         ((uint8_t) 11)                           /* Indice al byte del comando AT+CIPSEND dove scrivere il numero del canale su cui comunicare    */

/* ----------- Indici registro PROCEDURE_RESPONSE_RO  -------------*/
#define   IDX_RESP_REQ_BYTE             ((uint8_t) 0)                            /* Indice byte 0 PROCEDURE_RESPONSE_RO contenente la richiesta fatta                             */                
#define   IDX_RESP_STATUS_BYTE          ((uint8_t) 1)                            /* Indice byte 1 PROCEDURE_RESPONSE_RO contenente lo stato di elaborazione della procedura       */
#define   IDX_RESP_RESULT_BYTE          ((uint8_t) 2)                            /* Indice byte 2 PROCEDURE_RESPONSE_RO contenente l'esito della procedura                        */
#define   IDX_RESP_DETAIL_BYTE          ((uint8_t) 3)                            /* Indice byte 3 PROCEDURE_RESPONSE_RO contenente il dettaglio dell'esito della procedura        */

/* ----------- Flag per risposte errori comandi modbus  -----------*/
#define   REC_ILLEGAL_ADDRESS           ((uint8_t) 1)                            /* Received modbus command with illegale address                                                 */
#define   REC_ILLEGAL_ADDRESS_RST       ((uint8_t) 0)                            /* Reset flag illegal address command modbus received                                            */ 

/* MAPPA COMANDI MACCHINA DI COLLAUDO */
#define   TM_CONTATTORE_MASK            ((uint16_t)0x0001)                        /* Flag Mask for contactor command                                    */ 
#define   TM_CONTATTORE_ON              ((uint16_t)0x0001)                        /* Flag status ON for contactor                                       */ 
#define   TM_MODO_FREE_MASK             ((uint16_t)0x0004)                        /* Flag Mask for modo free command                                    */ 
#define   TM_MODE_FREE_ON               ((uint16_t)0x0004)                        /* Flag status ON for modo free                                       */ 


typedef enum
{
  SCU_NO_REQ_ANSWER = 0x0000,       /* Message right, answer not necessary   */ 
  SCU_SEND_ANSWER   = 0x0001,       /* Message right, answer  necessary    */ 
  SCU_ADDRESS_ERROR = 0x0002,       /* Message with address wrong  */ 
  SCU_MSG_ERROR     = 0x0003,       /* Message wrong  */ 
  SCU_DEFAULT_ANSW  = 0xFFFF
} scuMsgResult_e;


/**       ---------------------------  SCU OPERATIVE MODES  -------------------------------- **/
typedef enum
{
  SCU_EMUMAX0_S     = 0x0000,       /* SCU is working as MAX0 in slave position on RS485 bus                    */ 
  SCU_EMUMAX0_M     = 0x0001,       /* SCU is working as MAX0 in master position on RS485 bus                   */ 
  SCU_M_P           = 0x0002,       /* SCU is working as principal SCU connected to SBC master                  */ 
  SCU_S_P           = 0x0003,       /* SCU is working as principal SCU connected to SBC (TFT) slave             */ 
  SCU_S_S           = 0x0004,       /* SCU is working as secondary SCU connected to SCU principal on RS485 bus --> PUT @VALUE 6 TO AVOID WARNINGS IN COMPILE TIME */ 
  SCU_M_STAND_ALONE = 0x0005,       /* SCU is working as a master in stand alone mode */
  SCU_NUM_MODES     = 0x0006,
  SCU_MODE_UNDEF    = 0xFFFF
} scuOpModes_e;

typedef enum
{
  SCU_SEM_M           = 0x0000,       /* SCU is working with SEM as master           */ 
  SCU_GSY             = 0x0001,       /* SCU is working with GSY                     */ 
  SCU_SEM_S           = 0x0002,       /* SCU is working with SEM as slave            */ 
  SCU_SEM_MS          = 0x0003,       /* SCU is working with SEM as secondary master */ 
  SCU_SEM_STAND_ALONE = 0x0004,       /* SCU is working with SEM out of the WB or Pillar */ 
  SCU_NUM_TYPE        = 0x0005,
  SCU_MASK_TYPE       = 0x0007,
  SCU_TYPE_UNDEF      = 0x00FF
}scuTypeModes_e;

typedef enum
{
  SCU_S_PS_STARTUP        = 0x0004,       /* code to search SCU  working as secondary SCU  on RS485 bus  at startup   */ 
  SCU_S_PS_LIVE           = 0x0005,       /* code to search SCU  working as secondary SCU  on RS485 bus  at live      */ 
  SCU_S_PS_NEW            = 0x0006,       /* code to search new SCU  working as secondary SCU  on RS485 bus  at live  */ 
  SCU_ALL_FACTORY_PARAM   = 0xFFEC,       /* code to restore on all SCU the factory parameters                        */ 
  SCU_SEARCH_UNDEF        = 0xFFFF
} scuSearchCode_e;


/**       ---------------------------  SCU SEM CONTROL BITS FLAGS   -------------------------------- **/
typedef enum
{
  SCU_TEMPORARY_ADDR  = 0x0000,       /* SCU address is temporary and could be changed in discovery phase */ 
  SCU_FIXED_ADDR      = 0x0001,       /* SCU address is fixed and couldn't be changed in discovery phase */ 
  SCU_ADDR_MODE_MASK  = 0x0001,

  SCU_SKT_NUM_MASK    = 0x000E        /* socket number inside the product 1..4                            */
}scuAddModeSktNum_e;

/**       ---------------------------  SCU SPERIMENTAL MODES  -------------------------------- **/

typedef enum
{
  SCU_SINAPSI_NOT_PRESENT   = 0x00,    /* SINAPSI board not present                             */ 
  SCU_SINAPSI_PRESENT       = 0x01,    /* SINAPSI board present but with bluetooth OFF          */
  SCU_SINAPSI_BT_ON         = 0x02     /* SINAPSI board present and bluetooth ON                */
} sinapsiStateApp_e;


/**       ---------------------------  SCU RS485 L3  MANAGER ----------------------------- **/
/* define for task request */

typedef enum
{
  TX_TO_SCU           = 0x00,      /* Request to send a msg to SCU     */ 
  TX_TO_SCU_TIMEOUT   = 0x01,      /* polling request                  */ 
  RX_FROM_SCU         = 0x02,      /* Request to take a msg from SCU   */
  TX_TO_WIFI          = 0x03,      /* Request to send a msg to Wi-Fi   */
  RX_FROM_WIFI        = 0x04,      /* Request to take a msg from Wi-Fi */     
  SCU_ERROR           = 0xFFFF     /* Error on uart   */ 
} scuMsgDir_e;

typedef enum
{
  SCU_IDLE            = 0x0000,       /* initial state                    */ 
  SCU_OPERATIVE       = 0x0001,       /* normal condition                 */ 
  SCU_REQ_INT_RD_WR   = 0x0002,       /* internal read or write request   */ 
  SCU_DUMMY           = 0xFFFF
} scuStates_e;

typedef enum
{
  SCU_DL_IDLE     = 0x0000,       /* initial state   */ 
  SCU_DL_READY    = 0x0001,       /* ready state     */ 
  SCU_DL_READING  = 0x0002,       /* reading phase    */ 
  SCU_DL_WRITING  = 0x0003,       /* writing phase    */ 
  SCU_DL_PH_DUMMY = 0xFFFF
} scuDlStates_e;

typedef enum
{
  SCU_EVENT_START             = 0x00,      /* timeout evet                                                                    */ 
  SCU_EVENT_RD_ANSW_WR_REQ,                /* incoming RD answer or WR request message SCU side                               */ 
  SCU_EVENT_RD_REQ_WR_ACK,                 /* incoming RD request or WR ack answer message SCU side                           */ 
  SCU_EVENT_MSG_FROM_SBC,                  /* incoming message SBC side                                                       */ 
  SCU_EVENT_MSG_INTERNAL_WR,               /* an internal task ask to send a message to write a reg: an example is for debug  */ 
  SCU_EVENT_MSG_INTERNAL_RD,               /* an internal task ask to send a message to read a reg: an example is for debug   */ 
  SCU_EVENT_MSG_NO_ANSWER,                 /* no answer at the previous request                                               */
  SCU_EVENT_MSG_FROM_WIFI,                 /* incoming message from Wi-Fi module                                              */       
  SCU_EVENT_DUMMY = 0xFFFF
} scuEvents_e;

typedef enum
{
  SCU_DL_START                = 0x00,       /* start data link                                                                 */ 
  SCU_DL_SEND,                              /* send a frame                                                                    */ 
  SCU_DL_RX_IDLE,                           /* IDLE detected                                                                   */
  SCU_DL_RECEIVE_FROM_RS485,                /* received frame                                                                  */ 
  SCU_DL_TIMEOUT,                           /* elapsed timerout                                                                */ 
  SCU_DL_ERR_UART,                          /* error on uart                                                                   */
  SCU_DL_RX_COLLAUDO,                       /* ricezione messaggio dalla macchina di collaudo                                  */
  SCU_DL_CHANGE_TO_SEM,                     /* error on uart due to wrong enviroment we are in SEM but set in EMUMAX           */
  SCU_DL_CHANGE_TO_SEM_FROM_TEST,           /* vhange from SEM to EMUMAX0 at the end of all automatic test                     */
  SCU_DL_DUMMY = 0xFFFF
} scuDlEvents_e;

typedef enum
{
  SCU_DL_OP_RD                = 0x00,       /* read operation                                                                  */ 
  SCU_DL_OP_WR,                             /* write operation                                                                 */ 
  SCU_DL_OP_DUMMY = 0xFFFF
} scuDlOp_e;

typedef __packed struct
{
  uint32_t    microId1;
  uint32_t    microId2;
  uint32_t    microId3;
} microId_t;

/* define error code for SCU */
typedef enum
{
  SCU_NO_ERROR     = 0,            /* no error                          */ 
  SCU_REG_UNDEF,                   /* Register undefined                */ 
  SCU_NO_ANSWER                    /* SCU not answering                  */ 
} scuError_e;

/* define for register type  */
typedef enum
{
  BIG_ENDIANESS = 0,
  LITTLE_ENDIANESS
} endianessType_e;

/* define for register type  */
typedef enum
{
  RO     = 0,                      /* read only register                */ 
  RW,                              /* read/write register               */ 
  WO
} regType_e;

/* define error code for modbus */
typedef enum
{
  NO_ERROR     = 0,           /* no error                      */ 
  MB_ILLEGAL_FUNC = 1,        /* Register undefined            */ 
  MB_ILLEGAL_ADDR,            /* Illegal address               */ 
  MB_ILLEGAL_DATA,            /* Illegal dats                  */ 
  MB_NAK = 0x07               /* negative ACK                  */ 
} mbError_e;

/* define SCU index registers linked strictly to const scuRegInfo_st   scuRegister[SCU_LAST_REG_IDX] */
typedef enum
{
  BOARD_FW_VERSION_RO      = 0,         /* Campo ASCII contenente la versione del main firmware                                      0 */ 
  MIFARE_FW_VERSION_RO     = 1,         /* Versione FW del lettore RFID                                                                */ 
  BOARD_SN_RO,                          /* Numero di serie della scheda                                                                */ 
  PLC_FW_VERSION_RO,                    /* Campo ASCII versione FW del modulo PLC (solo stazione DC)                                   */ 
  PLC_MAC_ADDRESS_RO,                   /* MAC address del modulo PLC (solo stazione DC)                                               */
  HW_REVISION_RO,                       /* Revisione hardware della SCU                                                                */
  WIFI_MAC_ADDRESS_RO,                  /* MAC address del modulo Wi-Fi Espressif                                                      */
  POWER_MODULE_SN_RO,                   /* Numero di serie del modulo di potenza inserito nella EVSE                                   */
  BLE_MAC_ADDRESS_RO,                   /* MAC address del modulo Bluetooth                                                            */
  PRODUCT_SN_RO,                        /* Numero di serie del prodotto Scame                                                          */
  PRODUCT_CODE_RO,                      /* Codice prodotto di Scame                                                                 10 */ 
  BOOT_FW_VERSION_RO,                   /* Campo ASCII contenente la versione del boot firmware                                        */ 
  MODBUS_FW_VERSION_RO,                 /* Campo binario contenente la versione del modbus                                             */ 
  SCU_RESERVED1,                        /* Reserved for future use                                                                     */ 
  NOTIFY_EVSE_PRESENCE_RO,              /* Indica quanti e quali indirizzi sono presenti nel sistema                                   */ 
  NOTIFY_EVSE_CHANGE_RO,                /* Registro per segnalare un cambiamento di stato (prevedere autocleaning)                     */ 
  EVSE_ERROR1_RO,                       /* Registro 1 per segnalare allarmi e/o errori                                                 */ 
  EVSE_ERROR2_RO,                       /* Registro 2 per segnalare allarmi e/o errori                                                 */ 
  EVSE_CHANGE_REGISTERS_RO,             /* registro che notifica lo stato della stazione                                               */ 
  SCU_RESERVED2,                        /* Reserved for future use                                                                     */ 
  APP_EXCHANGE_AREA_RO,                 /* Area used by app to exchange data with SCU                                                  */   
  /* -------------- Inizio dei parametri Read-Only eventi --> 0x600                                         --------------             */                         
  EVSE_EVENT_FLAGS_RO,                  /* contiene lo stato del connettore tethered                                                21 */ 
  EVSE_CHARGE_STATUS_RO,                /* registro che notifica lo stato della stazione                                               */ 
  TEMPERATURE_SYSTEM_RO,                /* temperatura del sistema (quella rilevata dal uP nel caso AC)                                */ 
  SCU_RESERVED3,                        /* Reserved for duture use                                                                     */ 
  VOLTAGE_AC_RO,                        /* Tensione di alimentazione del sistema (parametro OCCP)                                      */ 
  CURRENT_AC_L1_RO,                     /* Corrente fase 1 (parametro OCCP)                                                            */ 
  CURRENT_AC_L2_RO,                     /* Corrente fase 2 (parametro OCCP)                                                            */ 
  CURRENT_AC_L3_RO,                     /* Corrente fase 3 (parametro OCCP)                                                            */ 
  ACTIVE_POWER_DC_RO,                   /* Potenza attiva del sistema DC  (parametro OCPP)                                             */ 
  ACTIVE_POWER_AC_RO,                   /* Potenza attiva del sistema     (parametro OCCP)                                             */ 
  CURRENT_AC_SYS_RO,                    /* Corrent di sistema (mono / trifase) (parametro OCCP)                                     31 */ 
  REACTIVE_POWER_AC_RO,                 /* Potenza reattiva del sistema   (parametro OCCP)                                             */ 
  TOTAL_ACTIVE_ENERGY_AC_EV_RO,         /* Energia attiva del sistema     (parametro OCCP)                                             */ 
  TOTAL_ACTIVE_ENERGY_DC_EV_RO,         /* Energia attiva del sistema DC  (parametro OCCP)                                             */ 
  TOTAL_REACTIVE_ENERGY_AC_EV_RO,       /* Energia reattiva del sistema   (parametro OCCP)                                             */
  TRANSACTION_ACTIVE_ENERGY_AC_EV_RO,   /* Energia attiva parziale relativa alla sessione corrente    (parametro OCCP)                 */ 
  ACTIVE_POWER_AC_L2_RO,                /* Potenza attiva fase L2                                                                      */ 
  TRANSACTION_REACTIVE_ENERGY_AC_EV_RO, /* Energia reattiva parziale relativa alla sessione corrente  (parametro OCCP)                 */
  FREQUENCY_SUPPLY_RO,                  /* Frequenza di rete     (parametro OCCP)                                                      */ 
  SCU_RESERVED4,                        /* Reserved (usati per stazione DC)                                                            */ 
  MAX_CURRENT_ROTATORY_SWITCH_RO,       /* Corrente impostata nel selettore rotativo                                                41 */ 
  UNDEFINED_EX_RSC_CURR_RDD,            /* Corrente massima di sistema                                                                 */ 
  ACTIVE_POWER_AC_L3_RO,                /* Potenza attiva fase L2                                                                      */ 
  EMPTY_063A,
  MAX_CURRENT_RESULT_RO,                /* Corrente massima di carica risultante dai vari calcoli e confronti                          */ 
  TRANSACTION_TIME_RO,                  /* Tempo in secondi, trascorsi dall'inizio della carica                                        */ 
  TRANSACTION_COUNTDOWN_RO,             /* Tempo, in secondi, rimanenti al completamento della carica                                  */ 
  EV_BATTERY_RO,                        /* percentuale della carica della batteria  (parametro OCCP)                                   */ 
  SESSION_ID_RO,                        /* identificatore univoco della sessione di carica                                          48 */ 
  EVSE_BOOT_EVENT_RO,                   /* flag di notifica reset di sistema                                                           */ 
  TOTAL_ACTIVE_ENERGY_AC_GRID_RO,       /* Energia attiva totale con funzionalità GRID V2G                                          50 */
  TOTAL_REACTIVE_ENERGY_AC_GRID_RO,     /* Energia reattiva totale con funzionalità GRID V2G                                           */
  TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO, /* Energia attiva erogata durante una transazione, funzionalità GRID V2G                       */
  TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO,  /* Energia reattiva erogata durante una transazione, funcionalità GRID V2G                  */ 
  SCU_RESERVED6,                        /*                                                                                             */
  UID_AUTHORIZATION_RO,                 /* valore UID della card letta                                                                 */ 
  TIME_CHARGE_RO,                       /* tempo ricarica effettivo                                                                    */ 
  SCU_RESERVED6B,                       /* -------------- Fine dei parametri Read-Only si passa a quelli RW --------------             */

  CONNECTOR_TYPE_RW,                    /* Registro per modificare configurazione Hardware                                          58 */ 
  HWC_FLAGS_RW,                         /* Flag componenti hardware aggiuntivi                                                         */                          
  ENERGY_METERS_RW,                     /* tipo di energy meter                                                                     60 */ 
  POWER_OUTAGE_TYPE_RW,                 /* Hardware impiegato per l'assenza di tensione                                                */
  CONNECTOR_IDS_RW,                     /* Modifica indirizzo modbus usato come alias della scheda                                     */ 
  BOARD_SN_RW,                          /* Numero di serie della stazione                                                              */ 
  PRODUCT_SN_RW,                        /* Numero di serie del prodotto                                                                */ 
  MASTER_HW_TYPE_RW,                    /* Configurazione master / slave                                                               */ 
  UTC_DATE_TIME_RW,                     /* data e ora correnti letti da RTC                                                            */ 
  POWER_MODULE_BRAND_RW,                /* Indica la marca del produttore del caricabatteria (solo DC)                                 */ 
  POWER_MODULE_MODEL_RW,                /* Indica la marca del modello del caricabatteria (solo DC)                                 68 */ 
  POWER_MODULE_N_RW,                    /* Indica il numero di moduli installati al sistema  (solo DC)                              69 */ 
  EVSE_TM_MODE_RW,                      /* Abilitazione macchina di collaudo         a                                              70 */ 
  EVSE_OPERATION_MODE_RW,               /* In dica la modalità di funzionamento del sistema di ricarica                                */ 
  CHARGE_PROTOCOL_SELECTED_RW,          /* Indica con quale connettore effettuare la ricarica (solo DC)                                */ 
  DISPLAY_DEFAULT_LANGUAGE_RW,          /* Indica la lingua utilizzata dal sistema                                                     */ 
  HW_CHECKS1_RW,                        /* Registro per abilitazione errori e configurazioni HW                                        */ 
  HW_CHECKS2_RW,                        /* Registro per abilitazione errori e configurazioni HW                                        */ 
  HW_ACTUATORS_RW,                      /* Registro per la configurazione degli attuatori del sistema                                  */ 
  SCU_RESERVED7,                        /* Registri riservati per stazione DC                                                          */         
  MAX_TEMPORARY_CURRENT_RW,             /* Parametro PID per sistema AC                                                             78 */ 
  UNDEFINED_EX_LIM_LOW_CURR_RWD,        /* Imposta la corrente minima di ricarica                                                   79 */ 
  LED_STRIP_RWD,                        /* Registro utilizzato per impostare numero led nella strip                                 80 */ 
  REMOTE_COMMANDS_RW,                   /* Emulazione stato pressione del pulsante remoto                                              */ 
  ENVIRONMENT_BRIGHTNESS_RW,            /* Valore di luminosità letto dal sensore                                                      */ 
  UNDEFINED_EX_PRX_DIST_RWD,            /* Indica la distanza rilevata dal sensore                                                     */ 
  UNDEFINED_EX_PRX_MOTION_RWD,          /* Registro flag che indica presenza di movimento rilevata                                     */ 
  MAX_TEMPORARY_POWER_AC_RW,            /* Parametro per impostare potenza massima temporanea AC disponibile                        85 */ 
  PM_MODE_RW,                           /* registro utilizzato per la modalità di funzionamento del Power Management                   */ 
  ENABLE_LOG_RW,                        /* abilitazione log su SD (solo DC)                                                            */ 
  AUTHORIZATION_FEEDBACK_RW,            /* in modalità NET autorizza e controlla la carica                                          88 */ 
  TIMEZONE_RW,                          /* registro per gestire il time zone rispetto a UTC                                         89 */ 
  MENU_VISIBILITY_RW,                   /* registro per impostare la visibilità di alcuni menù della stazione AC                    90 */ 
  TIMEOUT_RANGE1_RW,                    /* registro per impostare il valore di partenza del counter 1                                  */ 
  TIMEOUT_RANGE2_RW,                    /* registro per impostare il valore di partenza del counter 2                                  */
  PRODUCT_CODE_RW,                      /* Codice prodotto SCAME                                                                       */
  TECN_PRODUCT_CODE_RW,                 /* Codice prodotto fake SCAME                                                                  */
  CONNECTOR_N_RW,                       /* Numero della presa all'interno della EVSE                                                   */
  DISPLAY_LANGUAGES_ENABLED_RW,         /* Lingua impostata e di default della EVSE                                                    */
  MAX_TYPICAL_CURRENT_RW,               /* Massima corrente in modalità tipica                                                         */
  MAX_SIMPLIFIED_CURRENT_RW,            /* Massima corrente in modalità semplificata                                                98  */
  CHARGE_TIME_RW,                       /* Tempo di carica massimo per Power Management                                             99 */
  CHARGE_MAX_ENERGY_RW,                 /* Massima potenza totale utilizzabile in una carica                                       100 */                          
  PM_IMIN_RW,                           /* Corrente minima con funzione Power Management                                               */
  PM_PMAX_RW,                           /* Potenza massima con funzione Power Management                                               */
  PM_FLAGS_RW,                          /* Flag di abilitazione funzione Power Management                                              */
  PM_HPOWER_RW,                         /* Isteresi soglia di potenza con funzione Power Management                                    */
  PM_DSET_RW,                           /* Valore di variazione della potenza erogata, funzione Power Management                       */
  PM_DMAX_RW,                           /* Valore di isteresi della potenza in eccesso, funzione Power Management                      */ 
  PIN_EXTERNAL_ENERGY_METER_RW,         /* Pin di energy meter esterno                                                                 */         
  LIM_MAX_POWER_AC_RW,                  /* massima potenza AC                                                                      108 */ 
  RESERVED_A,                           /* reserved for future use                                                                     */ 
  FILE_COMMAND_RW,                      /* Comando per avviare l'aggiornamento SW                                                  110 */ 
  FILE_SIZE_RW,                         /* Registro con indicazione del size del file da caricare                                      */ 
  FILE_PACKET_RW,                       /* Registro con indicazione del numero pacchetti del file da caricare                          */ 
  
  /****          definizioni identificatori  per l'ambiente SINAPSI - RSE ************************************************************ */
  IOM_CTRL,                             /*                                                                                             */
  M2_PAII_TS,                           /*                                                                                             */
  M2_PAII,
  M2_PC_TS,                             /*                                                                                             */     
  M2_PC,
  M1_PC_TS,
  M1_PC,                                                                                                                           
  M1_PD_TS,
  M1_PD,                                /*                                                                                         122 */
  M1_PAPI_TS,                           /*                                                                                             */        
  M1_PAPI,                              
  M1_PAII_TS,                           
  M1_PAII,
  M1_RES_DIST_TS,                       /*                                                                                             */      
  M1_TIME_RES_DIST,                      
  M1_PFO_TS,
  M1_PFO,                                
  M1_PMRTLIM,
  M1_PMRTLIM_TS,                        /*                                                                                         132 */
  M1_SOSP_RIC_TLIM,                     /*                                                                                             */     
  M1_UT_SYNC,                                  
  SET_CONFIG_MODE,                                      
  
  /****          definizioni identificatori  per l'ambiente test PEN **************************************************************    */
  PEN_RELE,                             /*                                                                                             */ 
  
  /****          definizioni identificatori  per l'ambiente MACCHINA DI COLLAUDO  *************************************************    */
  TM_MEASURED_CURRENT_RW,               /* Corrente misurata dall'EM interno alla macchina di collaudo                             137 */
  TM_MEASURED_VOLTAGE_RW,               /* Tensione misurata dall'EM interno alla macchina di collaudo                                 */
  TM_COMMAND_RW,                        /* Registro per comandi da eseguire durante il collaudo                                        */
  TM_ADDR_S_CONN_RW,                    /* Registro notifica scheda collegata tramite ponticello J1-J2                                 */
  TM_ADDR_REQ_RW,                       /* Registro per comandi fase di richiesta indirizzamento automatico                            */
  TM_ADDR_ASS_RW,                       /* Registro per comandi fase di assegnazione indirizzamento automatico                         */
  TM_ERROR1_IN_TEST_RO,                 /* registro errori durante la fase di collaudo                                                 */
  TM_UID_MASTER_RW,                     /* Registro per scrittura UID carta Master                                                     */
  TM_UID_USER_RW,                       /* Registro per scrittura UID carta Master                                                     */
  TM_MEASURED_CURRENT_L2_RW,            /* Corrente misurata dall'EM interno alla macchina di collaudo  L2 (solo trifase)          146 */
  TM_MEASURED_VOLTAGE_L2_RW,            /* Tensione misurata dall'EM interno alla macchina di collaudo  L2 (solo trifase)              */
  TM_MEASURED_CURRENT_L3_RW,            /* Corrente misurata dall'EM interno alla macchina di collaudo  L3 (solo trifase)          148 */
  TM_MEASURED_VOLTAGE_L3_RW,            /* Tensione misurata dall'EM interno alla macchina di collaudo  L3 (solo trifase)              */
  TM_GET_EEPROM_INFO,                   /* Richiesta lettura parametri in EEPROM                                                       */
  
  /****          definizioni identificatori  per l'ambiente APP WIFI  *************************************************************    */
  CONNECTOR_INIT_STATUS_RO,             /* Stato di attivazione della presa                                                            */
  CONNECTOR_OPERATION_STATUS_RO,        /* Stato IDLE o meno della presa (c'è attiva o meno una procedura?? Richiesto da Enrico    152 */ 
  PROCEDURE_RESPONSE_RO,                /* Esito procedura SCU richiesta dalla App                                                     */
  PM_TOTAL_POWER_RO,                    /* Potenza totale esterna                                                                      */
  PM_L1_POWER_RO,                       /* Potenza esterna fase 1                                                                      */
  PM_L2_POWER_RO,                       /* Potenza esterna fase 2                                                                      */
  PM_L3_POWER_RO,                       /* Potenza esterna fase 3                                                                      */
  USER_LOGIN_RO,                        /* Tipologia di utente che ha fatto il login                                                   */
  CONNECTOR_CHECK_ACTIV_KEY_RW,         /* Controllo pin di attivazione presa con quello riportato nel manuale                         */
  CONNECTOR_NAME_RW,                    /* Nome presa scelto dall'utente                                                               */
  CONNECTOR_PIN_RW,                     /* Pin presa scelto dall'utente in fase di Init                                                */
  ROUTER_NET_SSID_RW,                   /* SSID della rete del router domestico                                                    162 */
  ROUTER_NET_PASSWORD_RW,               /* Password della rete del router domestico                                                    */
  CONNECTOR_ROUTER_IP_RW,               /* Indirizzo IP assegnato dal router al modulo Espressif                                       */
  PROCEDURE_REQUEST_RW,                 /* Richiesta di una procedura da parte della App                                               */
  SCHEDULE_FLAG1_RW,                    /* Flag di attivazione schedulazione 1                                                         */
  SCHEDULE_START1_RW,                   /* Orario di start della carica schedulata 1                                                   */
  SCHEDULE_STOP1_RW,                    /* Orario di stop della carica schedulata 1                                                    */
  SCHEDULE_POWER1_RW,                   /* Massima potenza impostabile per la schudulazione 1                                          */
  SCHEDULE_FLAG2_RW,                    /* Flag di attivazione schedulazione 2                                                         */
  SCHEDULE_START2_RW,                   /* Orario di start della carica schedulata 2                                                   */
  SCHEDULE_STOP2_RW,                    /* Orario di stop della carica schedulata 2                                                172 */
  SCHEDULE_POWER2_RW,                   /* Massima potenza impostabile per la schudulazione 2                                          */
  SCHEDULE_FLAG3_RW,                    /* Flag di attivazione schedulazione 3                                                         */
  SCHEDULE_START3_RW,                   /* Orario di start della carica schedulata 3                                                   */
  SCHEDULE_STOP3_RW,                    /* Orario di stop della carica schedulata 3                                                    */
  SCHEDULE_POWER3_RW,                   /* Massima potenza impostabile per la schudulazione 3                                          */
  SCHEDULE_FLAG4_RW,                    /* Flag di attivazione schedulazione 4                                                         */
  SCHEDULE_START4_RW,                   /* Orario di start della carica schedulata 4                                                   */
  SCHEDULE_STOP4_RW,                    /* Orario di stop della carica schedulata 4                                                    */
  SCHEDULE_POWER4_RW,                   /* Massima potenza impostabile per la schudulazione 4                                          */
  CONNECTOR_CONNECTION_STATUS_RO,       /* Stato di connessione ad una rete domestica                                              182 */
  MAX_POWER_RO,                         /* Massima potenza stazione per settaggio tachimetro su APP                                    */        
  RANDOM_DELAY_FLAG_RW,                 /* Registro per abilitare/disabilitare il ritardo randomico sulle schedulazioni                */        
  UID_AUTHORIZATION_APP_RW,             /* Registro per modalità PERSONAL BY APP richiesta dal marketing. UID app                      */ 
  BT_SINAPSI_STATUS_RW,                 /* Registro per lo stato del bluetooth della scheda Sinapsi                                    */
  FW_UPDATE_NAME_RW,                    /* Registro per settare il nome del file del nuovo fw che si vuole installare                  */
  FW_UPDATE_LEN_RW,                     /* Registro per settare la lunghezza dei byte del nuovo fw che si vuole installare             */
  FW_UPDATE_STATUS_RO,                  /* Registro per segnalare l'esito di un'aggiornamento firmware da app                          */ 
  EVSE_POWER_MODE_RO,                   /* Registro per mostrare se è trifase o monofase l'alimentazione                               */ 
  
  /****          definizioni identificatori  per SIMULATORE EM LOVATO Ethernet    *************************************************    */
  EM_LOVATO_SIM_V_SYS,                  /* tensione di fase                                                                       191  */
  EM_LOVATO_SIM_P_AREA,                 /* elenco delle potenze delle varie stazioni                                                   */
    
  /****          end definitions  ************************************************************** */
  SCU_LAST_REG_IDX,                     /* last index                                                                             193  */ 
  SCU_SBC_DUMMY                         /* index register not used                                                                     */ 
} scuAllRegIdx_e;


/* ----------- Transmission definition to SCU   -------------*/
typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint8_t     payload[SCU_DL_TX_MSG_MAX_LEN];
} headerSCU_t;


typedef __packed union
{
  headerSCU_t           nodeReadInputReg;
} messageScuTx_u;


typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint16_t    regAdd;
  uint16_t    numWords;
  uint8_t     numBytes;
  uint16_t    data[SCU_DL_RX_PAYLOAD_MAX_LEN];
} scuRWmultipleReg_st;

typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint8_t     numBytes;
  uint8_t     data[MODBUS_MAX_LEN];
} headerAnwsRIR_t;

typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint8_t     numBytes;
  uint8_t     data;
} scuAnwsRIR_t;


typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint16_t    regAdd;
  uint16_t    numWord;
} headerAnwsWMR_t;

typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint8_t     errorCode;
} headerAnwsError_t;


typedef __packed union
{
  nodeRWsingleReg_st    nodeRWsingleReg;
  headerRIR_t           nodeReadInputReg;
  headerRHR_t           nodeReadHoldingReg;
  scuRWmultipleReg_st   nodeRWmultipleReg;
  nodeWsingleReg_st     nodeWsingleReg;
  headerAnwsRIR_t       headerAnwsRIR; 
  headerAnwsWMR_t       headerAnwsWMR;
  headerAnwsError_t     headerAnwsError;
  scuAnwsRIR_t          scuAnwsRIR;
  frameSbcRx_st         frameSbcRx;
} ScuMessage_u;


typedef __packed struct
{
  uint16_t            totalLen;
  uint8_t*            pMessage;
  uint16_t            idSCU;          /* address on RS485 1..16                   */
  uint16_t            reqRegAddr;     /* address register required                */
  scuAllRegIdx_e      scuRegIdx;      /* index of the request register            */
  scuEvents_e         scuEvents;
  scuMsgDir_e         scuMsgDir;
} frameScu_st;


/* ----------- Receive  definition from  SCU   -------------*/
typedef __packed struct
{
  scuDlEvents_e       dlEvent;
  scuDlOp_e           scuDlOp;
  uint16_t            idSCU;          /* address on RS485 1..16                   */
  uint16_t            reqRegAddr;     /* address register required                */
  scuAllRegIdx_e      scuRegIdx;      /* index of the request register            */
  uint16_t            totalLen;
} headerScuRx_st;


typedef __packed struct
{
  uint8_t     startFrame;
  uint8_t     address;
  uint8_t     len;
  uint8_t     payload[SCU_DL_RX_PAYLOAD_MAX_LEN];
} reqScuUser_st;


typedef __packed union
{
  reqScuUser_st         reqScuUser;
  uint8_t               msgComplete[NUM_BUFF_SCU_DL_RX];
} messageScuRx_u;

/* define for SCU single registers  info */
typedef __packed struct
{
  uint16_t    regAdd;
  uint16_t    size;           /* number of word to be read/write for the specified reg address  */
  regType_e   regType;        /* register type                                                  */
} scuRegInfo_st;

/* SCU index and relative address  */
typedef __packed struct
{
  uint16_t    index;
  uint16_t    rAddr;
}regScuAddr_t;

/* start  registers  info linked a request from RS485 */
typedef __packed struct
{
  uint16_t    index;
  uint8_t*    pRegAdd;
}regStartInfo_t;

typedef __packed struct
{
  scuStates_e         scuStates;
  uint16_t            crcCpuId;
  headerScuRx_st      frameScuDlRxTmp;
} scuInfoMng_st;

typedef __packed struct
{
  scuDlStates_e       scuStates;
  headerRIR_t         lastRd;
} scuDlInfoMng_st;

/***                                                                                                                                                 ***/
/*** Definizioni per il protocollo MODBUS tra SCU e SBC ************************************************************************************************/
/***                                                                                                                                                 ***/
#define LEN_BOARD_FW_VERSION_RO                 ((uint16_t)12)        /* address len Campo ASCII contenente la versione del main firmware                               */                                 
#define LEN_MIFARE_FW_VERSION_RO                ((uint16_t)10)        /* address len Versione FW del lettore RFID                                                       */         
#define LEN_BOARD_SN_RO                         ((uint16_t)8)         /* address len Numero di serie della scheda                                                       */         
#define LEN_PLC_FW_VERSION_RO                   ((uint16_t)12)        /* address len Campo ASCII versione FW del modulo PLC (solo stazione DC)                          */         
#define LEN_PLC_MAC_ADDRESS_RO                  ((uint16_t)10)        /* address len MAC address lendel modulo PLC (solo stazione DC)                                   */         
#define LEN_HW_REVISION_RO                      ((uint16_t)8)         /* address len Campo versione hardware della scheda                                               */
#define LEN_WIFI_MAC_ADDRESS_RO                 ((uint16_t)10)        /* address len MAC address del modulo Wi-Fi Espressif                                             */
#define LEN_POWER_MODULE_SN_RO                  ((uint16_t)10)        /* address len Numero di serie del modulo di potenza                                              */   
#define LEN_BLE_MAC_ADDRESS_RO                  ((uint16_t)10)        /* address len MAC address del modulo Bluetooth (da valutare se serve)                            */   
#define LEN_PRODUCT_SN_RO                       ((uint16_t)8)         /* address len Campo numero di serie del prodotto                                                 */
#define LEN_PRODUCT_CODE_RO                     ((uint16_t)12)        /* address len Campo codice prodotto SCAME                                                        */
#define LEN_BOOT_FW_VERSION_RO                  ((uint16_t)12)        /* address len Campo ASCII contenente la versione del boot firmware                               */
#define LEN_MODBUS_VERSION_RO                   ((uint16_t)1)         /* address len Campo lunghezza versione del modbus                                                */
#define LEN_SCU_RESERVED1                       ((uint16_t)133)       /* address len Reserved for future use                                                            */         

#define LEN_NOTIFY_EVSE_PRESENCE_RO             ((uint16_t)2)         /* address len Indica quanti e quali indirizzi sono presenti nel sistema                          */         
#define LEN_NOTIFY_EVSE_CHANGE_RO               ((uint16_t)2)         /* address len Registro per segnalare un cambiamento di stato (prevedere autocleaning)            */         
#define LEN_EVSE_ERROR1_RO                      ((uint16_t)1)         /* address len Registro 1 per segnalare allarmi e/o errori                                        */         
#define LEN_EVSE_ERROR2_RO                      ((uint16_t)1)         /* address len Registro 2 per segnalare allarmi e/o errori                                        */         
#define LEN_EVSE_CHANGE_REGISTERS_RO            ((uint16_t)32)        /* address len contiene l'indirizzo del registro cambiato per ogni singola scheda                 */         
#define LEN_SCU_RESERVED2                       ((uint16_t)474)       /* address len Reserved for future use                                                            */         

#define LEN_EVSE_EVENT_FLAGS_RO                 ((uint16_t)1)         /* address len Registro stato del connettore tethered                                             */         
#define LEN_EVSE_CHARGE_STATUS_RO               ((uint16_t)1)         /* address len registro che notifica lo stato della stazione                                      */    
#define LEN_TEMPERATURE_SYSTEM_RO               ((uint16_t)2)         /* address len temperatura del sistema (quella rilevata dal uP nel caso AC)                       */         
#define LEN_RESERVED3_RDD                       ((uint16_t)10)        /* address len Reserved for duture use                                                            */        
 
#define LEN_VOLTAGE_AC_RO                       ((uint16_t)2)         /* address len Tensione di alimentazione del sistema (parametro OCCP)                             */         
#define LEN_CURRENT_AC_L1_RO                    ((uint16_t)2)         /* address len Corrente fase 1 (parametro OCCP)                                                   */         
#define LEN_CURRENT_AC_L2_RO                    ((uint16_t)2)         /* address len Corrente fase 2 (parametro OCCP)                                                   */         
#define LEN_CURRENT_AC_L3_RO                    ((uint16_t)2)         /* address len Corrente fase 3 (parametro OCCP)                                                   */         
#define LEN_ACTIVE_POWER_DC                     ((uint16_t)2)         /* address len Sommatoria delle correnti                                                          */       
#define LEN_ACTIVE_POWER_AC_RO                  ((uint16_t)2)         /* address len Potenza attiva del sistema     (parametro OCCP)                                    */       
#define LEN_ACTIVE_POWER_AC_L1_RO               ((uint16_t)2)         /* address len potenza attiva fase 1                                                              */       
#define LEN_REACTIVE_POWER_AC_RO                ((uint16_t)2)         /* address len Potenza reattiva del sistema   (parametro OCCP)                                    */       
#define LEN_TOTAL_ACTIVE_ENERGY_AC_EV_RO        ((uint16_t)2)         /* address len Energia attiva del sistema     (parametro OCCP)                                    */       
#define LEN_TOTAL_ACTIVE_ENERGY_DC_EV_RO        ((uint16_t)2)         /* address len Energia apparente del sistema  (parametro OCCP)                                    */       
#define LEN_TOTAL_REACTIVE_ENERGY_AC_EV_RO      ((uint16_t)2)         /* address len Energia reattiva del sistema   (parametro OCCP)                                    */       
#define LEN_TRANSACTION_ACTIVE_ENERGY_AC_EV_RO  ((uint16_t)2)         /* address len Energia attiva parziale relativa alla sessione corrente    (parametro OCCP)        */       
#define LEN_ACTIVE_POWER_AC_L2_RO               ((uint16_t)2)         /* address len potenza attiva fase 2                                                              */       
#define LEN_TRANSACTION_REACTIVE_ENERGY_AC_EV_RO ((uint16_t)2)        /* address len Energia reattiva parziale relativa alla sessione corrente  (parametro OCCP)        */       
#define LEN_FREQUENCY_SUPPLY_RO                 ((uint16_t)2)         /* address len Frequenza di rete     (parametro OCCP)                                             */       
#define LEN_RESERVED4_RDD                       ((uint16_t)9)         /* address len Reserved (usati per stazione DC)                                                   */       
#define LEN_MAX_CURRENT_ROTATORY_SWITCH_RO      ((uint16_t)1)         /* address len Corrente impostata nel selettore rotativo                                          */       
#define LEN_UNDEFINED_EX_RSC_CURR_RDD           ((uint16_t)2)         /* address len Corrente massima di sistema                                                        */       
#define LEN_ACTIVE_POWER_AC_L3_RO               ((uint16_t)2)         /* address len potenza attiva fase 2                                                              */       
#define LEN_EMPTY_063A                          ((uint16_t)1)         /* address len of empty register at address 063A                                                  */
#define LEN_MAX_CURRENT_RESULT_RO               ((uint16_t)1)         /* address len Corrente massima di carica risultante dai vari calcoli e confronti                 */       
#define LEN_TRANSACTION_TIME_RO                 ((uint16_t)2)         /* address len Tempo in secondi, trascorsi dall'inizio della carica                               */       
#define LEN_TRANSACTION_COUNTDOWN_RO            ((uint16_t)2)         /* address len Tempo, in secondi, rimanenti al completamento della carica                         */       
#define LEN_EV_BATTERY_RO                       ((uint16_t)1)         /* address len percentuale della carica della batteria  (parametro OCCP)                          */       
#define LEN_SESSION_ID_RO                       ((uint16_t)2)         /* address len identificatore della sessione di carica                                            */       
#define LEN_EVSE_BOOT_EVENT_RO                  ((uint16_t)1)         /* address len identificatore tipo di reset                                                       */       

/* Aggiunti per v18b Modbus */
#define LEN_TOTAL_ACTIVE_ENERGY_AC_GRID_RO      ((uint16_t)2)         /* address len Energia Attiva totale funzione GRID V2G                                            */
#define LEN_TOTAL_REACTIVE_ENERGY_AC_GRID_RO    ((uint16_t)2)         /* address len Energia Reattiva totale funzione GRID V2G                                          */
#define LEN_TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO   ((uint16_t)2)      /* address len Energia Attiva erogata in una transazione, funzione GRID V2G                       */
#define LEN_TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO ((uint16_t)2)      /* address len Energia Reattiva erogata in una transazione, funzione GRID V2G                     */ 
#define LEN_SCU_RESERVED6                       ((uint16_t)4)         /* address len reserved                                                                           */   

/* Registro di notifica quindi messo in una sezione a parte */
#define LEN_UID_AUTHORIZATION_RO                ((uint16_t)24)        /* address len valore UID della card letta                                                        */
#define LEN_TIME_IN_CHARGE_RO                   ((uint16_t)2)         /* address len tempo effettivo di carica                                                          */
#define LEN_SCU_RESERVED6B                      ((uint8_t)198)        /* address len reserved                                                                           */                

/* ----- Fine dei parametri Read-Only si passa a quelli RW --------------   */

#define LEN_CONNECTOR_TYPE_RW                   ((uint16_t)1)         /* address len modello della stazione                                                             */  
#define LEN_HWC_FLAGS_RW                        ((uint16_t)1)         /* address len flag componenti hardware aggiuntivi                                                */  
#define LEN_ENERGY_METERS_RW                    ((uint16_t)1)         /* address len tipo di energy meter                                                               */
#define LEN_POWER_OUTAGE_HW_RW                  ((uint16_t)1)         /* address len Tipo di hardware installato per gestire l'assenza di tensione                      */ 

#define LEN_CONNECTOR_IDS_RW                    ((uint16_t)1)         /* address len Modifica indirizzo modbus usato come alias della scheda                            */       
#define LEN_BOARD_SN_RW                         ((uint16_t)8)         /* address len Numero di serie della stazione                                                     */       
#define LEN_PRODUCT_SN_RW                       ((uint16_t)8)         /* address len Numero di serie del prodotto                                                       */       
#define LEN_MASTER_HARDWARE_TYPE_RW             ((uint16_t)1)         /* address len Configurazione master / slave                                                      */       
#define LEN_UTC_DATE_TIME_RW                    ((uint16_t)9)         /* address len data e ora correnti letti da RTC                                                   */       
#define LEN_POWER_MODULE_BRAND_RW               ((uint16_t)1)         /* address len Indica la marca del produttore del caricabatteria (solo DC)                        */       
#define LEN_POWER_MODULE_MODEL_RW               ((uint16_t)1)         /* address len Indica la marca del modello del caricabatteria (solo DC)                           */       
#define LEN_POWER_MODULE_N_RW                   ((uint16_t)1)         /* address len Indica il numero di moduli installati al sistema  (solo DC)                        */       
#define LEN_EVSE_TM_MODE_RW                     ((uint16_t)1)         /* address len Abilitazione macchina di collaudo                                                  */       
#define LEN_EVSE_OPERATION_MODE_RW              ((uint16_t)1)         /* address len In dica la modalità di funzionamento del sistema di ricarica                       */       
#define LEN_CHARGE_PROTOCOL_SELECTED_RW         ((uint16_t)1)         /* address len Quale connettore utilizzare per la ricarica (DC)                                   */       
#define LEN_DISPLAY_DEFAULT_LANGUAGE_RW         ((uint16_t)1)         /* address len Indica la lingua utilizzata dal sistema                                            */
#define LEN_HW_CHECKS1_RW                       ((uint16_t)1)         /* address len Registro per abilitazione errori                                                   */                                 
#define LEN_HW_CHECKS2_RW                       ((uint16_t)1)         /* address len Registro per abilitazione errori                                                   */                                 
#define LEN_HW_ACTUATORS_RW                     ((uint16_t)1)         /* address len Registro per la configurazione degli attuatori del sistema                         */                                 

#define LEN_SCU_RESERVED7                       ((uint16_t)8)         /* address len Imposta la corrente massima AC disponibile nel sistema                             */                                 
#define LEN_MAX_TEMPORARY_CURRENT_RW            ((uint16_t)2)         /* address len Parametro PID per sistema AC                                                       */           
#define LEN_EMPTY_0033_RW                       ((uint16_t)1)         /* address len --------------                                                                     */        

#define LEN_LED_STRIP_RW                        ((uint16_t)1)         /* address len Registro utilizzato per impostare lunghezza strip led                              */           
#define LEN_REMOTE_COMMANDS_RW                  ((uint16_t)1)         /* address len Emulazione stato pressione del pulsante remoto                                     */           
#define LEN_ENVIRONMENT_BRIGHTNESS_RW           ((uint16_t)1)         /* address len Valore di luminosità letto dal sensore                                             */           
#define LEN_MIN_POWER_DC_RWD                    ((uint16_t)2)         /* address len minima potenza DC (non usato in AC)                                            */           
#define LEN_UNDEFINED_EX_PRX_MOTION_RWD         ((uint16_t)1)         /* address len Registro flag che indica presenza di movimento rilevata                            */           
#define LEN_MAX_TEMPORARY_POWER_AC              ((uint16_t)2)         /* address len Parametro per impostare potenza massima temporanea AC disponibile                  */             
#define LEN_PM_MODE_RW                          ((uint16_t)1)         /* address len registro utilizzato modalità Power Management                                      */           
#define LEN_ENABLE_LOG_RW                       ((uint16_t)1)         /* address len abilitazione log su SD (solo DC)                                                   */           
#define LEN_AUTHORIZATION_FEEDBACK_RW           ((uint16_t)1)         /* address len in modalità NET autorizza e controlla la carica                                    */           
#define LEN_TIMEZONE_RW                         ((uint16_t)1)         /* address definizione time zone rispetto a UTC                                                   */           
#define LEN_MENU_VISIBILITY_RW                  ((uint16_t)1)         /* address len visibilità di alcuni menu                                                          */      
#define LEN_TIMEOUT_RANGE1_RW                   ((uint16_t)1)         /* address len valore di partenza contatore 1                                                     */           
#define LEN_TIMEOUT_RANGE2_RW                   ((uint16_t)1)         /* address len valore di partenza contatore 2                                                     */
#define LEN_PRODUCT_CODE_RW                     ((uint16_t)12)        /* address len Codice prodotto Scame                                                              */

/* Aggiunti per v18b Modbus */
#define LEN_TECN_PRODUCT_CODE_RW                ((uint16_t)10)        /* address len Codice prodotto Fake per algoritmo configuratore e SEM                             */
#define LEN_CONNECTOR_N_RW                      ((uint16_t)1)         /* address len Numero connettore basato sulla posizione nella EVSE                                */
#define LEN_DISPLAY_LANGUAGES_RW                ((uint16_t)2)         /* address len Lingua impostata e lingua di default della EVSE                                    */
#define LEN_MAX_TYPICAL_CURRENT_RW              ((uint16_t)1)         /* address len Corrente massima erogabile in modalità tipica (ex RSC_CURR_RO v18)                 */
#define LEN_MAX_SIMPLIFIED_CURRENT_RW           ((uint16_t)1)         /* address len Corrente massima erogabile in modalità semplificata                                */
#define LEN_CHARGE_BY_TIME_RW                   ((uint16_t)1)         /* address len Tempo di carica massimo                                                            */
#define LEN_CHARGE_BY_ENERGY_RW                 ((uint16_t)1)         /* address len Potenza massima di carica permessa                                                 */  
#define LEN_PM_IMIN_RW                          ((uint16_t)1)         /* address len Corrente minima erogabile in funzionalità di Power Management                      */
#define LEN_PM_PMAX_RW                          ((uint16_t)1)         /* address len Potenza massima erogabile in funzionalità di Power Management                      */
#define LEN_PM_FLAGS_RW                         ((uint16_t)1)         /* address len Flag di abilitazione Power Management                                              */
#define LEN_PM_HPOWER_RW                        ((uint16_t)1)         /* address len Valore di isteresi soglia di potenza Power Management                              */
#define LEN_PM_DSET_RW                          ((uint16_t)1)         /* address len Valore di variazione della potenza in erogazione verso l'EV                        */
#define LEN_PM_DMAX_RW                          ((uint16_t)1)         /* address len Valore di potenza in eccesso che può essere erogato dall'EVSE                      */
#define LEN_PIN_EXTERNAL_ENERGY_METER_RW        ((uint16_t)1)         /* address len Pin energy meter esterno                                                           */ 
#define LEN_LIM_MAX_POWER_AC_RW                 ((uint16_t)2)         /* address len per massima potenza in AC                                                          */ 
#define LEN_RESERVED_A                          ((uint16_t)10)        /* address len reserved                                                                           */  

#define LEN_FILE_COMMAND_RW                     ((uint16_t)1)         /* address len Comando per avviare l'aggiornamento SW                                             */           
#define LEN_FILE_SIZE_RW                        ((uint16_t)2)         /* address len Registro con indicazione della lunghezza del file da caricare                      */           
#define LEN_FILE_PACKET_RW                      ((uint16_t)1)         /* address len Registro con indicazione del numero di pacchetti da caricare                       */           
          
/****          definizioni lunghezze per l'ambiente SINAPSI - RSE ***************************************************************************************  */
#define LEN_IOM_CTRL_REG                        ((uint16_t)1)         /* address len Registro controllo per nuovi dati disponibili                                      */           
#define LEN_M2_POT_ATT_IMM_IST_TS               ((uint16_t)2)         /* address len time stamp potenza attiva immessa istantanea letta dal contatore M2                */           
#define LEN_M2_POT_ATT_IMM_IST                  ((uint16_t)1)         /* address len potenza attiva immessa istantanea letta dal contatore M2                           */           
#define LEN_M2_POT_CONTRATTUALE_TS              ((uint16_t)2)         /* address len time stamp potenza contrattuale del contatore M2                                   */           
#define LEN_M2_POT_CONTRATTUALE                 ((uint16_t)1)         /* address len potenza contrattuale del contatore M2                                              */           
#define LEN_M1_POT_CONTRATTUALE_TS              ((uint16_t)2)         /* address len time stamp potenza contrattuale del contatore M1                                   */           
#define LEN_M1_POT_CONTRATTUALE                 ((uint16_t)1)         /* address len potenza contrattuale del contatore M1                                              */           
#define LEN_M1_POT_DISPONIBILE_TS               ((uint16_t)2)         /* address len time stamp potenza disponibile  del contatore M1                                   */           
#define LEN_M1_POT_DISPONIBILE                  ((uint16_t)1)         /* address len potenza disponibile del contatore M1                                               */           
#define LEN_M1_POT_ATT_PRE_IST_TS               ((uint16_t)2)         /* address len time stamp potenza attiva prelevata istantanea  del contatore M1                   */           
#define LEN_M1_POT_ATT_PRE_IST                  ((uint16_t)1)         /* address len attiva prelevata istantanea  del contatore M1                                      */           
#define LEN_M1_POT_ATT_IMM_IST_TS               ((uint16_t)2)         /* address len time stamp potenza attiva immessa istantanea  del contatore M1                     */           
#define LEN_M1_POT_ATT_IMM_IST                  ((uint16_t)1)         /* address len attiva immessa istantanea  del contatore M1                                        */           
#define LEN_M1_DISTACCO_TS                      ((uint16_t)2)         /* address len time stamp da cui si calcola tempo di distacco al contatore M1                     */           
#define LEN_M1_TEMPO_RES_DIST                   ((uint16_t)1)         /* address len tempo residuo di distacco al   contatore M1                                        */           
#define LEN_M1_PROF_FASCIA_ORARIA_TS            ((uint16_t)2)         /* address len time stamp da cui parte la fascia oraria corrente al contatore M1                  */           
#define LEN_M1_PROF_FASCIA_ORARIA               ((uint16_t)1)         /* address len fascia oraria corrente  al   contatore M1                                          */           
#define LEN_M1_POT_TEMPO_LIMITE_TS              ((uint16_t)2)         /* address len time stamp dat e ora fino a cui si può ricaricare alla Pmaxt  al contatore M1      */           
#define LEN_M1_POT_MAX_RIC_TLIM                 ((uint16_t)1)         /* address len potenza massima Pmaxt di ricarica a tempo limitata al contatore M1                 */           
#define LEN_M1_SOSP_RIC_TLIM_TS                 ((uint16_t)2)         /* address len time stamp data e ora fino a cui è obbligatorio sospendere la carica al cnt M1     */           
#define LEN_M1_UNIXTIME_SYNC                    ((uint16_t)2)         /* address len sincronizzazione orologio formato unixtime tra IOM e SCU                           */           
#define LEN_SET_CONFIG_MODE                     ((uint16_t)1)         /* address len set configuration Bluetoth board SINAPSI                                           */ 

/****          definizioni lunghezze per simulatore EM LOVATO Ethernet   *********************************************************************************  */
#define LEN_EM_LOVATO_V_SYS                     ((uint16_t)2)         /* address registro tensione di fase L1                                                           */ 
#define LEN_EM_LOVATO_P_AREA                    ((uint16_t)48)        /* address registro potenza attiva delle prese                                                    */ 


/****          definizioni lunghezze per l'ambiente collaudo scheda PEN  *********************************************************************************  */
#define LEN_PEN_RELE_RWD                        ((uint16_t)1)         /* address registro comando relè                                                                  */ 

/****          definizioni lunghezze per l'ambiente Macchina di Collaudo *********************************************************************************  */
#define LEN_TM_MEASURED_CURRENT_RW              ((uint16_t)1)         /* address len Valore di corrente misurato dall'EM interno alla macchina di collaudo              */
#define LEN_TM_MEASURED_VOLTAGE_RW              ((uint16_t)1)         /* address len Valore di tensione misurato dall'EM interno alla macchina di collaudo              */
#define LEN_TM_EVSE_READY_RO                    ((uint16_t)1)         /* address len Flag per mostrare quando una EVSE è disponibile a proseguire con i test            */
#define LEN_TM_ADDR_S_CONN_RW                   ((uint16_t)1)         /* address len Flag per presenza slave collegata alla master                                      */
#define LEN_TM_ADDR_REQ_RW                      ((uint16_t)1)         /* address len richiesta indirizzamento automatico                                                */
#define LEN_TM_ADDR_ASS_RW                      ((uint16_t)1)         /* address len assegnazione indirizzamento automatico                                             */
#define LEN_ADDR_TM_ERROR1_RO                   ((uint16_t)1)         /* address len errori in fase di collaudo                                                         */
#define LEN_TM_UID_MASTER_RW                    ((uint16_t)4)         /* address len Valore campo UID carta Master                                                      */
#define LEN_TM_UID_USER_RW                      ((uint16_t)4)         /* address len Valore campo UID carta User                                                        */
#define LEN_TM_MEASURED_CURRENT_L2_RW           ((uint16_t)1)         /* address len Valore di corrente misurato dall'EM interno alla macchina di collaudo L2           */
#define LEN_TM_MEASURED_VOLTAGE_L2_RW           ((uint16_t)1)         /* address len Valore di tensione misurato dall'EM interno alla macchina di collaudo L2           */
#define LEN_TM_MEASURED_CURRENT_L3_RW           ((uint16_t)1)         /* address len Valore di corrente misurato dall'EM interno alla macchina di collaudo L3           */
#define LEN_TM_MEASURED_VOLTAGE_L3_RW           ((uint16_t)1)         /* address len Valore di tensione misurato dall'EM interno alla macchina di collaudo L3           */
#define LEN_TM_GET_EEPROM_RW                    ((uint16_t)1)         /* address len Valore per la richiesta parametri in EEPROM                                        */

/****          definizioni lunghezze per l'ambiente APP tecnica          *********************************************************************************  */
#define LEN_CONNECTOR_INIT_STATUS_RO            ((uint16_t)1)         /* address len Stato di attivazione della presa collegata alla App                                */
#define LEN_CONNECTOR_OPERATION_STATUS_RO       ((uint16_t)1)         /* address len Registro di stato Idle della presa, richiesto da Enrico per ios                    */  
#define LEN_PROCEDURE_RESPONSE_RO               ((uint16_t)2)         /* address len Registro contenente l'esito di una Procedura app-modulo Wi-Fi                      */
#define LEN_PM_TOTAL_POWER_RO                   ((uint16_t)2)         /* address len Registro potenza esterna misurata                                                  */
#define LEN_PM_L1_POWER_RO                      ((uint16_t)2)         /* address len Potenza esterna fase 1                                                             */
#define LEN_PM_L2_POWER_RO                      ((uint16_t)2)         /* address len Potenza esterna fase 2                                                             */
#define LEN_PM_L3_POWER_RO                      ((uint16_t)2)         /* address len Potenza esterna fase 3                                                             */
#define LEN_APP_LOGIN_USER_TYPE_RO              ((uint16_t)1)         /* address len Tipologia di utente cheha fatto il login                                           */          
#define LEN_CONNECTOR_CHECK_ACTIV_KEY_RW        ((uint16_t)3)         /* address len Controllo codice di attivazione della presa                                        */
#define LEN_CONNECTOR_NAME_RW                   ((uint16_t)7)         /* address len Nome presa scelto dall'utente                                                      */
#define LEN_CONNECTOR_PIN_RW                    ((uint16_t)3)         /* address len PIN presa scelto dall'utente in fase di inizializzazione                           */
#define LEN_ROUTER_NET_SSID_RW                  ((uint16_t)16)        /* address len SSID rete router domestico                                                         */
#define LEN_ROUTER_NET_PASSWORD_RW              ((uint16_t)32)        /* address len Password rete router domestico                                                     */
#define LEN_CONNECTOR_ROUTER_IP_RW              ((uint16_t)8)         /* address len IP modulo Wi-Fi scelto dal router domestico                                        */
#define LEN_PROCEDURE_REQUEST_RW                ((uint16_t)1)         /* address len Richiesta di una procedura dall App alla SCU                                       */
#define LEN_SCHEDULE_FLAG1_RW                   ((uint16_t)1)         /* address len Flag di attivazione della schedulazione numero 1                                   */
#define LEN_SCHEDULE_START1_RW                  ((uint16_t)1)         /* address len Orario di partenza della prima carica schedulata                                   */
#define LEN_SCHEDULE_STOP1_RW                   ((uint16_t)1)         /* address len Orario di stop della prima carica schedulata                                       */
#define LEN_SCHEDULE_POWER1_RW                  ((uint16_t)2)         /* address len Massima potenza impostabile per la schedulazione 1                                 */          
#define LEN_SCHEDULE_FLAG2_RW                   ((uint16_t)1)         /* address len Flag di attivazione della schedulazione numero 2                                   */
#define LEN_SCHEDULE_START2_RW                  ((uint16_t)1)         /* address len Orario di partenza della seconda carica schedulata                                 */
#define LEN_SCHEDULE_STOP2_RW                   ((uint16_t)1)         /* address len Orario di stop della seconda carica schedulata                                     */
#define LEN_SCHEDULE_POWER2_RW                  ((uint16_t)2)         /* address len Massima potenza impostabile per la schedulazione 2                                 */
#define LEN_SCHEDULE_FLAG3_RW                   ((uint16_t)1)         /* address len Flag di attivazione della schedulazione numero 3                                   */
#define LEN_SCHEDULE_START3_RW                  ((uint16_t)1)         /* address len Orario di partenza della terza carica schedulata                                   */
#define LEN_SCHEDULE_STOP3_RW                   ((uint16_t)1)         /* address len Orario di stop della terza carica schedulata                                       */
#define LEN_SCHEDULE_POWER3_RW                  ((uint16_t)2)         /* address len Massima potenza impostabile per la schedulazione 3                                 */
#define LEN_SCHEDULE_FLAG4_RW                   ((uint16_t)1)         /* address len Flag di attivazione della schedulazione numero 4                                   */
#define LEN_SCHEDULE_START4_RW                  ((uint16_t)1)         /* address len Orario di partenza della quarta carica schedulata                                  */
#define LEN_SCHEDULE_STOP4_RW                   ((uint16_t)1)         /* address len Orario di stop della quarta carica schedulata                                      */
#define LEN_SCHEDULE_POWER4_RW                  ((uint16_t)2)         /* address len Massima potenza impostabile per la schedulazione 4                                 */
#define LEN_CONNECTOR_CONNECTION_STATUS_RO      ((uint16_t)1)         /* address len Stato di connessione alla rete di un router                                        */                
#define LEN_MAX_POWER_RO                        ((uint16_t)2)         /* address len Massima potenza per settaggio tachimetro APP                                       */                  
#define LEN_RANDOM_DELAY_FLAG_RW                ((uint16_t)1)         /* address len abilitazione/disabilitazione schedulazioni                                         */                  
#define LEN_UID_AUTHORIZATION_APP_RW            ((uint16_t)5)         /* address len uid autorizzazione da app                                                          */        
#define LEN_BT_SINAPSI_STATUS_RW                ((uint16_t)1)         /* address len Stato del bluetooth Sinapsi                                                        */                              
#define LEN_FW_UPDATE_NAME_RW                   ((uint16_t)9)         /* address len nome fimrware da aggiornare                                                        */
#define LEN_FW_UPDATE_LEN_RW                    ((uint16_t)2)         /* address len lunghezza firmware da aggiornare                                                   */ 
#define LEN_FW_UPDATE_STATUS_RO                 ((uint16_t)1)         /* address len esito firmware update                                                              */                                
#define LEN_EVSE_POWER_MODE_RO                  ((uint16_t)1)         /* address len alimentazione stazione di ricarica                                                 */
#define LEN_PM_PARAMETERS_RO                    ((uint16_t)6)         /* address len Power Management parameters                                                        */

#define LEN_APP_EXCHANGE_AREA_RO                ((uint16_t)255)       /* len of area used by App to exchange datas with SCU */

/****          definizioni indirizzi per l'ambiente SCU-SEM        ***************************************************************************************  */
#define ADDR_START_RDD                          ((uint16_t)0x0300)                                                                 /* start address per read only register RIR function 04                 */                                 
#define ADDR_BOARD_FW_VERSION_RO                (ADDR_START_RDD                         + 0                                     )  /* address Campo ASCII contenente la versione del main firmware  0x0302 */                                 
#define ADDR_MIFARE_FW_VERSION_RO               (ADDR_BOARD_FW_VERSION_RO               + LEN_BOARD_FW_VERSION_RO               )  /* address Versione FW del lettore RFID                                 */         
#define ADDR_BOARD_SN_RO                        (ADDR_MIFARE_FW_VERSION_RO              + LEN_MIFARE_FW_VERSION_RO              )  /* address Numero di serie della scheda                                 */         
#define ADDR_PLC_FW_VERSION_RO                  (ADDR_BOARD_SN_RO                       + LEN_BOARD_SN_RO                       )  /* address Campo ASCII versione FW del modulo PLC (solo stazione DC)    */         
#define ADDR_PLC_MAC_ADDRESS_RO                 (ADDR_PLC_FW_VERSION_RO                 + LEN_PLC_FW_VERSION_RO                 )  /* address MAC address lendel modulo PLC (solo stazione DC)             */         
#define ADDR_HW_REVISION_RO                     (ADDR_PLC_MAC_ADDRESS_RO                + LEN_PLC_MAC_ADDRESS_RO                )  /* address Versione hardware della SCU                                  */
#define ADDR_WIFI_MAC_ADDRESS_RO                (ADDR_HW_REVISION_RO                    + LEN_HW_REVISION_RO                    )  /* address Indirizzo MAC del modulo Wi-Fi                               */
#define ADDR_POWER_MODULE_SN_RO                 (ADDR_WIFI_MAC_ADDRESS_RO               + LEN_WIFI_MAC_ADDRESS_RO               )  /* address Numero di serie del modulo di potenza                        */
#define ADDR_BLE_MAC_ADDRESS_RO                 (ADDR_POWER_MODULE_SN_RO                + LEN_POWER_MODULE_SN_RO                )  /* address Indirizzo MAC del modulo Bluetooth                           */
#define ADDR_PRODUCT_SN_RO                      (ADDR_BLE_MAC_ADDRESS_RO                + LEN_BLE_MAC_ADDRESS_RO                )  /* address Numero di serie prodotto finito                              */
#define ADDR_PRODUCT_CODE_RO                    (ADDR_PRODUCT_SN_RO                     + LEN_PRODUCT_SN_RO                     )  /* address Codice prodotto SCAME                                        */
#define ADDR_BOOT_FW_VERSION_RO                 (ADDR_PRODUCT_CODE_RO                   + LEN_PRODUCT_CODE_RO                   )  /* address boot firmware version                                        */
#define ADDR_MODBUS_VERSION_RO                  (ADDR_BOOT_FW_VERSION_RO                + LEN_BOOT_FW_VERSION_RO                )  /* address modbus  version                                        */
#define ADDR_SCU_RESERVED1                      (ADDR_MODBUS_VERSION_RO                 + LEN_MODBUS_VERSION_RO                 )  /* address Reserved for future use                                      */         

#define ADDR_NOTIFY_EVSE_PRESENCE_RO            ((uint16_t)0x0400                       + 0)                                       /* address Indica quanti e quali indirizzi sono presenti nel sistema    */         
#define ADDR_NOTIFY_EVSE_CHANGE_RO              (ADDR_NOTIFY_EVSE_PRESENCE_RO           + LEN_NOTIFY_EVSE_PRESENCE_RO           )  /* address Registro per segnalare un cambiamento di stato (prevedere autocleaning)          */         
#define ADDR_EVSE_ERROR1_RO                     (ADDR_NOTIFY_EVSE_CHANGE_RO             + LEN_NOTIFY_EVSE_CHANGE_RO             )  /* address Registro 1 per segnalare allarmi e/o errori                  */         
#define ADDR_EVSE_ERROR2_RO                     (ADDR_EVSE_ERROR1_RO                    + LEN_EVSE_ERROR1_RO                    )  /* address Registro 2 per segnalare allarmi e/o errori                  */         
#define ADDR_EVSE_CHANGE_REGISTERS_RO           (ADDR_EVSE_ERROR2_RO                    + LEN_EVSE_ERROR2_RO                    )  /* address contiene l'indirizzo del registro cambiato per ogni singola scheda               */         
#define ADDR_SCU_RESERVED2                      (ADDR_EVSE_CHANGE_REGISTERS_RO          + LEN_EVSE_CHANGE_REGISTERS_RO          )  /* address Reserved for future use                                      */         

/****          definizioni indirizzi per l'APP local (Read-Only)        ***************************************************************************************  */
#define ADDR_APP_EXCHANGE_AREA_RO               ((uint16_t)0x0500                       + 0)                                      /* address of exchange area used for App local                          */         

#define ADDR_EVSE_EVENT_FLAGS_RO                ((uint16_t)0x0600                       + 0                                     )  /* address contiene lo stato del connettore tethered                    */         
#define ADDR_EVSE_CHARGE_STATUS_RO              (ADDR_EVSE_EVENT_FLAGS_RO               + LEN_EVSE_EVENT_FLAGS_RO               )  /* registro che notifica lo stato della stazione                        */         
#define ADDR_TEMPERATURE_SYSTEM_RO              (ADDR_EVSE_CHARGE_STATUS_RO             + LEN_EVSE_CHARGE_STATUS_RO             )  /* address temperatura del sistema (quella rilevata dal uP nel caso AC) */ 
#define ADDR_SCU_RESERVED3                      (ADDR_TEMPERATURE_SYSTEM_RO             + LEN_TEMPERATURE_SYSTEM_RO             )  /* address Reserved for DC system                                       */         
#define ADDR_DC_RESERVED3_END                   (ADDR_SCU_RESERVED3                     + LEN_RESERVED3_RDD                     )  /* address Reserved for DC system                                       */         

#define ADDR_VOLTAGE_AC_RO                      (ADDR_SCU_RESERVED3                     + LEN_RESERVED3_RDD                     )  /* 0x060E address Tensione di alimentazione del sistema (parametro OCCP)*/         
#define ADDR_CURRENT_AC_L1_RO                   (ADDR_VOLTAGE_AC_RO                     + LEN_VOLTAGE_AC_RO                     )  /* address Corrente fase 1 (parametro OCCP)                             */         
#define ADDR_CURRENT_AC_L2_RO                   (ADDR_CURRENT_AC_L1_RO                  + LEN_CURRENT_AC_L1_RO                  )  /* address Corrente fase 2 (parametro OCCP)                             */         
#define ADDR_CURRENT_AC_L3_RO                   (ADDR_CURRENT_AC_L2_RO                  + LEN_CURRENT_AC_L2_RO                  )  /* address Corrente fase 3 (parametro OCCP)                             */         
#define ADDR_ACTIVE_POWER_DC_RO                 (ADDR_CURRENT_AC_L3_RO                  + LEN_CURRENT_AC_L3_RO                  )  /* address Sommatoria delle correnti                                    */       
#define ADDR_ACTIVE_POWER_AC_RO                 (ADDR_ACTIVE_POWER_DC_RO                + LEN_ACTIVE_POWER_DC                   )  /* address Potenza attiva del sistema     (parametro OCCP)                          */       
#define ADDR_ACTIVE_POWER_AC_L1_RO              (ADDR_ACTIVE_POWER_AC_RO                + LEN_ACTIVE_POWER_AC_RO                )  /* address potenza attiva fase 1                                        */              
#define ADDR_REACTIVE_POWER_AC_RO               (ADDR_ACTIVE_POWER_AC_L1_RO             + LEN_ACTIVE_POWER_AC_L1_RO             )  /* address Potenza reattiva del sistema   (parametro OCCP)              */       
#define ADDR_TOTAL_ACTIVE_ENERGY_AC_EV_RO       (ADDR_REACTIVE_POWER_AC_RO              + LEN_REACTIVE_POWER_AC_RO              )  /* address Energia attiva del sistema     (parametro OCCP)              */       
#define ADDR_TOTAL_ACTIVE_ENERGY_DC_EV_RO       (ADDR_TOTAL_ACTIVE_ENERGY_AC_EV_RO      + LEN_TOTAL_ACTIVE_ENERGY_AC_EV_RO      )  /* address Energia apparente del sistema  (parametro OCCP)              */       
#define ADDR_TOTAL_REACTIVE_ENERGY_AC_EV_RO     (ADDR_TOTAL_ACTIVE_ENERGY_DC_EV_RO      + LEN_TOTAL_ACTIVE_ENERGY_DC_EV_RO      )  /* address Energia reattiva del sistema   (parametro OCCP)              */       
#define ADDR_TRANSACTION_ACTIVE_ENERGY_AC_EV_RO (ADDR_TOTAL_REACTIVE_ENERGY_AC_EV_RO    + LEN_TOTAL_REACTIVE_ENERGY_AC_EV_RO    )  /* address Energia attiva parziale relativa alla sessione corrente    (parametro OCCP)      */       
#define ADDR_ACTIVE_POWER_AC_L2_RO              (ADDR_TRANSACTION_ACTIVE_ENERGY_AC_EV_RO   + LEN_TRANSACTION_ACTIVE_ENERGY_AC_EV_RO)  /* address potenza attiva fase 2                                 */       
#define ADDR_TRANSACTION_REACTIVE_ENERGY_AC_EV_RO  (ADDR_ACTIVE_POWER_AC_L2_RO          + LEN_ACTIVE_POWER_AC_L2_RO             )  /* address Energia reattiva parziale relativa alla sessione corrente  (parametro OCCP)      */       
#define ADDR_FREQUENCY_SUPPLY_RO                (ADDR_TRANSACTION_REACTIVE_ENERGY_AC_EV_RO + LEN_TRANSACTION_REACTIVE_ENERGY_AC_EV_RO )  /* address Frequenza di rete     (parametro OCCP)                       */       
#define ADDR_SCU_RESERVED4                      (ADDR_FREQUENCY_SUPPLY_RO               + LEN_FREQUENCY_SUPPLY_RO               )  /* address Reserved (usati per stazione DC)                             */       
#define ADDR_DC_RESERVED4_END                   (ADDR_SCU_RESERVED4                     + LEN_RESERVED4_RDD                     )  /* address Reserved for DC system                                       */         

#define ADDR_MAX_CURRENT_ROTATORY_SWITCH_RO     (ADDR_SCU_RESERVED4                     + LEN_RESERVED4_RDD                     )  /* 0x0635 address Corrente impostata nel selettore rotativo             */       
#define ADDR_UNDEFINED_EX_RSC_CURR_RDD          (ADDR_MAX_CURRENT_ROTATORY_SWITCH_RO    + LEN_MAX_CURRENT_ROTATORY_SWITCH_RO    )  /* address Corrente massima di sistema                                  */       
#define ADDR_ACTIVE_POWER_AC_L3_RO              (ADDR_UNDEFINED_EX_RSC_CURR_RDD         + LEN_UNDEFINED_EX_RSC_CURR_RDD         )  /* address potenza attiva fase 3                                        */       
#define ADDR_EMPTY_063A                         (ADDR_ACTIVE_POWER_AC_L3_RO             + LEN_ACTIVE_POWER_AC_L3_RO             )  /* address of a empty register                                          */
#define ADDR_MAX_CURRENT_RESULT_RO              (ADDR_EMPTY_063A                        + LEN_EMPTY_063A                        )  /* address Corrente massima di carica risultante dai vari calcoli e confronti*/       
#define ADDR_TRANSACTION_TIME_RO                (ADDR_MAX_CURRENT_RESULT_RO             + LEN_MAX_CURRENT_RESULT_RO             )  /* address Tempo in secondi, trascorsi dall'inizio della carica         */       
#define ADDR_TRANSACTION_COUNTDOWN_RO           (ADDR_TRANSACTION_TIME_RO               + LEN_TRANSACTION_TIME_RO               )  /* address Tempo, in secondi, rimanenti al completamento della carica   */       
#define ADDR_EV_BATTERY_RO                      (ADDR_TRANSACTION_COUNTDOWN_RO          + LEN_TRANSACTION_COUNTDOWN_RO          )  /* address percentuale della carica della batteria  (parametro OCCP)    */       
#define ADDR_SESSION_ID_RO                      (ADDR_EV_BATTERY_RO                     + LEN_EV_BATTERY_RO                     )  /* address percentuale della carica della batteria  (parametro OCCP)    */       
#define ADDR_EVSE_BOOT_EVENT_RO                 (ADDR_SESSION_ID_RO                     + LEN_SESSION_ID_RO                     )  /* address flag di notifica reset di sistema                            */       
#define ADDR_TOTAL_ACTIVE_ENERGY_AC_GRID_RO     (ADDR_EVSE_BOOT_EVENT_RO                + LEN_EVSE_BOOT_EVENT_RO                )  /* address Energia attiva totale funzione GRID V2G                      */
#define ADDR_TOTAL_REACTIVE_ENERGY_AC_GRID_RO   (ADDR_TOTAL_ACTIVE_ENERGY_AC_GRID_RO    + LEN_TOTAL_ACTIVE_ENERGY_AC_GRID_RO    )  /* address Energia reattiva totale funzione GRID V2G                    */
#define ADDR_TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO   (ADDR_TOTAL_REACTIVE_ENERGY_AC_GRID_RO     + LEN_TOTAL_REACTIVE_ENERGY_AC_GRID_RO       )  /* address Energia attiva della transazione funzione GRID V2G           */
#define ADDR_TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO (ADDR_TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO + LEN_TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO   )  /* address Energia Reattiva della transazione funzione GRID V2G         */
#define ADDR_SCU_RESERVED6                      (ADDR_TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO   + LEN_TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO )  /* address -------------- Fine dei parametri Read-Only si passa a quelli RW --------------  */       
#define ADDR_UID_AUTHORIZATION_RO               (ADDR_SCU_RESERVED6                     + LEN_SCU_RESERVED6                     )  /* address valore UID della card letta                                  */       
#define ADDR_TIME_IN_CHARGE_RO                  (ADDR_UID_AUTHORIZATION_RO              + LEN_UID_AUTHORIZATION_RO              )  /* address valore tempo di carica vera (con passaggio di corrente)      */
#define ADDR_SCU_RESERVED6B                     (ADDR_TIME_IN_CHARGE_RO                 + LEN_TIME_IN_CHARGE_RO                 )  /* address valore UID della card letta                                  */

#define ADDR_CONNECTOR_TYPE_RW                  ((uint16_t)0x0000                       + 0                                     )  /* address Registro per modificare configurazione Hardware              */       
#define ADDR_HWC_FLAGS_RW                       (ADDR_CONNECTOR_TYPE_RW                 + LEN_CONNECTOR_TYPE_RW                 )  /* 1 address Hardware flags per presenza/assenza componenti               */                
#define ADDR_ENERGY_METERS_RW                   (ADDR_HWC_FLAGS_RW                      + LEN_HWC_FLAGS_RW                      )  /* 2 address Modifica indirizzo modbus usato come alias della scheda      */       
#define ADDR_POWER_OUTAGE_HW_RW                 (ADDR_ENERGY_METERS_RW                  + LEN_ENERGY_METERS_RW                  )  /* 3 address Tipo di hardware installato per l'assenza di tensione        */
#define ADDR_CONNECTOR_IDS_RW                   (ADDR_POWER_OUTAGE_HW_RW                + LEN_POWER_OUTAGE_HW_RW                )  /* 4 address Modifica indirizzo modbus usato come alias della scheda      */       
#define ADDR_BOARD_SN_RW                        (ADDR_CONNECTOR_IDS_RW                  + LEN_CONNECTOR_IDS_RW                  )  /* 5 address Numero di serie della stazione                               */       
#define ADDR_PRODUCT_SN_RW                      (ADDR_BOARD_SN_RW                       + LEN_BOARD_SN_RW                       )  /* 13 address Numero di serie del prodotto                                 */       
#define ADDR_MASTER_HARDWARE_TYPE_RW            (ADDR_PRODUCT_SN_RW                     + LEN_PRODUCT_SN_RW                     )  /* 21 address Configurazione master / slave                                */       
#define ADDR_UTC_DATE_TIME_RW                   (ADDR_MASTER_HARDWARE_TYPE_RW           + LEN_MASTER_HARDWARE_TYPE_RW           )  /* 22 address data e ora correnti letti da RTC                             */       
#define ADDR_POWER_MODULE_BRAND_RW              (ADDR_UTC_DATE_TIME_RW                  + LEN_UTC_DATE_TIME_RW                  )  /* 31 address Indica la marca del produttore del caricabatteria (solo DC)  */       
#define ADDR_POWER_MODULE_MODEL_RW              (ADDR_POWER_MODULE_BRAND_RW             + LEN_POWER_MODULE_BRAND_RW             )  /* 32 address Indica la marca del modello del caricabatteria (solo DC)     */       
#define ADDR_POWER_MODULE_N_RW                  (ADDR_POWER_MODULE_MODEL_RW             + LEN_POWER_MODULE_MODEL_RW             )  /* 33 address Indica il numero di moduli installati al sistema  (solo DC)  */       
#define ADDR_EVSE_TM_RW                         (ADDR_POWER_MODULE_N_RW                 + LEN_POWER_MODULE_N_RW                 )  /* 34 address Abilitazione prese e stazione alla ricarica                  */       
#define ADDR_EVSE_OPERATION_MODE_RW             (ADDR_EVSE_TM_RW                        + LEN_EVSE_TM_MODE_RW                   )  /* address In dica la modalità di funzionamento del sistema di ricarica */       
#define ADDR_CHARGE_PROTOCOL_SELECTED_RW        (ADDR_EVSE_OPERATION_MODE_RW            + LEN_EVSE_OPERATION_MODE_RW            )  /* address Indica con quale connettore effettuare la ricarica (solo DC) */       
#define ADDR_DISPLAY_DEFAULT_LANGUAGE_RW        (ADDR_CHARGE_PROTOCOL_SELECTED_RW       + LEN_CHARGE_PROTOCOL_SELECTED_RW       )  /* address Indica la lingua utilizzata dal sistema                      */
#define ADDR_HW_CHECKS1_RW                      (ADDR_DISPLAY_DEFAULT_LANGUAGE_RW       + LEN_DISPLAY_DEFAULT_LANGUAGE_RW       )  /* address Registro per abilitazione errori                             */                                 
#define ADDR_HW_CHECKS2_RW                      (ADDR_HW_CHECKS1_RW                     + LEN_HW_CHECKS1_RW                     )  /* address Registro per abilitazione errori                             */                                 
#define ADDR_HW_ACTUATORS_RW                    (ADDR_HW_CHECKS2_RW                     + LEN_HW_CHECKS2_RW                     )  /* address Registro per la configurazione degli attuatori del sistema   */                                 
#define ADDR_SCU_RESERVED7                      (ADDR_HW_ACTUATORS_RW                   + LEN_HW_ACTUATORS_RW                   )  /* address Imposta la corrente massima DC disponibile nel sistema       */

#define ADDR_MAX_TEMPORARY_CURRENT_RW           (ADDR_SCU_RESERVED7                     + LEN_SCU_RESERVED7                     )  /* address Parametro PID per sistema AC                                 */           
#define ADDR_LEN_EMPTY_0033_RW_RWD              (ADDR_MAX_TEMPORARY_CURRENT_RW          + LEN_MAX_TEMPORARY_CURRENT_RW          )  /* address Imposta la corrente minima di ricarica                       */           
#define ADDR_LED_STRIP_RW                       (ADDR_LEN_EMPTY_0033_RW_RWD             + LEN_EMPTY_0033_RW                     )  /* address Registro utilizzato per impostare la sospensione della carica*/           
#define ADDR_REMOTE_COMMANDS_RW                 (ADDR_LED_STRIP_RW                      + LEN_LED_STRIP_RW                      )  /* address Emulazione stato pressione del pulsante remoto               */           
#define ADDR_ENVIRONMENT_BRIGHTNESS_RW          (ADDR_REMOTE_COMMANDS_RW                + LEN_REMOTE_COMMANDS_RW                )  /* address Valore di luminosità letto dal sensore                       */           
#define ADDR_MIN_POWER_DC_RWD                   (ADDR_ENVIRONMENT_BRIGHTNESS_RW         + LEN_ENVIRONMENT_BRIGHTNESS_RW         )  /* address Indica la distanza rilevata dal sensore                      */           
#define ADDR_UNDEFINED_EX_PRX_MOTION_RWD        (ADDR_MIN_POWER_DC_RWD                  + LEN_MIN_POWER_DC_RWD                  )  /* address Registro flag che indica presenza di movimento rilevata      */           
#define ADDR_MAX_TEMPORARY_POWER_AC             (ADDR_UNDEFINED_EX_PRX_MOTION_RWD       + LEN_UNDEFINED_EX_PRX_MOTION_RWD       )  /* address Parametro per impostare il PWM dei led esterni alla stazione di ricarica RGB     */           
#define ADDR_PM_MODE_RW                         (ADDR_MAX_TEMPORARY_POWER_AC            + LEN_MAX_TEMPORARY_POWER_AC            )  /* address registro utilizzato modalità Power management                */           
#define ADDR_ENABLE_LOG_RW                      (ADDR_PM_MODE_RW                        + LEN_PM_MODE_RW                        )  /* address abilitazione log su SD (solo DC)                             */           
#define ADDR_AUTHORIZATION_FEEDBACK_RW          (ADDR_ENABLE_LOG_RW                     + LEN_ENABLE_LOG_RW                     )  /* address in modalità NET autorizza e controlla la carica              */           
#define ADDR_TIMEZONE_RW                        (ADDR_AUTHORIZATION_FEEDBACK_RW         + LEN_AUTHORIZATION_FEEDBACK_RW         )  /* address time zone rispetto a UTC                                     */           
#define ADDR_MENU_VISIBILITY_RW                 (ADDR_TIMEZONE_RW                       + LEN_TIMEZONE_RW                       )  /* address EX LIM_POWER_AC_RW                                           */     
#define ADDR_TIMEOUT_RANGE1_RW                  (ADDR_MENU_VISIBILITY_RW                + LEN_MENU_VISIBILITY_RW                )  /* address per il valore di partenza del contatore T1                   */           
#define ADDR_TIMEOUT_RANGE2_RW                  (ADDR_TIMEOUT_RANGE1_RW                 + LEN_TIMEOUT_RANGE1_RW                 )  /* address per il valore di partenza del contatore T2                   */           
#define ADDR_PRODUCT_CODE_RW                    (ADDR_TIMEOUT_RANGE2_RW                 + LEN_TIMEOUT_RANGE2_RW                 )  /* address Codice prodotto SCAME                                        */           
#define ADDR_TECN_PRODUCT_CODE_RW               (ADDR_PRODUCT_CODE_RW                   + LEN_PRODUCT_CODE_RW                   )  /* address Codice FAKE prodotto SCAME                                   */ 
#define ADDR_CONNECTOR_N_RW                     (ADDR_TECN_PRODUCT_CODE_RW              + LEN_TECN_PRODUCT_CODE_RW              )  /* address Numero connettore nella EVSE                                 */     
#define ADDR_DISPLAY_LANGUAGES_RW               (ADDR_CONNECTOR_N_RW                    + LEN_CONNECTOR_N_RW                    )  /* address Lingua impostata e lingua di default                         */
#define ADDR_MAX_TYPICAL_CURRENT_RW             (ADDR_DISPLAY_LANGUAGES_RW              + LEN_DISPLAY_LANGUAGES_RW              )  /* address Massima corrente in modalità tipica impostata                */
#define ADDR_MAX_SIMPLIFIED_CURRENT_RW          (ADDR_MAX_TYPICAL_CURRENT_RW            + LEN_MAX_TYPICAL_CURRENT_RW            )  /* address Massima corrente in modalità semplificata                    */
#define ADDR_CHARGE_TIME_RW                     (ADDR_MAX_SIMPLIFIED_CURRENT_RW         + LEN_MAX_SIMPLIFIED_CURRENT_RW         )  /* address Flag per presenza componenti hardware (Wi-Fi, BT...)         */
#define ADDR_CHARGE_MAX_ENERGY_RW               (ADDR_CHARGE_TIME_RW                    + LEN_CHARGE_BY_TIME_RW                 )  /* address Tempo massimo di una carica                                  */
#define ADDR_PM_IMIN_RW                         (ADDR_CHARGE_MAX_ENERGY_RW              + LEN_CHARGE_BY_ENERGY_RW               )  /* address Corrente minima erogabile con funzione Power Management      */
#define ADDR_PM_PMAX_RW                         (ADDR_PM_IMIN_RW                        + LEN_PM_IMIN_RW                        )  /* address Potenza massima erogabile con funzione Power Management      */
#define ADDR_PM_FLAGS_RW                        (ADDR_PM_PMAX_RW                        + LEN_PM_PMAX_RW                        )  /* address Flag di abilitazione funzione Power Management               */
#define ADDR_PM_HPOWER_RW                       (ADDR_PM_FLAGS_RW                       + LEN_PM_FLAGS_RW                       )  /* address Isteresi massima di potenza erogabile Power Management       */
#define ADDR_PM_DSET_RW                         (ADDR_PM_HPOWER_RW                      + LEN_PM_HPOWER_RW                      )  /* address Variazione della potenza in erogazione verso l'EV            */
#define ADDR_PM_DMAX_RW                         (ADDR_PM_DSET_RW                        + LEN_PM_DSET_RW                        )  /* address Valore di isteresi potenza in eccesso erogata dall'EVSE      */     
#define ADDR_PIN_EXTERNAL_ENERGY_METER_RW       (ADDR_PM_DMAX_RW                        + LEN_PM_DMAX_RW                        )  /* address pin energy meter esterno                                     */                
#define ADDR_LIM_MAX_POWER_AC_RW                (ADDR_PIN_EXTERNAL_ENERGY_METER_RW      + LEN_PIN_EXTERNAL_ENERGY_METER_RW      )  /* address max power AC                                      */                
#define ADDR_RESERVED_A                         (ADDR_LIM_MAX_POWER_AC_RW               + LEN_LIM_MAX_POWER_AC_RW               )  /* address reserved for future use                                      */           

#define ADDR_FILE_COMMAND_RW                    ((uint16_t)0x0100                       + 0                                     )  /* address Comando per avviare l'aggiornamento SW                                           */           
#define ADDR_FILE_SIZE_RW                       (ADDR_FILE_COMMAND_RW                   + LEN_FILE_COMMAND_RW                   )  /* address Registro con indicazione dello stato di aggiornamento firmware                   */           
#define ADDR_FILE_PACKET_RW                     (ADDR_FILE_SIZE_RW                      + LEN_FILE_SIZE_RW                      )  /* address last rw register    */           
#define ADDR_END_RW_REGS_WO                     (ADDR_FILE_PACKET_RW                    + LEN_FILE_PACKET_RW                    )  /* address last rw register    */           

/****          definizioni indirizzi per l'ambiente RSE-SINAPSI                          ***************************************************************************************  */
#define ADDR_RSE_IOM_CTRL_REG                   ((uint16_t)0x0800                       + 0                                     ) /* address registro di controllo per SINAPSI-RSE                               */           
#define ADDR_RSE_M2_POT_ATT_IMM_IST_TS          (ADDR_RSE_IOM_CTRL_REG                  + LEN_IOM_CTRL_REG                      ) /* address time stamp potenza attiva immessa istantanea letta dal contatore M2 */           
#define ADDR_RSE_M2_POT_ATT_IMM_IST             (ADDR_RSE_M2_POT_ATT_IMM_IST_TS         + LEN_M2_POT_ATT_IMM_IST_TS             ) /* address  potenza attiva immessa istantanea letta dal contatore M2           */           
#define ADDR_RSE_M2_POT_CONTRATTUALE_TS         (ADDR_RSE_M2_POT_ATT_IMM_IST            + LEN_M2_POT_ATT_IMM_IST                ) /* address time stamp potenza contrattuale del contatore M2                    */           
#define ADDR_RSE_M2_POT_CONTRATTUALE            (ADDR_RSE_M2_POT_CONTRATTUALE_TS        + LEN_M2_POT_CONTRATTUALE_TS            ) /* address potenza contrattuale del contatore M2                               */           
#define ADDR_RSE_M1_POT_CONTRATTUALE_TS         (ADDR_RSE_M2_POT_CONTRATTUALE           + LEN_M2_POT_CONTRATTUALE               ) /* address time stamp potenza contrattuale del contatore M1                    */           
#define ADDR_RSE_M1_POT_CONTRATTUALE            (ADDR_RSE_M1_POT_CONTRATTUALE_TS        + LEN_M1_POT_CONTRATTUALE_TS            ) /* address potenza contrattuale del contatore M1                               */           
#define ADDR_RSE_M1_POT_DISPONIBILE_TS          (ADDR_RSE_M1_POT_CONTRATTUALE           + LEN_M1_POT_CONTRATTUALE               ) /* address time stamp potenza disponibile  del contatore M1                    */           
#define ADDR_RSE_M1_POT_DISPONIBILE             (ADDR_RSE_M1_POT_DISPONIBILE_TS         + LEN_M1_POT_DISPONIBILE_TS             ) /* address potenza disponibile  del contatore M1                               */           
#define ADDR_RSE_M1_POT_ATT_PRE_IST_TS          (ADDR_RSE_M1_POT_DISPONIBILE            + LEN_M1_POT_DISPONIBILE                ) /* address time stamp potenza attiva prelevata istantanea al contatore M1      */           
#define ADDR_RSE_M1_POT_ATT_PRE_IST             (ADDR_RSE_M1_POT_ATT_PRE_IST_TS         + LEN_M1_POT_ATT_PRE_IST_TS             ) /* address potenza attiva prelevata istantanea al contatore M1                 */           
#define ADDR_RSE_M1_POT_ATT_IMM_IST_TS          (ADDR_RSE_M1_POT_ATT_PRE_IST            + LEN_M1_POT_ATT_PRE_IST                ) /* address time stamp potenza attiva immessa istantanea al contatore M1        */           
#define ADDR_RSE_M1_POT_ATT_IMM_IST             (ADDR_RSE_M1_POT_ATT_IMM_IST_TS         + LEN_M1_POT_ATT_IMM_IST_TS             ) /* address potenza attiva immessa istantanea al contatore M1                   */           
#define ADDR_RSE_M1_RES_DISTACCO_TS             (ADDR_RSE_M1_POT_ATT_IMM_IST            + LEN_M1_POT_ATT_IMM_IST                ) /* address time stamp da cui si calcola il tempo di distacco al contatore M1   */           
#define ADDR_RSE_M1_TEMPO_RES_DIST              (ADDR_RSE_M1_RES_DISTACCO_TS            + LEN_M1_DISTACCO_TS                    ) /* address tempo di distacco al contatore M1                                   */           
#define ADDR_RSE_M1_PROF_FASCIA_ORARIA_TS       (ADDR_RSE_M1_TEMPO_RES_DIST             + LEN_M1_TEMPO_RES_DIST                 ) /* address time stamp da cui parte la fascia oraria corrente al contatore M1   */           
#define ADDR_RSE_M1_PROF_FASCIA_ORARIA          (ADDR_RSE_M1_PROF_FASCIA_ORARIA_TS      + LEN_M1_PROF_FASCIA_ORARIA_TS          ) /* address tempo di distacco al contatore M1                                   */           
#define ADDR_RSE_M1_POT_MAX_RIC_TLIM            (ADDR_RSE_M1_PROF_FASCIA_ORARIA         + LEN_M1_PROF_FASCIA_ORARIA             ) /* address potenza massima Pmaxt di ricarica a tempo limitato al contatore M1  */           
#define ADDR_RSE_M1_POT_TEMPO_LIMITE_TS         (ADDR_RSE_M1_POT_MAX_RIC_TLIM           + LEN_M1_POT_MAX_RIC_TLIM               ) /* address time stamp, data-ora fino a cui si può ricaricare a Pmaxt           */           
#define ADDR_RSE_M1_SOSP_RIC_TLIM_TS            (ADDR_RSE_M1_POT_TEMPO_LIMITE_TS        + LEN_M1_POT_TEMPO_LIMITE_TS            ) /* address time stamp, data-ora fino a cui è obbligatorio sospendere la carica */           
#define ADDR_RSE_M1_UNIXTIME_SYNC               (ADDR_RSE_M1_SOSP_RIC_TLIM_TS           + LEN_M1_SOSP_RIC_TLIM_TS               ) /* address sincronizzazione orologio nel formato unixtime                      */           
#define ADDR_RSE_SET_CONFIG_MODE                (ADDR_RSE_M1_UNIXTIME_SYNC              + LEN_M1_UNIXTIME_SYNC                  ) /* address set configuration Bluetooth board SINAPSI                           */ 
#define ADDR_RSE_END_RW_REGS                    (ADDR_RSE_SET_CONFIG_MODE               + LEN_SET_CONFIG_MODE                   ) /* address last RSE rw register                                                */           

/****          definizioni indirizzi per l'ambiente collaudo PEN  (ultimo indirizzo precedente 0x081F)  *******************************************************  */
#define ADDR_PEN_RELE_REG                       ((uint16_t)0x0500                       + 0                                     ) /* address registro di controllo per SINAPSI-RSE                               */           
#define ADDR_PEN_RELE_END                       (ADDR_PEN_RELE_REG                      + LEN_PEN_RELE_RWD                      ) /* address fine mappa per test PEN                                             */           

/****          definizioni indirizzi per simulare energy meter Lovato Ethernet   *******************************************************  */
#define ADDR_EM_LOVATO_V_SYS                    ((uint16_t)0x0550                       + 0                                     ) /* address registro lettura tensione di sistema                                */           
#define ADDR_EM_LOVATO_P_AREA                   (ADDR_EM_LOVATO_V_SYS                   + LEN_EM_LOVATO_V_SYS                   ) /* address registro lettura tensione di fase L2                                */           
#define ADDR_EM_LOVATO_END                      (ADDR_EM_LOVATO_P_AREA                  + LEN_EM_LOVATO_P_AREA                  ) /* address last LOVATO EM rw register                                                */           


/****          definizioni indirizzi per l'ambiente Macchina di collaudo  (ultimo indirizzo precedente 0x50F)  *******************************************************  */
#define ADDR_TM_MEASURED_CURRENT_RW             ((uint16_t)0x510                        + 0                                     ) /* address Corrente misurata dall'EM interno alla macchina di collaudo         */
#define ADDR_TM_MEASURED_VOLTAGE_RW             (ADDR_TM_MEASURED_CURRENT_RW            + LEN_TM_MEASURED_CURRENT_RW            ) /* address Tensione misurata dall'EM interno alla macchina di collaudo         */
#define ADDR_TM_EVSE_READY_RO                   (ADDR_TM_MEASURED_VOLTAGE_RW            + LEN_TM_MEASURED_VOLTAGE_RW            ) /* address Flag SCU pronta a proseguire i test di collaudo                     */
#define ADDR_ADDR_S_CONN_RW                     (ADDR_TM_EVSE_READY_RO                  + LEN_TM_EVSE_READY_RO                  ) /* address Codice di attivazione presa segnato anche nel manuale utente        */
#define ADDR_TM_ADDR_REQ_RW                     (ADDR_ADDR_S_CONN_RW                    + LEN_TM_ADDR_S_CONN_RW                 ) /* address richiesta indirizzamento automatico                                 */
#define ADDR_TM_ADDR_ASS_RW                     (ADDR_TM_ADDR_REQ_RW                    + LEN_TM_ADDR_REQ_RW                    ) /* address asseganzione indirizzamento automatico                              */
#define ADDR_TM_ERROR1_RO                       (ADDR_TM_ADDR_ASS_RW                    + LEN_TM_ADDR_ASS_RW                    ) /* address Codice errori in fase di collaudo                                   */
#define ADDR_TM_UID_MASTER_RW                   (ADDR_TM_ERROR1_RO                      + LEN_ADDR_TM_ERROR1_RO                 ) /* address Codice errori in fase di collaudo                                   */
#define ADDR_TM_UID_USER_RW                     (ADDR_TM_UID_MASTER_RW                  + LEN_TM_UID_MASTER_RW                  ) /* address Codice errori in fase di collaudo                                   */
#define ADDR_TM_MEASURED_CURRENT_L2_RW          (ADDR_TM_UID_USER_RW                    + LEN_TM_UID_USER_RW                    ) /* address Corrente misurata dall'EM interno alla macchina di collaudo L2      */
#define ADDR_TM_MEASURED_VOLTAGE_L2_RW          (ADDR_TM_MEASURED_CURRENT_L2_RW         + LEN_TM_MEASURED_CURRENT_L2_RW         ) /* address Tensione misurata dall'EM interno alla macchina di collaudo L2      */
#define ADDR_TM_MEASURED_CURRENT_L3_RW          (ADDR_TM_MEASURED_VOLTAGE_L2_RW         + LEN_TM_MEASURED_VOLTAGE_L2_RW         ) /* address Corrente misurata dall'EM interno alla macchina di collaudo L3      */
#define ADDR_TM_MEASURED_VOLTAGE_L3_RW          (ADDR_TM_MEASURED_CURRENT_L3_RW         + LEN_TM_MEASURED_CURRENT_L3_RW         ) /* address Tensione misurata dall'EM interno alla macchina di collaudo L3      */
#define ADDR_GET_EEPROM_RW                      (ADDR_TM_MEASURED_VOLTAGE_L3_RW         + LEN_TM_MEASURED_VOLTAGE_L3_RW         ) /* address lettura parametri in EEPROM                                         */
#define ADDR_RESERVED_B                         (ADDR_GET_EEPROM_RW                     + LEN_TM_GET_EEPROM_RW                  ) /* address reserved for future use                                             */


/****          definizioni indirizzi per l'ambiente APP - Wi-Fi  (ultimo indirizzo precedente 0x81FF)  *******************************************************  */
#define ADDR_CONNECTOR_INIT_STATUS_RO           ((uint16_t)0x8200                       + 0                                     ) /* address Stato di attivazione della presa                                    */
#define ADDR_CONNECTOR_OPERATION_STATUS_RO      (ADDR_CONNECTOR_INIT_STATUS_RO          + LEN_CONNECTOR_INIT_STATUS_RO          ) /* address Registro stato IDLE della presa, richiesto da Enrico per ios        */       
#define ADDR_PROCEDURE_RESPONSE_RO              (ADDR_CONNECTOR_OPERATION_STATUS_RO     + LEN_CONNECTOR_OPERATION_STATUS_RO     ) /* address Registro di esito procedura richiesta dalla App                     */
#define ADDR_PM_TOTAL_POWER_RO                  (ADDR_PROCEDURE_RESPONSE_RO             + LEN_PROCEDURE_RESPONSE_RO             ) /* address Energia totale esterna                                              */
#define ADDR_PM_L1_POWER_RO                     (ADDR_PM_TOTAL_POWER_RO                 + LEN_PM_TOTAL_POWER_RO                 ) /* address Energia esterna fase 1                                              */
#define ADDR_PM_L2_POWER_RO                     (ADDR_PM_L1_POWER_RO                    + LEN_PM_L1_POWER_RO                    ) /* address Energia esterna fase 2                                              */
#define ADDR_PM_L3_POWER_RO                     (ADDR_PM_L2_POWER_RO                    + LEN_PM_L2_POWER_RO                    ) /* address Energia esterna fase 3                                              */
#define ADDR_APP_LOGIN_USER_TYPE_RO             (ADDR_PM_L3_POWER_RO                    + LEN_PM_L3_POWER_RO                    ) /* address Tipologia di utente che ha fatto il login                           */
#define ADDR_CONNECTOR_CHECK_ACTIV_KEY_RW       (ADDR_APP_LOGIN_USER_TYPE_RO            + LEN_APP_LOGIN_USER_TYPE_RO            ) /* address Controllo codice di attivazione manuale utente                      */
#define ADDR_CONNECTOR_NAME_RW                  (ADDR_CONNECTOR_CHECK_ACTIV_KEY_RW      + LEN_CONNECTOR_CHECK_ACTIV_KEY_RW      ) /* address Nome della presa scelto dall'utente                                 */
#define ADDR_CONNECTOR_PIN_RW                   (ADDR_CONNECTOR_NAME_RW                 + LEN_CONNECTOR_NAME_RW                 ) /* address Pin della presa scelto dall'utente in fase di inizializzazione      */
#define ADDR_ROUTER_NET_SSID_RW                 (ADDR_CONNECTOR_PIN_RW                  + LEN_CONNECTOR_PIN_RW                  ) /* address SSID della rete del router domestico                                */
#define ADDR_ROUTER_NET_PASSWORD_RW             (ADDR_ROUTER_NET_SSID_RW                + LEN_ROUTER_NET_SSID_RW                ) /* address Password della rete del router domestico                            */
#define ADDR_CONNECTOR_ROUTER_IP_RW             (ADDR_ROUTER_NET_PASSWORD_RW            + LEN_ROUTER_NET_PASSWORD_RW            ) /* address Indirizzo IP modulo nella rete del router domestico                 */
#define ADDR_PROCEDURE_REQUEST_RW               (ADDR_CONNECTOR_ROUTER_IP_RW            + LEN_CONNECTOR_ROUTER_IP_RW            ) /* address Registro per richiesta procedura dalla App                          */
#define ADDR_SCHEDULE_FLAG1_RW                  (ADDR_PROCEDURE_REQUEST_RW              + LEN_PROCEDURE_REQUEST_RW              ) /* address Flag attivazione schedulazione 1                                    */
#define ADDR_SCHEDULE_START1_RW                 (ADDR_SCHEDULE_FLAG1_RW                 + LEN_SCHEDULE_FLAG1_RW                 ) /* address Ora inizio carica schedulazione 1                                   */
#define ADDR_SCHEDULE_STOP1_RW                  (ADDR_SCHEDULE_START1_RW                + LEN_SCHEDULE_START1_RW                ) /* address Ora fine carica schedulazione 1                                     */
#define ADDR_SCHEDULE_POWER1_RW                 (ADDR_SCHEDULE_STOP1_RW                 + LEN_SCHEDULE_STOP1_RW                 ) /* address massima potenza schedulazione 1                                     */                
#define ADDR_SCHEDULE_FLAG2_RW                  (ADDR_SCHEDULE_POWER1_RW                + LEN_SCHEDULE_POWER1_RW                ) /* address Flag attivazione schedulazione 2                                    */
#define ADDR_SCHEDULE_START2_RW                 (ADDR_SCHEDULE_FLAG2_RW                 + LEN_SCHEDULE_FLAG2_RW                 ) /* address Ora inizio carica schedulazione 2                                   */
#define ADDR_SCHEDULE_STOP2_RW                  (ADDR_SCHEDULE_START2_RW                + LEN_SCHEDULE_START2_RW                ) /* address Ora fine carica schedulazione 2                                     */
#define ADDR_SCHEDULE_POWER2_RW                 (ADDR_SCHEDULE_STOP2_RW                 + LEN_SCHEDULE_STOP2_RW                 ) /* address massima potenza schedulazione 2                                     */                
#define ADDR_SCHEDULE_FLAG3_RW                  (ADDR_SCHEDULE_POWER2_RW                + LEN_SCHEDULE_POWER2_RW                ) /* address Flag attivazione schedulazione 3                                    */
#define ADDR_SCHEDULE_START3_RW                 (ADDR_SCHEDULE_FLAG3_RW                 + LEN_SCHEDULE_FLAG3_RW                 ) /* address Ora inizio carica schedulazione 3                                   */
#define ADDR_SCHEDULE_STOP3_RW                  (ADDR_SCHEDULE_START3_RW                + LEN_SCHEDULE_START3_RW                ) /* address Ora fine carica schedulazione 3                                     */
#define ADDR_SCHEDULE_POWER3_RW                 (ADDR_SCHEDULE_STOP3_RW                 + LEN_SCHEDULE_STOP3_RW                 ) /* address massima potenza schedulazione 3                                     */                
#define ADDR_SCHEDULE_FLAG4_RW                  (ADDR_SCHEDULE_POWER3_RW                + LEN_SCHEDULE_POWER3_RW                ) /* address Flag attivazione schedulazione 4                                    */
#define ADDR_SCHEDULE_START4_RW                 (ADDR_SCHEDULE_FLAG4_RW                 + LEN_SCHEDULE_FLAG4_RW                 ) /* address Ora inizio carica schedulazione 4                                   */
#define ADDR_SCHEDULE_STOP4_RW                  (ADDR_SCHEDULE_START4_RW                + LEN_SCHEDULE_START4_RW                ) /* address Ora fine carica schedulazione 4                                     */
#define ADDR_SCHEDULE_POWER4_RW                 (ADDR_SCHEDULE_STOP4_RW                 + LEN_SCHEDULE_STOP4_RW                 ) /* address massima potenza schedulazione 4                                     */                
#define ADDR_CONNECTOR_CONNECTION_STATUS_RO     (ADDR_SCHEDULE_POWER4_RW                + LEN_SCHEDULE_POWER4_RW                ) /* address Connector connection status                                         */
#define ADDR_MAX_POWER_RO                       (ADDR_CONNECTOR_CONNECTION_STATUS_RO    + LEN_CONNECTOR_CONNECTION_STATUS_RO    ) /* address Massima potenza stazione per tachimetro app                         */                      
#define ADDR_RANDOM_DELAY_FLAG_RW               (ADDR_MAX_POWER_RO                      + LEN_MAX_POWER_RO                      ) /* address abilitazione/disabilitazione ritardo random schedulazioni           */
#define ADDR_UID_AUTHORIZATION_APP_RW           (ADDR_RANDOM_DELAY_FLAG_RW              + LEN_RANDOM_DELAY_FLAG_RW              ) /* address uid autorizzazione da app wifi                                      */        
#define ADDR_BT_SINAPSI_STATUS_RW               (ADDR_UID_AUTHORIZATION_APP_RW          + LEN_UID_AUTHORIZATION_APP_RW          ) /* address stato del bluetooth Sinapsi                                         */                
#define ADDR_FW_UPDATE_NAME_RW                  (ADDR_BT_SINAPSI_STATUS_RW              + LEN_BT_SINAPSI_STATUS_RW              ) /* address fw update name                                                      */
#define ADDR_FW_UPDATE_LEN_RW                   (ADDR_FW_UPDATE_NAME_RW                 + LEN_FW_UPDATE_NAME_RW                 ) /* address fw update length                                                    */
#define ADDR_FW_UPDATE_STATUS_RO                (ADDR_FW_UPDATE_LEN_RW                  + LEN_FW_UPDATE_LEN_RW                  ) /* address reserved for future use                                             */
#define ADDR_EVSE_POWER_MODE_RO                 (ADDR_FW_UPDATE_STATUS_RO               + LEN_FW_UPDATE_STATUS_RO               ) /* address for evse power mode                                                 */
#define ADDR_RESERVED_C                         (ADDR_EVSE_POWER_MODE_RO                + LEN_EVSE_POWER_MODE_RO                ) /* address reserved for future use                                             */

#define ADDR_UNDEF                              ((uint16_t)0xFFFF)                                                                /* address   undefined (when we use the index of the register)                 */

#define UID_AUTHORIZATION_BY_APP      0xFD

typedef __packed struct
{
  uint8_t         mfwVer[LEN_BOARD_FW_VERSION_RO * 2];                          /* Registro BOARD_FW_VERSION_RO v18b Modbus                     */
  uint8_t         rfdVer[LEN_MIFARE_FW_VERSION_RO * 2];                         /* Registro MIFARE_FW_VERSION_RO v18b Modbus                    */
  uint8_t         devSn[LEN_BOARD_SN_RO * 2];                                   /* Registro BOARD_SN_RO v18b Modbus                             */
  uint8_t         plcVer[LEN_PLC_FW_VERSION_RO * 2];                            /* Registro PLC_FW_VERSION_RO v18b Modbus                       */
  uint8_t         plcMac[LEN_PLC_MAC_ADDRESS_RO * 2];                           /* Registro PLC_MAC_ADDRES_RO v18b Modbus                       */
  uint8_t         hwRev[LEN_HW_REVISION_RO * 2];                                /* Registro HW_REVISION_RO v18b Modbus                          */
  uint8_t         macWifi[LEN_WIFI_MAC_ADDRESS_RO * 2];                         /* Registro WIFI_MAC_ADDRESS_RO v18b Modbus                     */        
  uint8_t         pwrSn[LEN_POWER_MODULE_SN_RO * 2];                            /* Registro POWER_MODULE_SN_RO v18b Modbus                      */
  uint8_t         macBle[LEN_BLE_MAC_ADDRESS_RO * 2];                           /* Registro BLE_MAC_ADDRESS_RO v18b Modbus                      */
  uint8_t         prodSn[LEN_PRODUCT_SN_RO * 2];                                /* Registro PRODUCT_SN_RO v18b Modbus                           */
  uint8_t         prodCode[LEN_PRODUCT_CODE_RO * 2];                            /* Registro PRODUCT_CODE_RO v18b Modbus                         */
  uint8_t         bootfwVer[LEN_BOOT_FW_VERSION_RO * 2];                        /* Registro BOOT CODE VERSION_RO v18b Modbus                    */
  uint16_t        modbusVersion;                                                /* Registro versione modbus                                     */
} scuMapRegInfoVer_st;

typedef __packed struct
{
  uint32_t        ntfPresences;                                                 /* Registro NOTIFY_EVSE_PRESENCE_RO v18b Modbus                 */                                                     
  uint32_t        ntfChangeRo;                                                  /* Registro NOTIFY_EVSE_CHANGE_RO v18b Modbus                   */
  uint16_t        ntfErr1;                                                      /* Registro EVSE_ERROR1_RO v18b Modbus                          */
  uint16_t        ntfErr2;                                                      /* Registro EVSE_ERROR2_RO v18b Modbus                          */
  uint16_t        ntfChangeRegRo[SCU_NUM];                                      /* Registro EVSE_CHANGE_REGISTERS_RO v18b Modbus                */        
} scuMapRegNotify_st;

typedef __packed struct
{
  uint16_t        ntfSktEvent;                                                  /* Registro EVSE_EVENT_FLAGS_RO v18b Modbus                     */
  uint16_t        ntfChgStat;                                                   /* Registro EVSE_CHARGE_STATUS_RO v18b Modbus                   */                                        
  int32_t         tempSys;                                                      /* Registro TEMPERATURE_SYSTEM_RO v18b Modbus                   */
  uint16_t        reserved3DC[LEN_RESERVED3_RDD];                               /* Registri solo per DC                                         */
  uint32_t        mtVsys;                                                       /* Registro VOLTAGE_AC_RO v18b Modbus                           */
  uint32_t        mtPh1Cur;                                                     /* Registro CURRENT_AC_L1_RO v18b Modbus                        */        
  uint32_t        mtPh2Cur;                                                     /* Registro CURRENT_AC_L2_RO v18b Modbus                        */
  uint32_t        mtPh3Cur;                                                     /* Registro CURRENT_AC_L3_RO v18b Modbus                        */
  uint32_t        mtMaxPowerStation;                                            /* Registro ACTIVE_POWER_DC_RO v22  Modbus Pmax stazione        */
  uint32_t        mtSpPower;                                                    /* Registro ACTIVE_POWER_AC_RO v18b Modbus                      */
  uint32_t        mtSpPowerL1;                                                  /* Registro potenza attiva fase 1 v24 Modbus                    */                                                      
  uint32_t        mtSqPower;                                                    /* Registro REACTIVE_POWER_AC_RO v18b Modbus                    */
  uint32_t        mtTpEnrg;                                                     /* Registro TOTAL_ACTIVE_ENERGY_AC_EV_RO v18b Modbus            */
  uint32_t        mtSysCur;                                                     /* Registro CURRENT_AC_SYS_RO v22 Modbus                        */
  uint32_t        mtTqEnrg;                                                     /* Registro TOTAL_REACTIVE_ENERGY_ENERGY_RO v18b Modbus         */
  uint32_t        mtTppEnrg;                                                    /* Registro TRANSACTION_ACTIVE_ENERGY_AC_EV_RO v18b Modbus      */
  uint32_t        mtSpPowerL2;                                                  /* Registro potenza attiva fase 3 v24 Modbus                    */                                                      
  uint32_t        mtTqpEnrg;                                                    /* Registro TRANSACTION_REACTIVE_ENERGY_AC_EV_RO v18b Modbus    */
  uint32_t        mtFreq;                                                       /* Registro FREQUENCY_SUPPLY_RO v18b Modbus                     */                                                       
  uint16_t        reserved4DC[LEN_RESERVED4_RDD];                               /* Registri solo per DC v18b Modbus                             */                               
  uint16_t        rswCurr;                                                      /* Registro MAX_CURRENT_ROTATORY_SWITCH_RO v18b Modbus          */
  uint32_t        exRscCurr;                                                    /* Registro EX_RSC_CURR_RO migrato in RW v18b Modbus            */
  uint32_t        mtSpPowerL3;                                                  /* Registro potenza attiva fase 3 v24 Modbus                    */
  uint16_t        empty_063A;
  uint16_t        pwrCurr;                                                      /* Registro MAX_POWER_RESULT_RO v24 Modbus                      */
  uint32_t        evSessionT;                                                   /* Registro TRANSACTION_TIME_RO v18b Modbus                     */
  uint32_t        evRemainT;                                                    /* Registro TRANSACTION_COUNTDOWN_RO v18b Modbus                */        
  uint16_t        evSoc;                                                        /* Registro EV_BATTERY_RO v18b Modbus                           */
  uint32_t        evSessionId;                                                  /* Registro SESSION_ID_RO v18b Modbus                           */
  uint16_t        evRstFlag;                                                    /* Registro EVSE_BOOT_EVENT_RO v18b Modbus                      */
  uint32_t        totActEnrgGrid;                                               /* Registro TOTAL_ACTIVE_ENERGY_AC_GRID_RO v18b Modbus          */
  uint32_t        totReactEnrgGrid;                                             /* Registro TOTAL_REACTIVE_ENERGY_AC_GRID_RO v18b Modbus        */
  uint32_t        transActEnrgGrid;                                             /* Registro TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO v18b Modbus    */
  uint32_t        transReactEnrgGrid;                                           /* Registro TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO v18b Modbus  */
  uint16_t        reservedDC6[LEN_SCU_RESERVED6];                               /* Registro TOTAL_ENERGY_DC_GRID_RO e TRANS_ENERGY_DC_GRID_RO   */
  uint8_t         uidAuth[LEN_UID_AUTHORIZATION_RO * 2];                        /* Registro UID_AUTHORIZATION_RO v18b Modbus                    */
  uint32_t        timeInCharge;                                                 /* Registro TIME_IN_CHARGE_RO v24 Modbus                        */
} scuMapRegStatusMeas_st;


typedef __packed struct
{
  uint16_t        connType;                                                     /* Registro CONNECTOR_TYPE_RW v18b Modbus                       */
  uint16_t        hwcFlags;                                                     /* Registro HWC_FLAGS_RW v18b Modbus                            */
  uint16_t        mtType;                                                       /* Registro ENERGY_METERS_RW v18b Modbus                    */
  uint16_t        pwrOutage;                                                    /* Registro POWER_OUTAGE_RW v18b Modbus                         */
  uint16_t        devAlias;                                                     /* Registro CONNECTOR_IDS_RW v18b Modbus                             */
  uint8_t         devSn[LEN_BOARD_SN_RW  * 2];                                  /* Registro BOARD_SN_RW v18b Modbus                             */
  uint8_t         prdSn[LEN_PRODUCT_SN_RW * 2];                                 /* Registro PRODUCT_SN_RW v18b Modbus                           */
  uint16_t        mstCfg;                                                       /* Registro MASTER_HW_TYPE_RW v18b Modbus                       */
  uint8_t         rtcInf[LEN_UTC_DATE_TIME_RW * 2];                             /* Registro UTC_DATE_TIME_RW v18b Modbus                        */
  uint16_t        pwrVendor;                                                    /* Registro POWER_MODULE_BRAND_RW v18b Modbus                   */
  uint16_t        pwrModel;                                                     /* Registro POWER_MODULE_MODEL_RW v18b Modbus                   */        
  uint16_t        pwrModules;                                                   /* Registro POWER_MODULE_N_RW v18b Modbus                       */
  uint16_t        tmMode;                                                       /* Registro EVSE_TM_MODE_RW v18b Modbus                         */
  uint16_t        evseMod;                                                      /* Registro EVSE_OPERATION_MODE_RW v18b Modbus                  */        
  uint16_t        cableChgSel;    /* solo DC */                                 /* Registro CHARGE_PROTOCOL_SELECTED_RW v18b Modbus             */        
  uint16_t        defDispLng;                                                   /* Registro EX_DISPLAY_LANGUAGES_RW v18b Modbus                 */
  uint16_t        hwChecks1;                                                    /* Registro HW_CHECKS1_RW v18b Modbus                           */        
  uint16_t        hwChecks2;                                                    /* Registro HW_CHECKS2_RW v18b Modbus                           */
  uint16_t        hwActuators;                                                  /* Registro HW_ACTUATORS_RW v18b Modbus                         */
  uint16_t        res7DC[LEN_SCU_RESERVED7];                                    /* Registro UNDEFINED_EX_SCU_RESERVED7 v18b Modbus              */
  uint32_t        maxTempCurr;                                                  /* Registro MAX_TEMPORARY_CURRENT_RW v18b Modbus                */                                                       
  uint16_t        empty_0033;                                                   /* Registro UNDEFINED_EX_LIM_LOW_CURR_RW v18b Modbus            */
  uint16_t        ledStrip;                                                     /* Registro LED_STRIP_RWD v24 Modbus                            */
  uint16_t        rmtCmd;                                                       /* Registro REMOTE_COMMANDS_RW v18b Modbus                      */
  uint16_t        alsBright;                                                    /* Registro ENVIRONMENT_BRIGHTNESS_RW v18b Modbus               */
  uint32_t        exPrxDist;                                                    /* Registro UNDEFINED_EX_PRX_DIST_RW v18b Modbus                */
  uint16_t        exPrxMotion;                                                  /* Registro UNDEFINED_EX_PRX_MOTION_RW v18b Modbus              */
  uint32_t        maxTempPowerAc;                                               /* Registro UNDEFINED_EX_LED_EXT_RW v18b Modbus                 */                                       
  uint16_t        pmMode;                                                       /* Registro PM_MODE_RW v22 Modbus                               */
  uint16_t        logEna;                                                       /* Registro ENABLE_LOG_RW v18b Modbus                           */
  uint16_t        authLnk;                                                      /* Registro AUTHORIZATION_FEEDBACK_RW v18b Modbus               */
  uint16_t        rtcTimeZone;                                                  /* Registro TIMEZONE_RW v18b Modbus                             */        
  uint16_t        menuVisible;                                                  /* Registro MENU_VISIBILITY_RW v18b Modbus                      */
  uint16_t        counter_T1;                                                   /* Registro TIMEOUT_RANGE1_RW v18b Modbus                       */
  uint16_t        counter_T2;                                                   /* Registro TIMEOUT_RANGE2_RW v18b Modbus                       */
  uint8_t         prdCode[LEN_PRODUCT_CODE_RW * 2];                             /* Registro PRODUCT_CODE_RW v18b Modbus                         */
  uint8_t         fakePrdCode[LEN_TECN_PRODUCT_CODE_RW * 2];                    /* Registro TECN_PRODUCT_CODE_RW v18b Modbus                    */
  uint16_t        connNumb;                                                     /* Registro CONNECTOR_N_RW v18b Modbus                          */
  uint32_t        availDispLng;                                                 /* Registro DISPLAY_LANGUAGES_RW v18b Modbus                    */
  uint16_t        maxTypCurr;                                                   /* Registro MAX_TYPICAL_CURRENT_RW v18b Modbus                  */
  uint16_t        maxSimplCurr;                                                 /* Registro MAX_SIMPLIFIED_CURRENT_RW v18b Modbus               */
  uint16_t        chgTime;                                                      /* Registro CHARGE_TIME_RW v18b Modbus                          */
  uint16_t        chgEnrg;                                                      /* Registro CHARGE_MAX_ENERGY_RW v18b Modbus                    */
  uint16_t        pmImin;                                                       /* Registro PM_IMIN_RW v18b Modbus                              */
  uint16_t        pmPmax;                                                       /* Registro PM_PMAX_RW v18b Modbus                              */
  uint16_t        pmFlags;                                                      /* Registro PM_FLAGS_RW v18b Modbus                             */
  uint16_t        pmHpower;                                                     /* Registro PM_HPOWER_RW v18b Modbus                            */
  uint16_t        pmDset;                                                       /* Registro PM_DSET_RW v18b Modbus                              */        
  uint16_t        pmDmax;                                                       /* Registro PM_DMAX_RW v18b Modbus                              */
  uint16_t        pmEmex;                                                       /* Registro PIN_EXTERNAL_ENERGY_METER_RW v21.3 Modbus           */                                
  uint32_t        limMaxPowerAc;                                                /* Registro LIM_MAX_POWER_AC_RW v24 Modbus                      */
} scuSetRegister_st;

#ifdef MODBUS_TCP_EM_LOVATO
typedef __packed struct
{
  uint16_t        sysVoltage;                                                   /* Registro versione modbus                                     */
  uint16_t        socketActivePower[SCU_NUM][3];                                /* Registro potenze attive per le possibili 16 prese trifase    */
} scuMapRegLovatoEmSim_st;
#endif

typedef __packed struct
{
  uint16_t        fileCommand;                                                       /* Registro FW_UPDATE_RW v18b Modbus                            */        
  uint32_t        fileSize;                                                          /* Registro FW_UPDATE_EVENT_RW v18b Modbus                      */  
  uint8_t         commandRx;      
  uint8_t         filesizeRx;      
} scuSetRegFwUpd_st;


/* MAPPA REGISTRI MACCHINA DI COLLAUDO */
typedef __packed struct
{
  uint16_t        tmMeasCurr;                                                   /* Registro TM_MEASURED_CURRENT_RW v18b Modbus                  */ 
  uint16_t        tmMeasVolt;                                                   /* Registro TM_MEASURED_VOLTAGE_RW v18b Modbus                  */ 
  uint16_t        tmCommand;                                                    /* Registro TM_COMMAND_RW v25 Modbus                            */ 
  uint16_t        tmAddrSconnM;                                                 /* Registro ADDR_ADDR_S_CONN_RW                                 */ 
  uint16_t        tmAddrReq;                                                    /* Registro ADDR_TM_ADDR_REQ_RW v24 Modbus                      */ 
  uint16_t        tmAddrAss;                                                    /* Registro ADDR_TM_ADDR_ASS_RW v24 Modbus                      */ 
  uint16_t        tmError1InTest;                                               /* Registro TM_ERROR1_IN_TEST_RO v25 Modbus                     */ 
  uint8_t         uidMaster[LEN_TM_UID_MASTER_RW * 2];                          /* Registro TM_UID_MASTER_RW                                    */ 
  uint8_t         uidUser[LEN_TM_UID_USER_RW * 2];                              /* Registro TM_UID_USER_RW                                      */ 
  uint16_t        tmMeasCurrL2;                                                 /* Registro TM_MEASURED_CURRENT_RW L2 v24 Modbus                */ 
  uint16_t        tmMeasVoltL2;                                                 /* Registro TM_MEASURED_VOLTAGE_RW L2 v24 Modbus                */ 
  uint16_t        tmMeasCurrL3;                                                 /* Registro TM_MEASURED_CURRENT_RW L3 v24 Modbus                */ 
  uint16_t        tmMeasVoltL3;                                                 /* Registro TM_MEASURED_VOLTAGE_RW L3 v24 Modbus                */ 
  uint16_t        tmGetEeprom;                                                  /* Registro ADDR_GET_EEPROM_RW per lettura EEPROM               */ 
} tmMapRegister_st;


/* MAPPA REGISTRI APP - WIFI (RW) */
typedef __packed struct
{
  uint16_t        connInitStat;                                                 /* Registro CONNECTOR_INIT_STATUS_RO v19.2 Modbus               */
  uint16_t        connIdleStat; /* DO NOT USE! It's used by iOS app Scame E-Mobility Registro CONNECTOR_OPERATION_STATUS_RO v19.2 Modbus        */        
  uint8_t         procResp[LEN_PROCEDURE_RESPONSE_RO * 2];                      /* Registro PROCEDURE_RESPONSE_RO v19.2 Modbus                  */
  uint32_t        pmTotPwr;                                                     /* Registro PM_TOTAL_POWER_RO v19.2 Modbus                      */
  uint32_t        pmL1Pwr;                                                      /* Registro PM_L1_POWER_RO v19.2 Modbus                         */
  uint32_t        pmL2Pwr;                                                      /* Registro PM_L2_POWER_RO v19.2 Modbus                         */
  uint32_t        pmL3Pwr;                                                      /* Registro PM_L3_POWER_RO v19.2 Modbus                         */
  uint16_t        userLogin;                                                    /* Login fatto da utente o da installatore                      */
  uint8_t         connActivKey[LEN_CONNECTOR_CHECK_ACTIV_KEY_RW * 2];           /* Registro CONNECTOR_CHECK_ACTIV_KEY_RW v19.2 Modbus           */
  uint8_t         connName[LEN_CONNECTOR_NAME_RW * 2];                          /* Registro CONNECTOR_NAME_RW v19.2 Modbus                      */
  uint8_t         connPin[LEN_CONNECTOR_PIN_RW * 2];                            /* Registro CONNECTOR_PIN_RW v19.2 Modbus                       */
  uint8_t         RoutSSID[LEN_ROUTER_NET_SSID_RW * 2];                         /* Registro ROUTER_NET_SSID_RW v19.2 Modbus                     */
  uint8_t         RoutPass[LEN_ROUTER_NET_PASSWORD_RW * 2];                     /* Registro ROUTER_NET_PASSWORD_RW v19.2 Modbus                 */
  uint8_t         RoutIP[LEN_CONNECTOR_ROUTER_IP_RW * 2];                       /* Registro CONNECTOR_ROUTER_IP_RW v19.2 Modbus                 */
  uint16_t        procReq;                                                      /* Registro PROCEDURE_REQUEST_RW v19.2 Modbus                   */
  uint16_t        schFlag1;                                                     /* Registro SCHEDULE_FLAG1_RW v19.2 Modbus                      */
  uint16_t        schStart1;                                                    /* Registro SCHEDULE_START1_RW v19.2 Modbus                     */
  uint16_t        schStop1;                                                     /* Registro SCHEDULE_STOP1_RW v19.2 Modbus                      */
  uint32_t        schPower1;                                                    /* Registro SCHEDULE_POWER1_RW v19.2 Modbus                     */
  uint16_t        schFlag2;                                                     /* Registro SCHEDULE_FLAG2_RW v19.2 Modbus                      */
  uint16_t        schStart2;                                                    /* Registro SCHEDULE_START2_RW v19.2 Modbus                     */
  uint16_t        schStop2;                                                     /* Registro SCHEDULE_STOP2_RW v19.2 Modbus                      */
  uint32_t        schPower2;                                                    /* Registro SCHEDULE_POWER2_RW v19.2 Modbus                     */
  uint16_t        schFlag3;                                                     /* Registro SCHEDULE_FLAG3_RW v19.2 Modbus                      */
  uint16_t        schStart3;                                                    /* Registro SCHEDULE_START3_RW v19.2 Modbus                     */
  uint16_t        schStop3;                                                     /* Registro SCHEDULE_STOP3_RW v19.2 Modbus                      */
  uint32_t        schPower3;                                                    /* Registro SCHEDULE_POWER3_RW v19.2 Modbus                     */
  uint16_t        schFlag4;                                                     /* Registro SCHEDULE_FLAG4_RW v19.2 Modbus                      */
  uint16_t        schStart4;                                                    /* Registro SCHEDULE_START4_RW v19.2 Modbus                     */
  uint16_t        schStop4;                                                     /* Registro SCHEDULE_STOP4_RW v19.2 Modbus                      */
  uint32_t        schPower4;                                                    /* Registro SCHEDULE_POWER4_RW v19.2 Modbus                     */
  uint16_t        connectStatus;                                                /* Registro CONNECTOR_CONNECTION_STATUS_RO v19.2 Modbus         */                
  uint32_t        maxPower;                                                     /* Registro MAX_POWER_RO v20 Modbus                             */ 
  uint16_t        randomDelay;                                                  /* Registro RANDOM_DELAY_FLAG_RW v20.2 Modbus                   */                
  uint8_t         uidAuthApp[LEN_UID_AUTHORIZATION_APP_RW * 2];                 /* Registro UID_AUTHORIZATION_APP_RW v21 Modbus                 */        
  uint16_t        btSinapsiStatus;                                              /* Registro BT_SINAPSI_STATUS_RW v21.3 Modbus                   */
  uint8_t         fwUpdateName[LEN_FW_UPDATE_NAME_RW * 2];                      /* Registro FW_UPDATE_NAME_RW v21.3 Modbus                      */                        
  uint32_t        fwUpdateLen;                                                  /* Registro FW_UPDATE_LEN_RW v21.3 Modbus                       */
  uint16_t        fwUpdateStatus;                                               /* Registro FW_UPDATE_STATUS_RO v21.3 Modbus                    */
  uint16_t        evsePwrMode;                                                  /* Registro EVSE_POWER_MODE_RO v21.3 Modbus                       */
} appMapRwRegister_st;

/* EXCHANGE AREA FORMAT: this structure data is put inside the exchange area by the SCU and used by APP during the login phase  */
typedef __packed struct
{
  uint16_t        rswCurr;                                                      /* Registro MAX_CURRENT_ROTATORY_SWITCH_RO v24 Modbus       */
  uint16_t        evsePwrMode;                                                  /* Registro EVSE_POWER_MODE_RO v24 Modbus                   */
  uint32_t        maxPower;                                                     /* Registro MAX_POWER_RO v24 Modbus                         */ 
  uint16_t        maxTypCurr;                                                   /* Registro MAX_TYPICAL_CURRENT_RO v24 Modbus               */
  uint16_t        evseMod;                                                      /* Registro EVSE_OPERATION_MODE_RO v24 Modbus               */        
  uint8_t         mfwVer[LEN_BOARD_FW_VERSION_RO * 2];                          /* Registro BOARD_FW_VERSION_RO v24 Modbus                  */
  uint8_t         rfdVer[LEN_MIFARE_FW_VERSION_RO * 2];                         /* Registro MIFARE_FW_VERSION_RO v24 Modbus                 */
  uint16_t        mtType;                                                       /* Registro ENERGY_METERS_RO v24 Modbus                     */
  uint16_t        connectStatus;                                                /* Registro CONNECTOR_CONNECTION_STATUS_RO v24 Modbus       */                
  uint8_t         RoutSSID[LEN_ROUTER_NET_SSID_RW * 2];                         /* Registro ROUTER_NET_SSID_RW v24 Modbus                   */
  uint16_t        schFlag1[20];                                                 /* Registro SCHEDULE_FLAG1_RO v24 Modbus                    */
  uint16_t        menuVisible;                                                  /* Registro MENU_VISIBILITY_RO v24 Modbus                   */
  uint16_t        pmImin;                                                       /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmPmax;                                                       /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmFlags;                                                      /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmHpower;                                                     /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmDset;                                                       /* Registro PM_PARAMETERS_RO v24 Modbus                     */        
  uint16_t        pmDmax;                                                       /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmMode;                                                       /* Registro PM_MODE_RO v24 Modbus                           */
  uint16_t        hwChecks1;                                                    /* Registro HW_CHECKS1_RO v24 Modbus                        */        
  uint16_t        hwChecks2;                                                    /* Registro HW_CHECKS2_RO v24 Modbus                        */
  uint16_t        hwActuators;                                                  /* Registro HW_ACTUATORS_RO v24 Modbus                      */
} appMapRoRegister_st;

typedef __packed struct
{
  uint16_t        startAddr;
  uint16_t        endAddr;
} addrLimits_st;

typedef __packed struct
{
  addrLimits_st   inventoryData;
  addrLimits_st   notifyData;
  addrLimits_st   statusData;
} infoAddr_st;


/* MAPPA REGISTRI READ ONLY */
typedef __packed struct
{
  scuMapRegInfoVer_st     scuMapRegInfoVer;                                             // struttura che contiene informazioni sulle versioni HW e SW Start 0x0300
  scuMapRegNotify_st      scuMapRegNotify;                                              // struttura per i registri di notifica                       Start 0x0400
  scuMapRegStatusMeas_st  scuMapRegStatusMeas;                                          // struttura per i registri di status e misure                Start 0x0600
  uint8_t                 rfdUid[LEN_UID_AUTHORIZATION_RO * 2];                         // struttura per i registro di info suUID carta RFID          Start 0x0650       
} scuRoMapRegister_st;


/* MAPPA REGISTRI READ/WRITE */
typedef __packed struct
{
  scuSetRegister_st     scuSetRegister;                                                 // struttura che contiene informazioni di settings            Start 0x0000
  uint8_t               reserved_A[(uint16_t)0x100 - sizeof(scuSetRegister_st)];        // spare area 
  scuSetRegFwUpd_st     scuSetRegFwUpd;                                                 // struttura che contiene informazioni per Fw upgrade         Start 0x0100
  rseSetReg_st          rseSetReg;                                                      // struttura che contiene informazioni RSE-SINAPSI            Start 0x0800
  uint16_t              penReleReg;                                                     // struttura che contiene informazioni condi relè gig PEN     Start 0x0830
} scuRwMapRegister_st;


typedef __packed struct
{
  headerScuRx_st      headerScuRx;
  ScuMessage_u        message;
} frameScuRx_st;

typedef __packed struct
{
  ScuMessage_u        message;
} frameMdbRx_st;


/* REGISTRO EVSE_CHARGE_STATUS_RO --> Address = 0x0601, 1 word */
typedef enum
{
  INITIAL_EVSE_STATE            = 0x00,         /* Initial EVSE state modbus v19.2                      */ 
  IDLE_STATE                    = 0x01,         /* IDLE EVSE state modbus v19.2                         */ 
  PREPARING_STATE               = 0x02,         /* PREPARING EVSE state modbus v19.2                    */ 
  EV_CONNECTED_STATE,                           /* CONNECTED EVSE state modbus v19.2                    */
  CHARGING_STATE,                               /* INCHARGE EVSE state modbus v19.2                     */
  SUSPENDED_EV_STATE,                           /* SUSPENDED EV EVSE state modbus v19.2                 */
  SUSPENDED_EVSE_STATE,                         /* SUSPENDED EVSE EVSE state modbus v19.2               */
  END_CHARGE_STATE,                             /* END CHARGE EVSE state modbus v19.2                   */
  FAULTED_STATE,                                /* FAULTED EVSE state modbus v20                        */
  UNVAILABLE_STATE,                             /* UNVAILABLE EVSE state modbus v20                     */
  RESERVED_STATE,                               /* RESERVED EVSE state modbus v20                       */
  BOOTLOADER_STATE,                             /* BOOTLOADER EVSE state modbus v20                     */
  SHUTDOWN_STATE,                               /* SHUTDOWN EVSE state modbus v20                       */
  REBOOTING_STATE,                              /* REBOOTING EVSE state modbus v20                      */
  SUSPENDED_NOPOWER_STATE                       /* SUSPENDED EVSE by NO POWER state modbus v24          */
} evseChargeStatusReg_e;


/* REGISTRO EVSE_EVENT_FLAGS_RO --> Address = 0x0600, 1 word */
typedef enum
{
  EVSE_EVENT_UNDEFINED          = 0x00,         /* EVENT UNDEFINED                                      */
  SOCKET_BLOCKED                = 0x01,         /* SOCKET BLOCKED event modbus v20                      */ 
  CONNECTOR_PLUGGED_IN          = 0x02,         /* CONNECTOR PLUGGED IN event modbus v20                */ 
} evseEventFlagsReg_e;


/* REGISTRO HWC_FLAGS_RW --> Address = 0x0001, 1 word */
typedef enum
{
  HW_FLAGS_UNDEFINED            = 0x0000,       /* FLAGS UNDEFINED                                      */
  DIFF_RIARM_FLAG               = 0x0001,       /* DIFFERENZIALE RIARMABILE                             */ 
  DISPLAY_LCD_FLAG              = 0x0002,       /* DISPLAY GRAFICO + TOUCH                              */ 
  RFID_READER_FLAG              = 0x0004,       /* LETTORE RFID                                         */ 
  WIFI_CONNECTION_FLAG          = 0x0008,       /* WIFI CONNECTION                                      */
} hwFlags_e;


/* REGISTRO EVSE_OPERATION_MODE_RW --> Address = 0x0023, 1 word */
typedef enum
{
  OP_MODE_FREE                  = 0x00,         /* FREE operation mode                                  */
  OP_MODE_PERSONAL              = 0x01,         /* PERSONAL operation mode                              */ 
  OP_MODE_NET                   = 0x02,         /* NET operation mode                                   */ 
  OP_MODE_OCPP                  = 0x03          /* OCPP operation mode                                  */ 
} opMode_e;


/* REGISTRO EVSE_AVAILABILITY_RW --> Address = 0x0023, 1 word */
typedef enum
{
  EVSE_UNDEFINED_AVAILAB         = 0x00,         /* Valore non definito, init                            */        
  EVSE_DISPONIBILE               = 0x01,         /* Socket disponibile                                   */
  EVSE_NON_DISPONIBILE           = 0x02,         /* Socket non disponibile / in manutenzione             */ 
  EVSE_RISERVATO                 = 0x03          /* Socket riservata                                     */ 
} evseAvailab_e;
  

/* REGISTRO POWER_OUTAGE_TYPE_RW --> Address = 0x0003, 1 word */
typedef enum
{
  POWER_NONE                     = 0x00,         /* Power outage module NONE                             */
  POWER_BACK                     = 0x01,         /* Power outage Backup battery                          */ 
  POWER_MON                      = 0x02,         /* Power outage Monitor module                          */
  POWER_PEN                      = 0x03          /* Power outage PEN module                              */    
} powerOutage_e;


/* REGISTRO EVSE_ERROR1_RO --> Address = 0x0404, 1 word */
typedef enum
{
  ERROR1_NONE                    = 0x0000,       /* Error 1 register, value NO error                     */
  ERROR1_RCDM                    = 0x0001,       /* Error 1 register, value RCDM error                   */ 
  ERROR1_LIDE                    = 0x0002,       /* Error 1 register, value LIDE error                   */
  ERROR1_VENT                    = 0x0004,       /* Error 1 register, value ventilation error            */
  ERROR1_BLCK                    = 0x0008,       /* Error 1 register, value socket block error           */
  ERROR1_BLEF                    = 0x0010,       /* Error 1 register, value Bluetooth error              */
  ERROR1_WIFI                    = 0x0020,       /* Error 1 register, value Wi-fi error                  */
  ERROR1_MIRR                    = 0x0040,       /* Error 1 register, value Mirror error                 */
  ERROR1_RCBO                    = 0x0080,       /* Error 1 register, value magnetothermic error         */
  ERROR1_CPSE                    = 0x0100,       /* Error 1 register, value CP short circuit error       */
  ERROR1_PPSE                    = 0x0200,       /* Error 1 register, value PP short circuit error       */
  ERROR1_CPLS                    = 0x0400,       /* Error 1 register, value CP lost error                */
  ERROR1_PPLS                    = 0x0800,       /* Error 1 register, value PP lost error                */
  ERROR1_VBUS                    = 0x1000,       /* Error 1 register, value low voltage supply error     */
  ERROR1_MFRE                    = 0x2000,       /* Error 1 register, value RFID reader error            */
  ERROR1_EMTR                    = 0x4000,       /* Error 1 register, value internal energy meter error  */
  ERROR1_OVCE                    = 0x8000,       /* Error 1 register, value overcurrent error            */
} error1Reg_e;


/* REGISTRO EVSE_ERROR2_RO --> Address = 0x0405, 1 word */
typedef enum
{
  ERROR2_NONE                    = 0x0000,       /* Error 2 register, value NO error                     */
  ERROR2_RCTE                    = 0x0001,       /* Error 2 register, value rectifier diode presence error */ 
  ERROR2_EMEX                    = 0x0002,       /* Error 2 register, value external energy meter error  */
  ERROR2_CHN2                    = 0x0004,       /* Error 2 register, value chain2  error                */
  ERROR2_OFFL                    = 0x0008,       /* Error 2 register, communication error on RS485       */
  ERROR2_PENF                    = 0x0010,       /* Error 2 register, value PEN error                    */
  ERROR2_HGTP                    = 0x0020,       /* Error 2 register, value high temperature error       */
} error2Reg_e;


/* REGISTRO HW_ACTUATORS_RW --> Address = 0x0028, 1 word */
typedef enum
{
  ACT_NONE                       = 0x0000,       /* Actuator NONE value                                  */
  ACT_BLCK                       = 0x0001,       /* Actuator BLOCK                                       */ 
  ACT_MIRR                       = 0x0002,       /* Actuator MIRROR                                      */
  ACT_RCBO                       = 0x0004,       /* Actuator RCBO                                        */
  ACT_WIFI                       = 0x0008,       /* Actuator WIFI                                        */
  ACT_BACK                       = 0x0010,       /* Battery backup enable                                */
  UNSED_MASK                     = 0x00E0        /* unused bit                                           */
} actuatorsReg_e;

/* REGISTRO EVSE_OPERATION_MODE_RW --> Address = 0x0023, 1 word */
#define MASTER_MODE_LOCAL        0x100
#define MASTER_MODE_OCPP         0x200

// --------------------------------------------------------------------------------------------------------------------------- //

// -------------------------- global constats -------------------------------------------------------------------------------- //

// --------------------------------------------------------------------------------------------------------------------------- //

// -------------------------- global references ------------------------------------------------------------------------------ //
extern frameMdbRx_st*           pMsgShared;                                                      /* Variabile globale per usare il frameMdbRx anche nel File Wi-Fi tramite una copia */
extern uint16_t                 frameLength;                                                     /* Lunghezza messaggio da inviare                                                   */
extern uint8_t                  InitModbusRegisters_Stop;

extern appMapRwRegister_st*     pAppRwRegs;
// --------------------------------------------------------------------------------------------------------------------------- //

/****************** FUNCTIONS IMPLEMENTATION **************************************************************************/
void                  scuGestTask                   (void * pvParameters);
void                  scuUartRxTimeoutTask          (void * pvParameters);
void                  scuDataLinkTask               (void * pvParameters);
void                  scuSemGestTask                (void * pvParameters);
xQueueHandle          getScuDataLinkQueueHandle     (void);
uint8_t*              getBuffRxScu                  (void);
xQueueHandle          getScuQueueHandle             (void);
xQueueHandle          getScuUartRxTimeoutQueueHandle(void);
void                  getFromScuRegister            (uint16_t regAddr, uint8_t size, uint8_t lpoAddr, uint8_t function);
void                  freeTxBuffer                  (void);
void                  scuModbus_IRQHandler          (void); 
uint8_t*              getRegInfoFromIdx             (uint16_t scuIdx, scuAllRegIdx_e scuRegIdx, uint16_t* pLen);        
scuOpModes_e          getScuOpMode                  (void);
void                  setScuOpMode                  (scuOpModes_e mode);
scuTypeModes_e        getScuTypeMode                (void);
void                  setScuTypeMode                (scuTypeModes_e typeMode);
void                  txOnRs485Bus                  (uint8_t* pTxBuffer, uint16_t len); 
void                  freeSemTxBuffer               (void);
void                  getFromModbusMap              (frameMdbRx_st* pRdRxFrame, uint16_t totalLen, scuOpModes_e opMode);
void                  setModbusInpReg               (uint8_t inpSig, GPIO_PinState state);
void                  setModbusErrorTesting         (uint8_t inpSig, GPIO_PinState state);
uint8_t               getLogicalMdbAddr             (void);
uint8_t               getPhysicalMdbAddr            (void);
uint8_t               getLogicalMdbAddrSem          (void);
scuRoMapRegister_st*  getRoMdbRegs                  (uint8_t addr);
scuRwMapRegister_st*  getRwMdbRegs                  (uint8_t addr);
appMapRwRegister_st*  getAppMdbRwRegs               (uint8_t addr);
osSemaphoreId         getScuUartInitSemaphoreHandle (void);
xQueueHandle          getScuSemQueueHandle          (void);
osSemaphoreId         getScuSinapsiTxUartSemaphoreHandle  (void);

void                  setModbusRotarySwitchCurr     (rotaryPos_e position);      
void                  setModbusMaxPowerResult       (uint32_t value);  
void                  setModbusMaxCurrentResult     (uint16_t value);
void                  setSessionId                  (unsigned int numSession); 
void                  setHwFlags                    (void); 
void                  setNumberOfLeds               (void);
uint16_t              getHwFlags                    (void); 
void                  setPowerOutage                (uint8_t power); 
uint16_t              getPowerOutage                (void);
void                  setEnergyMetersType           (void); 
void                  setStationOperationMode       (void);
uint32_t              getSessionId                  (void);
void                  setErrorModbus                (uint16_t error, uint8_t errorReg);
void                  setModbusBootEvent            (void); 
void                  setFwVersion                  (char* fwVersion);
void                  setMifareFwVersion            (char* MifarefwVersion);
uint16_t              getOperationMode              (void);
void                  setHwVersion                  (char* hwVersion);
void                  iniProductSerialNumber        (char* productSn, uint8_t length);
char*                 getProductSerialNumber        (void);
char*                 getProductCode                (void);
void                  setTecnProductCode            (char* fakeCode, uint8_t length);
char*                 getFakeProductCode            (void);
void                  setConnectorNumber            (uint8_t connPos, uint8_t connNumb); 
uint16_t              setMaxTypicalCurrent          (void);
void                  setMaxSimplifiedCurrent       (void);
void                  setUtcDateTimeRegister        (void); 
void                  setSchedulationInModbusTable  (sck_schedule_t *schedulations);
void                  setUpdateFirmwareByAppResult  (void); 
void                  setUidAuthorizationByApp      (char* uidApp);
void                  getUidAuthorizationByCard     (char* dest); 
void                  setUidAuthorizationByCard     (uint8_t* uidCard); 
void                  setSinapsiStatusForApp        (uint8_t state);
uint16_t              getPmFlags                    (void);
uint16_t              getPmPmax                     (void);
uint16_t              getPmImin                     (void);
uint16_t              getPmHpower                   (void);
uint16_t              getPmDset                     (void);
uint16_t              getPmDmax                     (void);
uint16_t              getPmEmex                     (void);
void                  setPmEmexInModbus             (uint8_t emexFlag);
uint16_t              getChargeByTime               (void);
void                  setChargeByTime               (uint16_t chargeTime); 
uint16_t              getDefaultLanguage            (void);
void                  setDefaultLanguage            (uint8_t lang);
uint32_t              getAvailableLanguages         (void);
void                  setAvailableLanguages         (uint32_t availLang);
void                  setPowerManagementRegisters   (void);
uint16_t              getPmMenuVisibility           (void);
void                  setPmMenuVisibility           (uint8_t visibility);
void                  setEvsePowerMode              (void); 
void                  setChargeTimeVisibility       (uint8_t visibility);
void                  setHwChecks                   (uint16_t checks1, uint16_t checks2);
uint16_t              getHwChecks1                  (void);
uint16_t              getHwChecks2                  (void);
uint16_t              getHwActuators                (void);
void                  setHwActuators                (uint8_t actEeprom);
void                  setActuatorsInEeprom          (uint16_t actModbus);
void                  setPmMode                     (uint8_t mode); 
void                  setTimeZone                   (uint8_t timeZone);
uint8_t               getPmMode                     (); 
void                  iniBoardSerialNumber          (char* boardSn, uint8_t length);
void                  setProductSerialNumber        (char* productSn, uint8_t length);
void                  setProductCodeString           (char* pProductCode, uint8_t length);
void                  iniProductCodeString          (char* productCode, uint8_t length);
void                  setBoardSnHwVerString         (char* pBoardStr, uint8_t length);
uint16_t              getRegisterFromModbusMap      (uint16_t addr); 
uint8_t               getRandomDelay                (void);
void                  setMallocTx485                (uint8_t* pBuff);
void                  UART_SCU_DMA_Tx               (uint8_t* pTxBuffer, uint16_t len); 
uint8_t               getCollaudoRunning            (void);
void                  setCollaudoRunning            (void);
uint8_t               getCollaudoParamWritten       (void);
uint8_t               isSemMode                     (void);
void                  setModbusVersion              (uint16_t  mdbVersion); 
void                  iniProductFakeString          (char* fakeCode, uint8_t length);
void                  setConnectorType              (void); 
void                  setChargeByEnergy             (uint16_t chargeEnrg);
uint16_t              getChargeByEnergy               (void);
void                  sendAnswToSem                 (mbError_e codeError, uint8_t ixScu, uint16_t rAddr, uint16_t len, scuEvents_e ev, uint8_t funct);
uint32_t              getMaxTempPowerAc             (void);
uint16_t              getRandomId16                 (void);
tmMapRegister_st*     getTmMdbRegs                  (uint8_t addr);
scuAddModeSktNum_e    getScuAddressTypeMode         (void);
uint8_t               setScuAddressTypeMode         (scuAddModeSktNum_e addrType);
uint8_t               setNominalPower               (uint16_t ITypical); 
uint8_t               getNumSktInProduct            (void);
void                  updateScuModbusAddrr          (void);
uint16_t              getConnectorId                (void);
void                  saveMaxTypicalCurrentEeprom   (uint8_t current);
void                  saveMaxSimplifiedCurrentEeprom  (uint8_t current);
void                  savePmModeEeprom              (uint8_t pmMode);
void                  savePmPmaxEeprom              (uint8_t* pMax);
void                  savePmIminEeprom              (uint8_t iMin); 
void                  savePmHpowerEeprom            (uint8_t hPower);
void                  savePmDsetEeprom              (uint8_t* dset);
void                  savePmDmaxEeprom              (uint8_t dMax); 
void                  saveDefaultDisplayLanguageEeprom (uint8_t lang);
void                  saveDisplayLanguagesEeprom    (uint8_t* langs);
void                  saveConnectorAliasEeprom      (uint8_t alias);
void                  saveConnectorTypeEeprom       (uint8_t conn);
uint8_t               modbusToHttpSocketConverter   (uint8_t conn);
void                  saveEnergyMetersTypeEeprom    (uint8_t* em);
uint8_t               modbusToHttpEnergyMeterConverter (uint8_t em); 
void                  saveVisibleFlagsEeprom        (uint8_t flags); 
void                  saveChargeTimeEeprom          (uint8_t timeEnum);
void                  savePowerManagementFlagsEeprom (uint8_t pmFlags);
void                  saveChargeEnergyEeprom        (uint8_t enrgEnum);
uint8_t               isSlaveWaitToBeOperative      (void); 

void                  uartReintialization           (void);
void                  UART_SCU_DMA_RX_IRQHandler    (void);
uint8_t               setPmRemoteSemFlag            (uint8_t writeImm);
uint8_t               ResetPmRemoteSemFlag          (uint8_t writeImm);
uint16_t              getMaxSimplifiedCurrent       (void);
uint16_t              getMaxTypicalCurrent          (void);
void                  setInChargeTime               (uint32_t timeCharge); 
void                  setScuTypeModeFromEeprom      (void);
void                  resetSbcGardTime              (void);
uint8_t               isSemMasterFz                 (void);

uint16_t              getScuModbusTableId           ( uint16_t idFromInterface );
void                  sendScuDataLinkMsg            (scuDlEvents_e scuDlEvents); 
void                  setEmFaultTrap                (void);

#ifdef MODBUS_TCP_EM_LOVATO
scuMapRegLovatoEmSim_st* getLovatoEthRegs           (void);
xQueueHandle          getEmLovatoQueueHandle        (void);

#endif

// --------------------------------------------------------------------------------------------------------------------------- //
#endif // _SCUMDB_H






/*************** END OF FILE ******************************************************************************************/



||||||| .r28
/**
* @file        scuMdb.h
*
* @brief       Uart for RS485 SCU mobus communication  - Definition -
*
* @author      Nick
*
* @riskClass   C
*
* @moduleID
*
* @vcsInfo
*     $Id: scuMdb.h 763 2025-06-05 15:05:27Z npiergi $
*
*     $Revision: 763 $
*
*     $Author: npiergi $
*
*     $Date: 2025-06-05 17:05:27 +0200 (gio, 05 giu 2025) $
*
*
* @copyright
*       Copyright (C) 2016 SCAME S.p.A. All rights reserved.
*       This file is copyrighted and the property of Aesys S.p.A.. It contains confidential and proprietary
*       information. Any copies of this file (in whole or in part) made by any method must also include a copy of this
*       legend.
*       Developed by:  SCAME S.p.A.
***********************************************************************************************************************/


#ifndef _SCUMDB_H
#define _SCUMDB_H
#include "wrapper.h"
#include "Em_Task.h"
#include "sbcGsy.h"


// -------------------------- global defines --------------------------------------------------------------------------------- //
#define   LAST_ITEM                         ((uint16_t)0xFFFF)

#define   CURR_MODBUS_VERSION               ((uint16_t)24)

/** nel caso di SCU slave SBC SEM può interrogare solo indirizzi 1 e 2  **/
#define   MAX_ID_FOR_SCU_S                  ((uint8_t)2)

#define   SCU_M_P_ADDR                       ((uint8_t)1)   /* SCU working as principal SCU connected to SBC master has fixed address at 1          */ 
#define   SCU_M_P_ADDR_LOG                   ((uint8_t)0)   /* SCU working as principal SCU connected to SBC master has fixed address logical at 0  */ 
#define   SCU_S_S_ADDR                       ((uint8_t)2)   /* SCU working as secondary SCU connected to SCU principal with address 2               */ 
#define   SCU_S_S_ADDR_LOG                   ((uint8_t)1)   /* SCU working as secondary SCU connected to SCU principal with address logical 1       */ 
#define   SCU_M_P_OFFSET_ADDR                ((uint8_t)100) /* for other SCU the principal SCU has address 100 + local address                      */ 
#define   MODBUS_BROADCAST_ADDR              ((uint8_t)0)   /* address for broadcast message over modbus RS485                                      */ 
#define   SCU_S_REPL_ADDR                    ((uint8_t)99)  /* in SEM enviroment a the address for replacement board                                */ 

#define   SCU_S_S_COLLAUDO_ADDR              ((uint8_t)11)  /* SCU working as secondary SCU (after factory testing procedure)                       */ 
#define   SCU_SLAVE_PRINCIPAL_ADDR           ((uint8_t)11)  /* SCU working as principal  slave in a pillar                                          */ 
#define   SCU_SLAVE_SECONDARY_MAX_ADDR       ((uint8_t)14)  /* SCU working as secondary has this max value  in a pillar                             */ 

#define   MODBUS_MAX_LEN                     ((uint8_t)250) /* max numeber of data bytes  over modbus RS485       0x7D = 125 * 2 = 250              */ 

#define   FILE_COMMAND_MASK                  ((uint16_t)0x000F)
#define   FILE_COMMAND_BROAD                 ((uint16_t)0x000F)

#define   TIMER_UART_WD                      pdMS_TO_TICKS((uint16_t)60000)
#define   TIMER_UART_GARD_TIME               pdMS_TO_TICKS((uint16_t)500)

#define   TIMER_MDB_UART_ID                  ((uint16_t)0)

/* 2 min gard time to be sure that SBC has been powered correctly */
#define   TIMER_SBC_GARD_ID                  ((uint16_t)0)
#define   TIMER_SBC_GARD_TIME                pdMS_TO_TICKS((uint32_t)120000) 
/* 1 min gard time to be sure that SLAVE has been powered correctly */
#define   TIMER_SLAVE_GARD_ID                ((uint16_t)1)
#define   TIMER_SLAVE_GARD_TIME              pdMS_TO_TICKS((uint32_t)130000) 
#define   TIMER_GARD_BLOCK_TIME              pdMS_TO_TICKS((uint32_t)(100))

/* ----------- numero buffer nella coda di ricezione  -------------*/
#define   NUM_BUFF_SCU_RX                   ((uint16_t)8)
#define   NUM_BUFF_SCU_RX_TIMEOUT           ((uint16_t)8)
     
#define   NUM_BUFF_SCU_MSG_DL_TX            ((uint16_t)16)      
#define   NUM_BUFF_SCU_MSG_DL_RX            ((uint16_t)16)      

/**** mask bit for modbus map register   ****/
/* BIT MASK for REG_ERR_0 */
#define   LID_MASK                          ((uint16_t)0x0002)
#define   RCBO_MASK                         ((uint16_t)0x0080)
#define   PEN_ERR_MASK                      ((uint16_t)0x0010)
#define   VAC230_ZC_MASK                    ((uint16_t)0x1000)
#define   MIRROR_SEM_MASK                   ((uint16_t)0x0040)
#define   RCDM_SEM_MASK                     ((uint16_t)0x0001)
#define   PULS_SEM_MASK                     ((uint16_t)0x8000)

#define   ALL_CONF_PARS_EXT_FLASH_ADDR      ((uint32_t)0x140000)

/**       ---------------------------  DATA LINK MANAGER ----------------------------- **/

/********* -----------  USART1 -- SCUs  -------- ***************************/
/* Definition for USART SCU  clock resources We use UART1 PA10=Rx,PA9=TX, and PA12=DE  */
#define UART_SCU                           USART1
#define UART_SCU_HANDLE                    huart1
#define UART_SCU_DEFAULT_BR                ((uint32_t)19200)
#define UART_SCU_SINAPSI_BR                ((uint32_t)115200)
#define UART_SCU_CLK_ENABLE()              __HAL_RCC_UART1_CLK_ENABLE() 
#define UART_SCU_RX_GPIO_CLK_ENABLE()      __GPIOA_CLK_ENABLE()
#define UART_SCU_TX_GPIO_CLK_ENABLE()      __GPIOA_CLK_ENABLE()
#define DMAx_SCU_CLK_ENABLE()              __DMA2_CLK_ENABLE()

/* Definition for USARTx Pins */
#define UART_SCU_TX_PIN                    GPIO_PIN_9
#define UART_SCU_TX_GPIO_PORT              GPIOA
#define UART_SCU_TX_AF                     GPIO_AF7_USART1
#define UART_SCU_RX_PIN                    GPIO_PIN_10
#define UART_SCU_RX_GPIO_PORT              GPIOA
#define UART_SCU_RX_AF                     GPIO_AF7_UART1
#define UART_SCU_DE_PIN                    GPIO_PIN_12
#define UART_SCU_DE_GPIO_PORT              GPIOA
#define UART_SCU_DE_AF                     GPIO_AF7_UART1

/* Definition for USARTx's DMA */
#ifndef GD32F4xx
#define UART_SCU_TX_DMA_STREAM              GPDMA1_Channel1
#define UART_SCU_RX_DMA_STREAM              GPDMA1_Channel0
#else
#define UART_SCU_TX_DMA_STREAM              DMA2_Stream7
#define UART_SCU_RX_DMA_STREAM              DMA2_Stream5
#endif

#define UART_SCU_TX_DMA_CHANNEL             DMA_CHANNEL_4
#define UART_SCU_RX_DMA_CHANNEL             DMA_CHANNEL_4

/* Definition for USARTx's NVIC */
#define UART_SCU_DMA                        DMA2
#define UART_SCU_DMA_STREAM                 DMA2_Stream5
#define UART_SCU_DMA_TX_IRQn                DMA2_Stream7_IRQn
#define UART_SCU_DMA_RX_IRQn                DMA2_Stream5_IRQn
#define UART_SCU_DMA_TX_IRQHandler          DMA2_Stream7_IRQHandler
#ifndef GD32F4xx
#define UART_SCU_DMA_RX_IRQHandler          DMA2_Stream5_IRQHandler
#endif

/* Definition for USARTx's NVIC */
#define UART_SCU_IRQn                       USART1_IRQn
#define UART_SCU_IRQHandler                 USART1_IRQHandler

/* Dimensione massimo campo dati del messaggio   */
#define SCU_DL_RX_PAYLOAD_MAX_LEN       ((uint16_t)64)
#define SCU_DL_RX_MSG_MAX_LEN           ((uint16_t)(SCU_DL_RX_PAYLOAD_MAX_LEN + (uint16_t)10))
#define SCU_DMA_RX_BUFFER_SIZE          SCU_DL_RX_MSG_MAX_LEN
#define SCU_DL_TX_MSG_MAX_LEN           SCU_DL_RX_MSG_MAX_LEN

/* ----------- numero buffer nella coda di ricezione  -------------*/
#define   NUM_BUFF_SCU_DL_RX                ((uint16_t)2) 
     
#define   NUM_BUFF_SCU_MSG_DL_TX            ((uint16_t)16)      
#define   NUM_BUFF_SCU_MSG_DL_RX            ((uint16_t)16)      

/* ----------- Indici campi modbus RTU   -------------*/
//#define   IDX_ID_SCU                    ((uint8_t) 0)                           /* Indice numero SCU nel comando Modbus                                                         */
//#define   IDX_FUNCTION                  ((uint8_t) 1)                           /* Indice Function nel comando Modbus                                                           */
//#define   IDX_REG_ADDR_H                ((uint8_t) 2)                           /* Indice Indirizzo registro byte high nel comando Modbus                                       */
//#define   IDX_REG_ADDR_L                ((uint8_t) 3)                           /* Indice Indirizzo registro byte low nel comando Modbus                                        */
//#define   IDX_N_WORD_H                  ((uint8_t) 4)                           /* Indice Numero word byte high nel comando Modbus                                              */
//#define   IDX_N_WORD_L                  ((uint8_t) 5)                           /* Indice Numero word byte low nel comando Modbus                                               */
//#define   IDX_N_BYTE                    ((uint8_t) 6)                           /* Indice Numero di byte nel comando Modbus (solo scrittura)                                    */
//#define   IDX_FIRST_DATA_BYTE           ((uint8_t) 7)                           /* Indice Primo byte di data nei comandi di scrittura                                           */        

/* ----------- Indici campi modbus TCP (richiesto per app ios)  -------------*/
#define   IDX_COUNTER_H                 ((uint8_t) 0)                            /* Indice contatore progressivo inizio pacchetto Modbus TCP                                      */
#define   IDX_COUNTER_L                 ((uint8_t) 1)                            /* Indice contatore progressivo inizio pacchetto Modbus TCP                                      */
#define   IDX_LEN_PAYL_H                ((uint8_t) 4)                            /* Indice Lunghezza payload nel protocollo MODBUS TCP byte high                                  */
#define   IDX_LEN_PAYL_L                ((uint8_t) 5)                            /* Indice Indirizzo registro byte low nel comando Modbus                                         */
#define   IDX_ID_SCU                    ((uint8_t) 6)                            /* Indice numero SCU nel comando Modbus                                                          */
#define   IDX_FUNCTION                  ((uint8_t) 7)                            /* Indice Function nel comando Modbus                                                            */
#define   IDX_REG_ADDR_H                ((uint8_t) 8)                            /* Indice Indirizzo registro byte high nel comando Modbus                                        */
#define   IDX_REG_ADDR_L                ((uint8_t) 9)                            /* Indice Indirizzo registro byte low nel comando Modbus                                         */
#define   IDX_N_WORD_H                  ((uint8_t) 10)                           /* Indice Numero word byte high nel comando Modbus                                               */
#define   IDX_N_WORD_L                  ((uint8_t) 11)                           /* Indice Numero word byte low nel comando Modbus                                                */
#define   IDX_N_BYTE                    ((uint8_t) 12)                           /* Indice Numero di byte nel comando Modbus (solo scrittura)                                     */
#define   IDX_FIRST_DATA_BYTE           ((uint8_t) 13)                           /* Indice Primo byte di data nei comandi di scrittura                                            */        


#define   IDX_CHNL_NUMB_CIPSEND         ((uint8_t) 11)                           /* Indice al byte del comando AT+CIPSEND dove scrivere il numero del canale su cui comunicare    */

/* ----------- Indici registro PROCEDURE_RESPONSE_RO  -------------*/
#define   IDX_RESP_REQ_BYTE             ((uint8_t) 0)                            /* Indice byte 0 PROCEDURE_RESPONSE_RO contenente la richiesta fatta                             */                
#define   IDX_RESP_STATUS_BYTE          ((uint8_t) 1)                            /* Indice byte 1 PROCEDURE_RESPONSE_RO contenente lo stato di elaborazione della procedura       */
#define   IDX_RESP_RESULT_BYTE          ((uint8_t) 2)                            /* Indice byte 2 PROCEDURE_RESPONSE_RO contenente l'esito della procedura                        */
#define   IDX_RESP_DETAIL_BYTE          ((uint8_t) 3)                            /* Indice byte 3 PROCEDURE_RESPONSE_RO contenente il dettaglio dell'esito della procedura        */

/* ----------- Flag per risposte errori comandi modbus  -----------*/
#define   REC_ILLEGAL_ADDRESS           ((uint8_t) 1)                            /* Received modbus command with illegale address                                                 */
#define   REC_ILLEGAL_ADDRESS_RST       ((uint8_t) 0)                            /* Reset flag illegal address command modbus received                                            */ 

/* MAPPA COMANDI MACCHINA DI COLLAUDO */
#define   TM_CONTATTORE_MASK            ((uint16_t)0x0001)                        /* Flag Mask for contactor command                                    */ 
#define   TM_CONTATTORE_ON              ((uint16_t)0x0001)                        /* Flag status ON for contactor                                       */ 
#define   TM_MODO_FREE_MASK             ((uint16_t)0x0004)                        /* Flag Mask for modo free command                                    */ 
#define   TM_MODE_FREE_ON               ((uint16_t)0x0004)                        /* Flag status ON for modo free                                       */ 


typedef enum
{
  SCU_NO_REQ_ANSWER = 0x0000,       /* Message right, answer not necessary   */ 
  SCU_SEND_ANSWER   = 0x0001,       /* Message right, answer  necessary    */ 
  SCU_ADDRESS_ERROR = 0x0002,       /* Message with address wrong  */ 
  SCU_MSG_ERROR     = 0x0003,       /* Message wrong  */ 
  SCU_DEFAULT_ANSW  = 0xFFFF
} scuMsgResult_e;


/**       ---------------------------  SCU OPERATIVE MODES  -------------------------------- **/
typedef enum
{
  SCU_EMUMAX0_S     = 0x0000,       /* SCU is working as MAX0 in slave position on RS485 bus                    */ 
  SCU_EMUMAX0_M     = 0x0001,       /* SCU is working as MAX0 in master position on RS485 bus                   */ 
  SCU_M_P           = 0x0002,       /* SCU is working as principal SCU connected to SBC master                  */ 
  SCU_S_P           = 0x0003,       /* SCU is working as principal SCU connected to SBC (TFT) slave             */ 
  SCU_S_S           = 0x0004,       /* SCU is working as secondary SCU connected to SCU principal on RS485 bus --> PUT @VALUE 6 TO AVOID WARNINGS IN COMPILE TIME */ 
  SCU_M_STAND_ALONE = 0x0005,       /* SCU is working as a master in stand alone mode */
  SCU_NUM_MODES     = 0x0006,
  SCU_MODE_UNDEF    = 0xFFFF
} scuOpModes_e;

typedef enum
{
  SCU_SEM_M           = 0x0000,       /* SCU is working with SEM as master           */ 
  SCU_GSY             = 0x0001,       /* SCU is working with GSY                     */ 
  SCU_SEM_S           = 0x0002,       /* SCU is working with SEM as slave            */ 
  SCU_SEM_MS          = 0x0003,       /* SCU is working with SEM as secondary master */ 
  SCU_SEM_STAND_ALONE = 0x0004,       /* SCU is working with SEM out of the WB or Pillar */ 
  SCU_NUM_TYPE        = 0x0005,
  SCU_MASK_TYPE       = 0x0007,
  SCU_TYPE_UNDEF      = 0x00FF
}scuTypeModes_e;

typedef enum
{
  SCU_S_PS_STARTUP        = 0x0004,       /* code to search SCU  working as secondary SCU  on RS485 bus  at startup   */ 
  SCU_S_PS_LIVE           = 0x0005,       /* code to search SCU  working as secondary SCU  on RS485 bus  at live      */ 
  SCU_S_PS_NEW            = 0x0006,       /* code to search new SCU  working as secondary SCU  on RS485 bus  at live  */ 
  SCU_ALL_FACTORY_PARAM   = 0xFFEC,       /* code to restore on all SCU the factory parameters                        */ 
  SCU_SEARCH_UNDEF        = 0xFFFF
} scuSearchCode_e;


/**       ---------------------------  SCU SEM CONTROL BITS FLAGS   -------------------------------- **/
typedef enum
{
  SCU_TEMPORARY_ADDR  = 0x0000,       /* SCU address is temporary and could be changed in discovery phase */ 
  SCU_FIXED_ADDR      = 0x0001,       /* SCU address is fixed and couldn't be changed in discovery phase */ 
  SCU_ADDR_MODE_MASK  = 0x0001,

  SCU_SKT_NUM_MASK    = 0x000E        /* socket number inside the product 1..4                            */
}scuAddModeSktNum_e;

/**       ---------------------------  SCU SPERIMENTAL MODES  -------------------------------- **/

typedef enum
{
  SCU_SINAPSI_NOT_PRESENT   = 0x00,    /* SINAPSI board not present                             */ 
  SCU_SINAPSI_PRESENT       = 0x01,    /* SINAPSI board present but with bluetooth OFF          */
  SCU_SINAPSI_BT_ON         = 0x02     /* SINAPSI board present and bluetooth ON                */
} sinapsiStateApp_e;


/**       ---------------------------  SCU RS485 L3  MANAGER ----------------------------- **/
/* define for task request */

typedef enum
{
  TX_TO_SCU           = 0x00,      /* Request to send a msg to SCU     */ 
  TX_TO_SCU_TIMEOUT   = 0x01,      /* polling request                  */ 
  RX_FROM_SCU         = 0x02,      /* Request to take a msg from SCU   */
  TX_TO_WIFI          = 0x03,      /* Request to send a msg to Wi-Fi   */
  RX_FROM_WIFI        = 0x04,      /* Request to take a msg from Wi-Fi */     
  SCU_ERROR           = 0xFFFF     /* Error on uart   */ 
} scuMsgDir_e;

typedef enum
{
  SCU_IDLE            = 0x0000,       /* initial state                    */ 
  SCU_OPERATIVE       = 0x0001,       /* normal condition                 */ 
  SCU_REQ_INT_RD_WR   = 0x0002,       /* internal read or write request   */ 
  SCU_DUMMY           = 0xFFFF
} scuStates_e;

typedef enum
{
  SCU_DL_IDLE     = 0x0000,       /* initial state   */ 
  SCU_DL_READY    = 0x0001,       /* ready state     */ 
  SCU_DL_READING  = 0x0002,       /* reading phase    */ 
  SCU_DL_WRITING  = 0x0003,       /* writing phase    */ 
  SCU_DL_PH_DUMMY = 0xFFFF
} scuDlStates_e;

typedef enum
{
  SCU_EVENT_START             = 0x00,      /* timeout evet                                                                    */ 
  SCU_EVENT_RD_ANSW_WR_REQ,                /* incoming RD answer or WR request message SCU side                               */ 
  SCU_EVENT_RD_REQ_WR_ACK,                 /* incoming RD request or WR ack answer message SCU side                           */ 
  SCU_EVENT_MSG_FROM_SBC,                  /* incoming message SBC side                                                       */ 
  SCU_EVENT_MSG_INTERNAL_WR,               /* an internal task ask to send a message to write a reg: an example is for debug  */ 
  SCU_EVENT_MSG_INTERNAL_RD,               /* an internal task ask to send a message to read a reg: an example is for debug   */ 
  SCU_EVENT_MSG_NO_ANSWER,                 /* no answer at the previous request                                               */
  SCU_EVENT_MSG_FROM_WIFI,                 /* incoming message from Wi-Fi module                                              */       
  SCU_EVENT_DUMMY = 0xFFFF
} scuEvents_e;

typedef enum
{
  SCU_DL_START                = 0x00,       /* start data link                                                                 */ 
  SCU_DL_SEND,                              /* send a frame                                                                    */ 
  SCU_DL_RX_IDLE,                           /* IDLE detected                                                                   */
  SCU_DL_RECEIVE_FROM_RS485,                /* received frame                                                                  */ 
  SCU_DL_TIMEOUT,                           /* elapsed timerout                                                                */ 
  SCU_DL_ERR_UART,                          /* error on uart                                                                   */
  SCU_DL_RX_COLLAUDO,                       /* ricezione messaggio dalla macchina di collaudo                                  */
  SCU_DL_CHANGE_TO_SEM,                     /* error on uart due to wrong enviroment we are in SEM but set in EMUMAX           */
  SCU_DL_CHANGE_TO_SEM_FROM_TEST,           /* vhange from SEM to EMUMAX0 at the end of all automatic test                     */
  SCU_DL_DUMMY = 0xFFFF
} scuDlEvents_e;

typedef enum
{
  SCU_DL_OP_RD                = 0x00,       /* read operation                                                                  */ 
  SCU_DL_OP_WR,                             /* write operation                                                                 */ 
  SCU_DL_OP_DUMMY = 0xFFFF
} scuDlOp_e;

typedef __packed struct
{
  uint32_t    microId1;
  uint32_t    microId2;
  uint32_t    microId3;
} microId_t;

/* define error code for SCU */
typedef enum
{
  SCU_NO_ERROR     = 0,            /* no error                          */ 
  SCU_REG_UNDEF,                   /* Register undefined                */ 
  SCU_NO_ANSWER                    /* SCU not answering                  */ 
} scuError_e;

/* define for register type  */
typedef enum
{
  BIG_ENDIANESS = 0,
  LITTLE_ENDIANESS
} endianessType_e;

/* define for register type  */
typedef enum
{
  RO     = 0,                      /* read only register                */ 
  RW,                              /* read/write register               */ 
  WO
} regType_e;

/* define error code for modbus */
typedef enum
{
  NO_ERROR     = 0,           /* no error                      */ 
  MB_ILLEGAL_FUNC = 1,        /* Register undefined            */ 
  MB_ILLEGAL_ADDR,            /* Illegal address               */ 
  MB_ILLEGAL_DATA,            /* Illegal dats                  */ 
  MB_NAK = 0x07               /* negative ACK                  */ 
} mbError_e;

/* define SCU index registers linked strictly to const scuRegInfo_st   scuRegister[SCU_LAST_REG_IDX] */
typedef enum
{
  BOARD_FW_VERSION_RO      = 0,         /* Campo ASCII contenente la versione del main firmware                                      0 */ 
  MIFARE_FW_VERSION_RO     = 1,         /* Versione FW del lettore RFID                                                                */ 
  BOARD_SN_RO,                          /* Numero di serie della scheda                                                                */ 
  PLC_FW_VERSION_RO,                    /* Campo ASCII versione FW del modulo PLC (solo stazione DC)                                   */ 
  PLC_MAC_ADDRESS_RO,                   /* MAC address del modulo PLC (solo stazione DC)                                               */
  HW_REVISION_RO,                       /* Revisione hardware della SCU                                                                */
  WIFI_MAC_ADDRESS_RO,                  /* MAC address del modulo Wi-Fi Espressif                                                      */
  POWER_MODULE_SN_RO,                   /* Numero di serie del modulo di potenza inserito nella EVSE                                   */
  BLE_MAC_ADDRESS_RO,                   /* MAC address del modulo Bluetooth                                                            */
  PRODUCT_SN_RO,                        /* Numero di serie del prodotto Scame                                                          */
  PRODUCT_CODE_RO,                      /* Codice prodotto di Scame                                                                 10 */ 
  BOOT_FW_VERSION_RO,                   /* Campo ASCII contenente la versione del boot firmware                                        */ 
  MODBUS_FW_VERSION_RO,                 /* Campo binario contenente la versione del modbus                                             */ 
  SCU_RESERVED1,                        /* Reserved for future use                                                                     */ 
  NOTIFY_EVSE_PRESENCE_RO,              /* Indica quanti e quali indirizzi sono presenti nel sistema                                   */ 
  NOTIFY_EVSE_CHANGE_RO,                /* Registro per segnalare un cambiamento di stato (prevedere autocleaning)                     */ 
  EVSE_ERROR1_RO,                       /* Registro 1 per segnalare allarmi e/o errori                                                 */ 
  EVSE_ERROR2_RO,                       /* Registro 2 per segnalare allarmi e/o errori                                                 */ 
  EVSE_CHANGE_REGISTERS_RO,             /* registro che notifica lo stato della stazione                                               */ 
  SCU_RESERVED2,                        /* Reserved for future use                                                                     */ 
  APP_EXCHANGE_AREA_RO,                 /* Area used by app to exchange data with SCU                                                  */   
  /* -------------- Inizio dei parametri Read-Only eventi --> 0x600                                         --------------             */                         
  EVSE_EVENT_FLAGS_RO,                  /* contiene lo stato del connettore tethered                                                21 */ 
  EVSE_CHARGE_STATUS_RO,                /* registro che notifica lo stato della stazione                                               */ 
  TEMPERATURE_SYSTEM_RO,                /* temperatura del sistema (quella rilevata dal uP nel caso AC)                                */ 
  SCU_RESERVED3,                        /* Reserved for duture use                                                                     */ 
  VOLTAGE_AC_RO,                        /* Tensione di alimentazione del sistema (parametro OCCP)                                      */ 
  CURRENT_AC_L1_RO,                     /* Corrente fase 1 (parametro OCCP)                                                            */ 
  CURRENT_AC_L2_RO,                     /* Corrente fase 2 (parametro OCCP)                                                            */ 
  CURRENT_AC_L3_RO,                     /* Corrente fase 3 (parametro OCCP)                                                            */ 
  ACTIVE_POWER_DC_RO,                   /* Potenza attiva del sistema DC  (parametro OCPP)                                             */ 
  ACTIVE_POWER_AC_RO,                   /* Potenza attiva del sistema     (parametro OCCP)                                             */ 
  CURRENT_AC_SYS_RO,                    /* Corrent di sistema (mono / trifase) (parametro OCCP)                                     31 */ 
  REACTIVE_POWER_AC_RO,                 /* Potenza reattiva del sistema   (parametro OCCP)                                             */ 
  TOTAL_ACTIVE_ENERGY_AC_EV_RO,         /* Energia attiva del sistema     (parametro OCCP)                                             */ 
  TOTAL_ACTIVE_ENERGY_DC_EV_RO,         /* Energia attiva del sistema DC  (parametro OCCP)                                             */ 
  TOTAL_REACTIVE_ENERGY_AC_EV_RO,       /* Energia reattiva del sistema   (parametro OCCP)                                             */
  TRANSACTION_ACTIVE_ENERGY_AC_EV_RO,   /* Energia attiva parziale relativa alla sessione corrente    (parametro OCCP)                 */ 
  ACTIVE_POWER_AC_L2_RO,                /* Potenza attiva fase L2                                                                      */ 
  TRANSACTION_REACTIVE_ENERGY_AC_EV_RO, /* Energia reattiva parziale relativa alla sessione corrente  (parametro OCCP)                 */
  FREQUENCY_SUPPLY_RO,                  /* Frequenza di rete     (parametro OCCP)                                                      */ 
  SCU_RESERVED4,                        /* Reserved (usati per stazione DC)                                                            */ 
  MAX_CURRENT_ROTATORY_SWITCH_RO,       /* Corrente impostata nel selettore rotativo                                                41 */ 
  UNDEFINED_EX_RSC_CURR_RDD,            /* Corrente massima di sistema                                                                 */ 
  ACTIVE_POWER_AC_L3_RO,                /* Potenza attiva fase L2                                                                      */ 
  EMPTY_063A,
  MAX_CURRENT_RESULT_RO,                /* Corrente massima di carica risultante dai vari calcoli e confronti                          */ 
  TRANSACTION_TIME_RO,                  /* Tempo in secondi, trascorsi dall'inizio della carica                                        */ 
  TRANSACTION_COUNTDOWN_RO,             /* Tempo, in secondi, rimanenti al completamento della carica                                  */ 
  EV_BATTERY_RO,                        /* percentuale della carica della batteria  (parametro OCCP)                                   */ 
  SESSION_ID_RO,                        /* identificatore univoco della sessione di carica                                          48 */ 
  EVSE_BOOT_EVENT_RO,                   /* flag di notifica reset di sistema                                                           */ 
  TOTAL_ACTIVE_ENERGY_AC_GRID_RO,       /* Energia attiva totale con funzionalità GRID V2G                                          50 */
  TOTAL_REACTIVE_ENERGY_AC_GRID_RO,     /* Energia reattiva totale con funzionalità GRID V2G                                           */
  TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO, /* Energia attiva erogata durante una transazione, funzionalità GRID V2G                       */
  TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO,  /* Energia reattiva erogata durante una transazione, funcionalità GRID V2G                  */ 
  SCU_RESERVED6,                        /*                                                                                             */
  UID_AUTHORIZATION_RO,                 /* valore UID della card letta                                                                 */ 
  TIME_CHARGE_RO,                       /* tempo ricarica effettivo                                                                    */ 
  SCU_RESERVED6B,                       /* -------------- Fine dei parametri Read-Only si passa a quelli RW --------------             */

  CONNECTOR_TYPE_RW,                    /* Registro per modificare configurazione Hardware                                          58 */ 
  HWC_FLAGS_RW,                         /* Flag componenti hardware aggiuntivi                                                         */                          
  ENERGY_METERS_RW,                     /* tipo di energy meter                                                                     60 */ 
  POWER_OUTAGE_TYPE_RW,                 /* Hardware impiegato per l'assenza di tensione                                                */
  CONNECTOR_IDS_RW,                     /* Modifica indirizzo modbus usato come alias della scheda                                     */ 
  BOARD_SN_RW,                          /* Numero di serie della stazione                                                              */ 
  PRODUCT_SN_RW,                        /* Numero di serie del prodotto                                                                */ 
  MASTER_HW_TYPE_RW,                    /* Configurazione master / slave                                                               */ 
  UTC_DATE_TIME_RW,                     /* data e ora correnti letti da RTC                                                            */ 
  POWER_MODULE_BRAND_RW,                /* Indica la marca del produttore del caricabatteria (solo DC)                                 */ 
  POWER_MODULE_MODEL_RW,                /* Indica la marca del modello del caricabatteria (solo DC)                                 68 */ 
  POWER_MODULE_N_RW,                    /* Indica il numero di moduli installati al sistema  (solo DC)                              69 */ 
  EVSE_TM_MODE_RW,                      /* Abilitazione macchina di collaudo         a                                              70 */ 
  EVSE_OPERATION_MODE_RW,               /* In dica la modalità di funzionamento del sistema di ricarica                                */ 
  CHARGE_PROTOCOL_SELECTED_RW,          /* Indica con quale connettore effettuare la ricarica (solo DC)                                */ 
  DISPLAY_DEFAULT_LANGUAGE_RW,          /* Indica la lingua utilizzata dal sistema                                                     */ 
  HW_CHECKS1_RW,                        /* Registro per abilitazione errori e configurazioni HW                                        */ 
  HW_CHECKS2_RW,                        /* Registro per abilitazione errori e configurazioni HW                                        */ 
  HW_ACTUATORS_RW,                      /* Registro per la configurazione degli attuatori del sistema                                  */ 
  SCU_RESERVED7,                        /* Registri riservati per stazione DC                                                          */         
  MAX_TEMPORARY_CURRENT_RW,             /* Parametro PID per sistema AC                                                             78 */ 
  UNDEFINED_EX_LIM_LOW_CURR_RWD,        /* Imposta la corrente minima di ricarica                                                   79 */ 
  LED_STRIP_RWD,                        /* Registro utilizzato per impostare numero led nella strip                                 80 */ 
  REMOTE_COMMANDS_RW,                   /* Emulazione stato pressione del pulsante remoto                                              */ 
  ENVIRONMENT_BRIGHTNESS_RW,            /* Valore di luminosità letto dal sensore                                                      */ 
  UNDEFINED_EX_PRX_DIST_RWD,            /* Indica la distanza rilevata dal sensore                                                     */ 
  UNDEFINED_EX_PRX_MOTION_RWD,          /* Registro flag che indica presenza di movimento rilevata                                     */ 
  MAX_TEMPORARY_POWER_AC_RW,            /* Parametro per impostare potenza massima temporanea AC disponibile                        85 */ 
  PM_MODE_RW,                           /* registro utilizzato per la modalità di funzionamento del Power Management                   */ 
  ENABLE_LOG_RW,                        /* abilitazione log su SD (solo DC)                                                            */ 
  AUTHORIZATION_FEEDBACK_RW,            /* in modalità NET autorizza e controlla la carica                                          88 */ 
  TIMEZONE_RW,                          /* registro per gestire il time zone rispetto a UTC                                         89 */ 
  MENU_VISIBILITY_RW,                   /* registro per impostare la visibilità di alcuni menù della stazione AC                    90 */ 
  TIMEOUT_RANGE1_RW,                    /* registro per impostare il valore di partenza del counter 1                                  */ 
  TIMEOUT_RANGE2_RW,                    /* registro per impostare il valore di partenza del counter 2                                  */
  PRODUCT_CODE_RW,                      /* Codice prodotto SCAME                                                                       */
  TECN_PRODUCT_CODE_RW,                 /* Codice prodotto fake SCAME                                                                  */
  CONNECTOR_N_RW,                       /* Numero della presa all'interno della EVSE                                                   */
  DISPLAY_LANGUAGES_ENABLED_RW,         /* Lingua impostata e di default della EVSE                                                    */
  MAX_TYPICAL_CURRENT_RW,               /* Massima corrente in modalità tipica                                                         */
  MAX_SIMPLIFIED_CURRENT_RW,            /* Massima corrente in modalità semplificata                                                98  */
  CHARGE_TIME_RW,                       /* Tempo di carica massimo per Power Management                                             99 */
  CHARGE_MAX_ENERGY_RW,                 /* Massima potenza totale utilizzabile in una carica                                       100 */                          
  PM_IMIN_RW,                           /* Corrente minima con funzione Power Management                                               */
  PM_PMAX_RW,                           /* Potenza massima con funzione Power Management                                               */
  PM_FLAGS_RW,                          /* Flag di abilitazione funzione Power Management                                              */
  PM_HPOWER_RW,                         /* Isteresi soglia di potenza con funzione Power Management                                    */
  PM_DSET_RW,                           /* Valore di variazione della potenza erogata, funzione Power Management                       */
  PM_DMAX_RW,                           /* Valore di isteresi della potenza in eccesso, funzione Power Management                      */ 
  PIN_EXTERNAL_ENERGY_METER_RW,         /* Pin di energy meter esterno                                                                 */         
  LIM_MAX_POWER_AC_RW,                  /* massima potenza AC                                                                      108 */ 
  RESERVED_A,                           /* reserved for future use                                                                     */ 
  FILE_COMMAND_RW,                      /* Comando per avviare l'aggiornamento SW                                                  110 */ 
  FILE_SIZE_RW,                         /* Registro con indicazione del size del file da caricare                                      */ 
  FILE_PACKET_RW,                       /* Registro con indicazione del numero pacchetti del file da caricare                          */ 
  
  /****          definizioni identificatori  per l'ambiente SINAPSI - RSE ************************************************************ */
  IOM_CTRL,                             /*                                                                                             */
  M2_PAII_TS,                           /*                                                                                             */
  M2_PAII,
  M2_PC_TS,                             /*                                                                                             */     
  M2_PC,
  M1_PC_TS,
  M1_PC,                                                                                                                           
  M1_PD_TS,
  M1_PD,                                /*                                                                                         122 */
  M1_PAPI_TS,                           /*                                                                                             */        
  M1_PAPI,                              
  M1_PAII_TS,                           
  M1_PAII,
  M1_RES_DIST_TS,                       /*                                                                                             */      
  M1_TIME_RES_DIST,                      
  M1_PFO_TS,
  M1_PFO,                                
  M1_PMRTLIM,
  M1_PMRTLIM_TS,                        /*                                                                                         132 */
  M1_SOSP_RIC_TLIM,                     /*                                                                                             */     
  M1_UT_SYNC,                                  
  SET_CONFIG_MODE,                                      
  
  /****          definizioni identificatori  per l'ambiente test PEN **************************************************************    */
  PEN_RELE,                             /*                                                                                             */ 
  
  /****          definizioni identificatori  per l'ambiente MACCHINA DI COLLAUDO  *************************************************    */
  TM_MEASURED_CURRENT_RW,               /* Corrente misurata dall'EM interno alla macchina di collaudo                             137 */
  TM_MEASURED_VOLTAGE_RW,               /* Tensione misurata dall'EM interno alla macchina di collaudo                                 */
  TM_COMMAND_RW,                        /* Registro per comandi da eseguire durante il collaudo                                        */
  TM_ADDR_S_CONN_RW,                    /* Registro notifica scheda collegata tramite ponticello J1-J2                                 */
  TM_ADDR_REQ_RW,                       /* Registro per comandi fase di richiesta indirizzamento automatico                            */
  TM_ADDR_ASS_RW,                       /* Registro per comandi fase di assegnazione indirizzamento automatico                         */
  TM_ERROR1_IN_TEST_RO,                 /* registro errori durante la fase di collaudo                                                 */
  TM_UID_MASTER_RW,                     /* Registro per scrittura UID carta Master                                                     */
  TM_UID_USER_RW,                       /* Registro per scrittura UID carta Master                                                     */
  TM_MEASURED_CURRENT_L2_RW,            /* Corrente misurata dall'EM interno alla macchina di collaudo  L2 (solo trifase)          146 */
  TM_MEASURED_VOLTAGE_L2_RW,            /* Tensione misurata dall'EM interno alla macchina di collaudo  L2 (solo trifase)              */
  TM_MEASURED_CURRENT_L3_RW,            /* Corrente misurata dall'EM interno alla macchina di collaudo  L3 (solo trifase)          148 */
  TM_MEASURED_VOLTAGE_L3_RW,            /* Tensione misurata dall'EM interno alla macchina di collaudo  L3 (solo trifase)              */
  TM_GET_EEPROM_INFO,                   /* Richiesta lettura parametri in EEPROM                                                       */
  
  /****          definizioni identificatori  per l'ambiente APP WIFI  *************************************************************    */
  CONNECTOR_INIT_STATUS_RO,             /* Stato di attivazione della presa                                                            */
  CONNECTOR_OPERATION_STATUS_RO,        /* Stato IDLE o meno della presa (c'è attiva o meno una procedura?? Richiesto da Enrico    152 */ 
  PROCEDURE_RESPONSE_RO,                /* Esito procedura SCU richiesta dalla App                                                     */
  PM_TOTAL_POWER_RO,                    /* Potenza totale esterna                                                                      */
  PM_L1_POWER_RO,                       /* Potenza esterna fase 1                                                                      */
  PM_L2_POWER_RO,                       /* Potenza esterna fase 2                                                                      */
  PM_L3_POWER_RO,                       /* Potenza esterna fase 3                                                                      */
  USER_LOGIN_RO,                        /* Tipologia di utente che ha fatto il login                                                   */
  CONNECTOR_CHECK_ACTIV_KEY_RW,         /* Controllo pin di attivazione presa con quello riportato nel manuale                         */
  CONNECTOR_NAME_RW,                    /* Nome presa scelto dall'utente                                                               */
  CONNECTOR_PIN_RW,                     /* Pin presa scelto dall'utente in fase di Init                                                */
  ROUTER_NET_SSID_RW,                   /* SSID della rete del router domestico                                                    162 */
  ROUTER_NET_PASSWORD_RW,               /* Password della rete del router domestico                                                    */
  CONNECTOR_ROUTER_IP_RW,               /* Indirizzo IP assegnato dal router al modulo Espressif                                       */
  PROCEDURE_REQUEST_RW,                 /* Richiesta di una procedura da parte della App                                               */
  SCHEDULE_FLAG1_RW,                    /* Flag di attivazione schedulazione 1                                                         */
  SCHEDULE_START1_RW,                   /* Orario di start della carica schedulata 1                                                   */
  SCHEDULE_STOP1_RW,                    /* Orario di stop della carica schedulata 1                                                    */
  SCHEDULE_POWER1_RW,                   /* Massima potenza impostabile per la schudulazione 1                                          */
  SCHEDULE_FLAG2_RW,                    /* Flag di attivazione schedulazione 2                                                         */
  SCHEDULE_START2_RW,                   /* Orario di start della carica schedulata 2                                                   */
  SCHEDULE_STOP2_RW,                    /* Orario di stop della carica schedulata 2                                                172 */
  SCHEDULE_POWER2_RW,                   /* Massima potenza impostabile per la schudulazione 2                                          */
  SCHEDULE_FLAG3_RW,                    /* Flag di attivazione schedulazione 3                                                         */
  SCHEDULE_START3_RW,                   /* Orario di start della carica schedulata 3                                                   */
  SCHEDULE_STOP3_RW,                    /* Orario di stop della carica schedulata 3                                                    */
  SCHEDULE_POWER3_RW,                   /* Massima potenza impostabile per la schudulazione 3                                          */
  SCHEDULE_FLAG4_RW,                    /* Flag di attivazione schedulazione 4                                                         */
  SCHEDULE_START4_RW,                   /* Orario di start della carica schedulata 4                                                   */
  SCHEDULE_STOP4_RW,                    /* Orario di stop della carica schedulata 4                                                    */
  SCHEDULE_POWER4_RW,                   /* Massima potenza impostabile per la schudulazione 4                                          */
  CONNECTOR_CONNECTION_STATUS_RO,       /* Stato di connessione ad una rete domestica                                              182 */
  MAX_POWER_RO,                         /* Massima potenza stazione per settaggio tachimetro su APP                                    */        
  RANDOM_DELAY_FLAG_RW,                 /* Registro per abilitare/disabilitare il ritardo randomico sulle schedulazioni                */        
  UID_AUTHORIZATION_APP_RW,             /* Registro per modalità PERSONAL BY APP richiesta dal marketing. UID app                      */ 
  BT_SINAPSI_STATUS_RW,                 /* Registro per lo stato del bluetooth della scheda Sinapsi                                    */
  FW_UPDATE_NAME_RW,                    /* Registro per settare il nome del file del nuovo fw che si vuole installare                  */
  FW_UPDATE_LEN_RW,                     /* Registro per settare la lunghezza dei byte del nuovo fw che si vuole installare             */
  FW_UPDATE_STATUS_RO,                  /* Registro per segnalare l'esito di un'aggiornamento firmware da app                          */ 
  EVSE_POWER_MODE_RO,                   /* Registro per mostrare se è trifase o monofase l'alimentazione                               */ 
  
  /****          definizioni identificatori  per SIMULATORE EM LOVATO Ethernet    *************************************************    */
  EM_LOVATO_SIM_V_SYS,                  /* tensione di fase                                                                       191  */
  EM_LOVATO_SIM_P_AREA,                 /* elenco delle potenze delle varie stazioni                                                   */
    
  /****          end definitions  ************************************************************** */
  SCU_LAST_REG_IDX,                     /* last index                                                                             193  */ 
  SCU_SBC_DUMMY                         /* index register not used                                                                     */ 
} scuAllRegIdx_e;


/* ----------- Transmission definition to SCU   -------------*/
typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint8_t     payload[SCU_DL_TX_MSG_MAX_LEN];
} headerSCU_t;


typedef __packed union
{
  headerSCU_t           nodeReadInputReg;
} messageScuTx_u;


typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint16_t    regAdd;
  uint16_t    numWords;
  uint8_t     numBytes;
  uint16_t    data[SCU_DL_RX_PAYLOAD_MAX_LEN];
} scuRWmultipleReg_st;

typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint8_t     numBytes;
  uint8_t     data[MODBUS_MAX_LEN];
} headerAnwsRIR_t;

typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint8_t     numBytes;
  uint8_t     data;
} scuAnwsRIR_t;


typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint16_t    regAdd;
  uint16_t    numWord;
} headerAnwsWMR_t;

typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint8_t     errorCode;
} headerAnwsError_t;


typedef __packed union
{
  nodeRWsingleReg_st    nodeRWsingleReg;
  headerRIR_t           nodeReadInputReg;
  headerRHR_t           nodeReadHoldingReg;
  scuRWmultipleReg_st   nodeRWmultipleReg;
  nodeWsingleReg_st     nodeWsingleReg;
  headerAnwsRIR_t       headerAnwsRIR; 
  headerAnwsWMR_t       headerAnwsWMR;
  headerAnwsError_t     headerAnwsError;
  scuAnwsRIR_t          scuAnwsRIR;
  frameSbcRx_st         frameSbcRx;
} ScuMessage_u;


typedef __packed struct
{
  uint16_t            totalLen;
  uint8_t*            pMessage;
  uint16_t            idSCU;          /* address on RS485 1..16                   */
  uint16_t            reqRegAddr;     /* address register required                */
  scuAllRegIdx_e      scuRegIdx;      /* index of the request register            */
  scuEvents_e         scuEvents;
  scuMsgDir_e         scuMsgDir;
} frameScu_st;


/* ----------- Receive  definition from  SCU   -------------*/
typedef __packed struct
{
  scuDlEvents_e       dlEvent;
  scuDlOp_e           scuDlOp;
  uint16_t            idSCU;          /* address on RS485 1..16                   */
  uint16_t            reqRegAddr;     /* address register required                */
  scuAllRegIdx_e      scuRegIdx;      /* index of the request register            */
  uint16_t            totalLen;
} headerScuRx_st;


typedef __packed struct
{
  uint8_t     startFrame;
  uint8_t     address;
  uint8_t     len;
  uint8_t     payload[SCU_DL_RX_PAYLOAD_MAX_LEN];
} reqScuUser_st;


typedef __packed union
{
  reqScuUser_st         reqScuUser;
  uint8_t               msgComplete[NUM_BUFF_SCU_DL_RX];
} messageScuRx_u;

/* define for SCU single registers  info */
typedef __packed struct
{
  uint16_t    regAdd;
  uint16_t    size;           /* number of word to be read/write for the specified reg address  */
  regType_e   regType;        /* register type                                                  */
} scuRegInfo_st;

/* SCU index and relative address  */
typedef __packed struct
{
  uint16_t    index;
  uint16_t    rAddr;
}regScuAddr_t;

/* start  registers  info linked a request from RS485 */
typedef __packed struct
{
  uint16_t    index;
  uint8_t*    pRegAdd;
}regStartInfo_t;

typedef __packed struct
{
  scuStates_e         scuStates;
  uint16_t            crcCpuId;
  headerScuRx_st      frameScuDlRxTmp;
} scuInfoMng_st;

typedef __packed struct
{
  scuDlStates_e       scuStates;
  headerRIR_t         lastRd;
} scuDlInfoMng_st;

/***                                                                                                                                                 ***/
/*** Definizioni per il protocollo MODBUS tra SCU e SBC ************************************************************************************************/
/***                                                                                                                                                 ***/
#define LEN_BOARD_FW_VERSION_RO                 ((uint16_t)12)        /* address len Campo ASCII contenente la versione del main firmware                               */                                 
#define LEN_MIFARE_FW_VERSION_RO                ((uint16_t)10)        /* address len Versione FW del lettore RFID                                                       */         
#define LEN_BOARD_SN_RO                         ((uint16_t)8)         /* address len Numero di serie della scheda                                                       */         
#define LEN_PLC_FW_VERSION_RO                   ((uint16_t)12)        /* address len Campo ASCII versione FW del modulo PLC (solo stazione DC)                          */         
#define LEN_PLC_MAC_ADDRESS_RO                  ((uint16_t)10)        /* address len MAC address lendel modulo PLC (solo stazione DC)                                   */         
#define LEN_HW_REVISION_RO                      ((uint16_t)8)         /* address len Campo versione hardware della scheda                                               */
#define LEN_WIFI_MAC_ADDRESS_RO                 ((uint16_t)10)        /* address len MAC address del modulo Wi-Fi Espressif                                             */
#define LEN_POWER_MODULE_SN_RO                  ((uint16_t)10)        /* address len Numero di serie del modulo di potenza                                              */   
#define LEN_BLE_MAC_ADDRESS_RO                  ((uint16_t)10)        /* address len MAC address del modulo Bluetooth (da valutare se serve)                            */   
#define LEN_PRODUCT_SN_RO                       ((uint16_t)8)         /* address len Campo numero di serie del prodotto                                                 */
#define LEN_PRODUCT_CODE_RO                     ((uint16_t)12)        /* address len Campo codice prodotto SCAME                                                        */
#define LEN_BOOT_FW_VERSION_RO                  ((uint16_t)12)        /* address len Campo ASCII contenente la versione del boot firmware                               */
#define LEN_MODBUS_VERSION_RO                   ((uint16_t)1)         /* address len Campo lunghezza versione del modbus                                                */
#define LEN_SCU_RESERVED1                       ((uint16_t)133)       /* address len Reserved for future use                                                            */         

#define LEN_NOTIFY_EVSE_PRESENCE_RO             ((uint16_t)2)         /* address len Indica quanti e quali indirizzi sono presenti nel sistema                          */         
#define LEN_NOTIFY_EVSE_CHANGE_RO               ((uint16_t)2)         /* address len Registro per segnalare un cambiamento di stato (prevedere autocleaning)            */         
#define LEN_EVSE_ERROR1_RO                      ((uint16_t)1)         /* address len Registro 1 per segnalare allarmi e/o errori                                        */         
#define LEN_EVSE_ERROR2_RO                      ((uint16_t)1)         /* address len Registro 2 per segnalare allarmi e/o errori                                        */         
#define LEN_EVSE_CHANGE_REGISTERS_RO            ((uint16_t)32)        /* address len contiene l'indirizzo del registro cambiato per ogni singola scheda                 */         
#define LEN_SCU_RESERVED2                       ((uint16_t)474)       /* address len Reserved for future use                                                            */         

#define LEN_EVSE_EVENT_FLAGS_RO                 ((uint16_t)1)         /* address len Registro stato del connettore tethered                                             */         
#define LEN_EVSE_CHARGE_STATUS_RO               ((uint16_t)1)         /* address len registro che notifica lo stato della stazione                                      */    
#define LEN_TEMPERATURE_SYSTEM_RO               ((uint16_t)2)         /* address len temperatura del sistema (quella rilevata dal uP nel caso AC)                       */         
#define LEN_RESERVED3_RDD                       ((uint16_t)10)        /* address len Reserved for duture use                                                            */        
 
#define LEN_VOLTAGE_AC_RO                       ((uint16_t)2)         /* address len Tensione di alimentazione del sistema (parametro OCCP)                             */         
#define LEN_CURRENT_AC_L1_RO                    ((uint16_t)2)         /* address len Corrente fase 1 (parametro OCCP)                                                   */         
#define LEN_CURRENT_AC_L2_RO                    ((uint16_t)2)         /* address len Corrente fase 2 (parametro OCCP)                                                   */         
#define LEN_CURRENT_AC_L3_RO                    ((uint16_t)2)         /* address len Corrente fase 3 (parametro OCCP)                                                   */         
#define LEN_ACTIVE_POWER_DC                     ((uint16_t)2)         /* address len Sommatoria delle correnti                                                          */       
#define LEN_ACTIVE_POWER_AC_RO                  ((uint16_t)2)         /* address len Potenza attiva del sistema     (parametro OCCP)                                    */       
#define LEN_ACTIVE_POWER_AC_L1_RO               ((uint16_t)2)         /* address len potenza attiva fase 1                                                              */       
#define LEN_REACTIVE_POWER_AC_RO                ((uint16_t)2)         /* address len Potenza reattiva del sistema   (parametro OCCP)                                    */       
#define LEN_TOTAL_ACTIVE_ENERGY_AC_EV_RO        ((uint16_t)2)         /* address len Energia attiva del sistema     (parametro OCCP)                                    */       
#define LEN_TOTAL_ACTIVE_ENERGY_DC_EV_RO        ((uint16_t)2)         /* address len Energia apparente del sistema  (parametro OCCP)                                    */       
#define LEN_TOTAL_REACTIVE_ENERGY_AC_EV_RO      ((uint16_t)2)         /* address len Energia reattiva del sistema   (parametro OCCP)                                    */       
#define LEN_TRANSACTION_ACTIVE_ENERGY_AC_EV_RO  ((uint16_t)2)         /* address len Energia attiva parziale relativa alla sessione corrente    (parametro OCCP)        */       
#define LEN_ACTIVE_POWER_AC_L2_RO               ((uint16_t)2)         /* address len potenza attiva fase 2                                                              */       
#define LEN_TRANSACTION_REACTIVE_ENERGY_AC_EV_RO ((uint16_t)2)        /* address len Energia reattiva parziale relativa alla sessione corrente  (parametro OCCP)        */       
#define LEN_FREQUENCY_SUPPLY_RO                 ((uint16_t)2)         /* address len Frequenza di rete     (parametro OCCP)                                             */       
#define LEN_RESERVED4_RDD                       ((uint16_t)9)         /* address len Reserved (usati per stazione DC)                                                   */       
#define LEN_MAX_CURRENT_ROTATORY_SWITCH_RO      ((uint16_t)1)         /* address len Corrente impostata nel selettore rotativo                                          */       
#define LEN_UNDEFINED_EX_RSC_CURR_RDD           ((uint16_t)2)         /* address len Corrente massima di sistema                                                        */       
#define LEN_ACTIVE_POWER_AC_L3_RO               ((uint16_t)2)         /* address len potenza attiva fase 2                                                              */       
#define LEN_EMPTY_063A                          ((uint16_t)1)         /* address len of empty register at address 063A                                                  */
#define LEN_MAX_CURRENT_RESULT_RO               ((uint16_t)1)         /* address len Corrente massima di carica risultante dai vari calcoli e confronti                 */       
#define LEN_TRANSACTION_TIME_RO                 ((uint16_t)2)         /* address len Tempo in secondi, trascorsi dall'inizio della carica                               */       
#define LEN_TRANSACTION_COUNTDOWN_RO            ((uint16_t)2)         /* address len Tempo, in secondi, rimanenti al completamento della carica                         */       
#define LEN_EV_BATTERY_RO                       ((uint16_t)1)         /* address len percentuale della carica della batteria  (parametro OCCP)                          */       
#define LEN_SESSION_ID_RO                       ((uint16_t)2)         /* address len identificatore della sessione di carica                                            */       
#define LEN_EVSE_BOOT_EVENT_RO                  ((uint16_t)1)         /* address len identificatore tipo di reset                                                       */       

/* Aggiunti per v18b Modbus */
#define LEN_TOTAL_ACTIVE_ENERGY_AC_GRID_RO      ((uint16_t)2)         /* address len Energia Attiva totale funzione GRID V2G                                            */
#define LEN_TOTAL_REACTIVE_ENERGY_AC_GRID_RO    ((uint16_t)2)         /* address len Energia Reattiva totale funzione GRID V2G                                          */
#define LEN_TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO   ((uint16_t)2)      /* address len Energia Attiva erogata in una transazione, funzione GRID V2G                       */
#define LEN_TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO ((uint16_t)2)      /* address len Energia Reattiva erogata in una transazione, funzione GRID V2G                     */ 
#define LEN_SCU_RESERVED6                       ((uint16_t)4)         /* address len reserved                                                                           */   

/* Registro di notifica quindi messo in una sezione a parte */
#define LEN_UID_AUTHORIZATION_RO                ((uint16_t)24)        /* address len valore UID della card letta                                                        */
#define LEN_TIME_IN_CHARGE_RO                   ((uint16_t)2)         /* address len tempo effettivo di carica                                                          */
#define LEN_SCU_RESERVED6B                      ((uint8_t)198)        /* address len reserved                                                                           */                

/* ----- Fine dei parametri Read-Only si passa a quelli RW --------------   */

#define LEN_CONNECTOR_TYPE_RW                   ((uint16_t)1)         /* address len modello della stazione                                                             */  
#define LEN_HWC_FLAGS_RW                        ((uint16_t)1)         /* address len flag componenti hardware aggiuntivi                                                */  
#define LEN_ENERGY_METERS_RW                    ((uint16_t)1)         /* address len tipo di energy meter                                                               */
#define LEN_POWER_OUTAGE_HW_RW                  ((uint16_t)1)         /* address len Tipo di hardware installato per gestire l'assenza di tensione                      */ 

#define LEN_CONNECTOR_IDS_RW                    ((uint16_t)1)         /* address len Modifica indirizzo modbus usato come alias della scheda                            */       
#define LEN_BOARD_SN_RW                         ((uint16_t)8)         /* address len Numero di serie della stazione                                                     */       
#define LEN_PRODUCT_SN_RW                       ((uint16_t)8)         /* address len Numero di serie del prodotto                                                       */       
#define LEN_MASTER_HARDWARE_TYPE_RW             ((uint16_t)1)         /* address len Configurazione master / slave                                                      */       
#define LEN_UTC_DATE_TIME_RW                    ((uint16_t)9)         /* address len data e ora correnti letti da RTC                                                   */       
#define LEN_POWER_MODULE_BRAND_RW               ((uint16_t)1)         /* address len Indica la marca del produttore del caricabatteria (solo DC)                        */       
#define LEN_POWER_MODULE_MODEL_RW               ((uint16_t)1)         /* address len Indica la marca del modello del caricabatteria (solo DC)                           */       
#define LEN_POWER_MODULE_N_RW                   ((uint16_t)1)         /* address len Indica il numero di moduli installati al sistema  (solo DC)                        */       
#define LEN_EVSE_TM_MODE_RW                     ((uint16_t)1)         /* address len Abilitazione macchina di collaudo                                                  */       
#define LEN_EVSE_OPERATION_MODE_RW              ((uint16_t)1)         /* address len In dica la modalità di funzionamento del sistema di ricarica                       */       
#define LEN_CHARGE_PROTOCOL_SELECTED_RW         ((uint16_t)1)         /* address len Quale connettore utilizzare per la ricarica (DC)                                   */       
#define LEN_DISPLAY_DEFAULT_LANGUAGE_RW         ((uint16_t)1)         /* address len Indica la lingua utilizzata dal sistema                                            */
#define LEN_HW_CHECKS1_RW                       ((uint16_t)1)         /* address len Registro per abilitazione errori                                                   */                                 
#define LEN_HW_CHECKS2_RW                       ((uint16_t)1)         /* address len Registro per abilitazione errori                                                   */                                 
#define LEN_HW_ACTUATORS_RW                     ((uint16_t)1)         /* address len Registro per la configurazione degli attuatori del sistema                         */                                 

#define LEN_SCU_RESERVED7                       ((uint16_t)8)         /* address len Imposta la corrente massima AC disponibile nel sistema                             */                                 
#define LEN_MAX_TEMPORARY_CURRENT_RW            ((uint16_t)2)         /* address len Parametro PID per sistema AC                                                       */           
#define LEN_EMPTY_0033_RW                       ((uint16_t)1)         /* address len --------------                                                                     */        

#define LEN_LED_STRIP_RW                        ((uint16_t)1)         /* address len Registro utilizzato per impostare lunghezza strip led                              */           
#define LEN_REMOTE_COMMANDS_RW                  ((uint16_t)1)         /* address len Emulazione stato pressione del pulsante remoto                                     */           
#define LEN_ENVIRONMENT_BRIGHTNESS_RW           ((uint16_t)1)         /* address len Valore di luminosità letto dal sensore                                             */           
#define LEN_MIN_POWER_DC_RWD                    ((uint16_t)2)         /* address len minima potenza DC (non usato in AC)                                            */           
#define LEN_UNDEFINED_EX_PRX_MOTION_RWD         ((uint16_t)1)         /* address len Registro flag che indica presenza di movimento rilevata                            */           
#define LEN_MAX_TEMPORARY_POWER_AC              ((uint16_t)2)         /* address len Parametro per impostare potenza massima temporanea AC disponibile                  */             
#define LEN_PM_MODE_RW                          ((uint16_t)1)         /* address len registro utilizzato modalità Power Management                                      */           
#define LEN_ENABLE_LOG_RW                       ((uint16_t)1)         /* address len abilitazione log su SD (solo DC)                                                   */           
#define LEN_AUTHORIZATION_FEEDBACK_RW           ((uint16_t)1)         /* address len in modalità NET autorizza e controlla la carica                                    */           
#define LEN_TIMEZONE_RW                         ((uint16_t)1)         /* address definizione time zone rispetto a UTC                                                   */           
#define LEN_MENU_VISIBILITY_RW                  ((uint16_t)1)         /* address len visibilità di alcuni menu                                                          */      
#define LEN_TIMEOUT_RANGE1_RW                   ((uint16_t)1)         /* address len valore di partenza contatore 1                                                     */           
#define LEN_TIMEOUT_RANGE2_RW                   ((uint16_t)1)         /* address len valore di partenza contatore 2                                                     */
#define LEN_PRODUCT_CODE_RW                     ((uint16_t)12)        /* address len Codice prodotto Scame                                                              */

/* Aggiunti per v18b Modbus */
#define LEN_TECN_PRODUCT_CODE_RW                ((uint16_t)10)        /* address len Codice prodotto Fake per algoritmo configuratore e SEM                             */
#define LEN_CONNECTOR_N_RW                      ((uint16_t)1)         /* address len Numero connettore basato sulla posizione nella EVSE                                */
#define LEN_DISPLAY_LANGUAGES_RW                ((uint16_t)2)         /* address len Lingua impostata e lingua di default della EVSE                                    */
#define LEN_MAX_TYPICAL_CURRENT_RW              ((uint16_t)1)         /* address len Corrente massima erogabile in modalità tipica (ex RSC_CURR_RO v18)                 */
#define LEN_MAX_SIMPLIFIED_CURRENT_RW           ((uint16_t)1)         /* address len Corrente massima erogabile in modalità semplificata                                */
#define LEN_CHARGE_BY_TIME_RW                   ((uint16_t)1)         /* address len Tempo di carica massimo                                                            */
#define LEN_CHARGE_BY_ENERGY_RW                 ((uint16_t)1)         /* address len Potenza massima di carica permessa                                                 */  
#define LEN_PM_IMIN_RW                          ((uint16_t)1)         /* address len Corrente minima erogabile in funzionalità di Power Management                      */
#define LEN_PM_PMAX_RW                          ((uint16_t)1)         /* address len Potenza massima erogabile in funzionalità di Power Management                      */
#define LEN_PM_FLAGS_RW                         ((uint16_t)1)         /* address len Flag di abilitazione Power Management                                              */
#define LEN_PM_HPOWER_RW                        ((uint16_t)1)         /* address len Valore di isteresi soglia di potenza Power Management                              */
#define LEN_PM_DSET_RW                          ((uint16_t)1)         /* address len Valore di variazione della potenza in erogazione verso l'EV                        */
#define LEN_PM_DMAX_RW                          ((uint16_t)1)         /* address len Valore di potenza in eccesso che può essere erogato dall'EVSE                      */
#define LEN_PIN_EXTERNAL_ENERGY_METER_RW        ((uint16_t)1)         /* address len Pin energy meter esterno                                                           */ 
#define LEN_LIM_MAX_POWER_AC_RW                 ((uint16_t)2)         /* address len per massima potenza in AC                                                          */ 
#define LEN_RESERVED_A                          ((uint16_t)10)        /* address len reserved                                                                           */  

#define LEN_FILE_COMMAND_RW                     ((uint16_t)1)         /* address len Comando per avviare l'aggiornamento SW                                             */           
#define LEN_FILE_SIZE_RW                        ((uint16_t)2)         /* address len Registro con indicazione della lunghezza del file da caricare                      */           
#define LEN_FILE_PACKET_RW                      ((uint16_t)1)         /* address len Registro con indicazione del numero di pacchetti da caricare                       */           
          
/****          definizioni lunghezze per l'ambiente SINAPSI - RSE ***************************************************************************************  */
#define LEN_IOM_CTRL_REG                        ((uint16_t)1)         /* address len Registro controllo per nuovi dati disponibili                                      */           
#define LEN_M2_POT_ATT_IMM_IST_TS               ((uint16_t)2)         /* address len time stamp potenza attiva immessa istantanea letta dal contatore M2                */           
#define LEN_M2_POT_ATT_IMM_IST                  ((uint16_t)1)         /* address len potenza attiva immessa istantanea letta dal contatore M2                           */           
#define LEN_M2_POT_CONTRATTUALE_TS              ((uint16_t)2)         /* address len time stamp potenza contrattuale del contatore M2                                   */           
#define LEN_M2_POT_CONTRATTUALE                 ((uint16_t)1)         /* address len potenza contrattuale del contatore M2                                              */           
#define LEN_M1_POT_CONTRATTUALE_TS              ((uint16_t)2)         /* address len time stamp potenza contrattuale del contatore M1                                   */           
#define LEN_M1_POT_CONTRATTUALE                 ((uint16_t)1)         /* address len potenza contrattuale del contatore M1                                              */           
#define LEN_M1_POT_DISPONIBILE_TS               ((uint16_t)2)         /* address len time stamp potenza disponibile  del contatore M1                                   */           
#define LEN_M1_POT_DISPONIBILE                  ((uint16_t)1)         /* address len potenza disponibile del contatore M1                                               */           
#define LEN_M1_POT_ATT_PRE_IST_TS               ((uint16_t)2)         /* address len time stamp potenza attiva prelevata istantanea  del contatore M1                   */           
#define LEN_M1_POT_ATT_PRE_IST                  ((uint16_t)1)         /* address len attiva prelevata istantanea  del contatore M1                                      */           
#define LEN_M1_POT_ATT_IMM_IST_TS               ((uint16_t)2)         /* address len time stamp potenza attiva immessa istantanea  del contatore M1                     */           
#define LEN_M1_POT_ATT_IMM_IST                  ((uint16_t)1)         /* address len attiva immessa istantanea  del contatore M1                                        */           
#define LEN_M1_DISTACCO_TS                      ((uint16_t)2)         /* address len time stamp da cui si calcola tempo di distacco al contatore M1                     */           
#define LEN_M1_TEMPO_RES_DIST                   ((uint16_t)1)         /* address len tempo residuo di distacco al   contatore M1                                        */           
#define LEN_M1_PROF_FASCIA_ORARIA_TS            ((uint16_t)2)         /* address len time stamp da cui parte la fascia oraria corrente al contatore M1                  */           
#define LEN_M1_PROF_FASCIA_ORARIA               ((uint16_t)1)         /* address len fascia oraria corrente  al   contatore M1                                          */           
#define LEN_M1_POT_TEMPO_LIMITE_TS              ((uint16_t)2)         /* address len time stamp dat e ora fino a cui si può ricaricare alla Pmaxt  al contatore M1      */           
#define LEN_M1_POT_MAX_RIC_TLIM                 ((uint16_t)1)         /* address len potenza massima Pmaxt di ricarica a tempo limitata al contatore M1                 */           
#define LEN_M1_SOSP_RIC_TLIM_TS                 ((uint16_t)2)         /* address len time stamp data e ora fino a cui è obbligatorio sospendere la carica al cnt M1     */           
#define LEN_M1_UNIXTIME_SYNC                    ((uint16_t)2)         /* address len sincronizzazione orologio formato unixtime tra IOM e SCU                           */           
#define LEN_SET_CONFIG_MODE                     ((uint16_t)1)         /* address len set configuration Bluetoth board SINAPSI                                           */ 

/****          definizioni lunghezze per simulatore EM LOVATO Ethernet   *********************************************************************************  */
#define LEN_EM_LOVATO_V_SYS                     ((uint16_t)2)         /* address registro tensione di fase L1                                                           */ 
#define LEN_EM_LOVATO_P_AREA                    ((uint16_t)48)        /* address registro potenza attiva delle prese                                                    */ 


/****          definizioni lunghezze per l'ambiente collaudo scheda PEN  *********************************************************************************  */
#define LEN_PEN_RELE_RWD                        ((uint16_t)1)         /* address registro comando relè                                                                  */ 

/****          definizioni lunghezze per l'ambiente Macchina di Collaudo *********************************************************************************  */
#define LEN_TM_MEASURED_CURRENT_RW              ((uint16_t)1)         /* address len Valore di corrente misurato dall'EM interno alla macchina di collaudo              */
#define LEN_TM_MEASURED_VOLTAGE_RW              ((uint16_t)1)         /* address len Valore di tensione misurato dall'EM interno alla macchina di collaudo              */
#define LEN_TM_EVSE_READY_RO                    ((uint16_t)1)         /* address len Flag per mostrare quando una EVSE è disponibile a proseguire con i test            */
#define LEN_TM_ADDR_S_CONN_RW                   ((uint16_t)1)         /* address len Flag per presenza slave collegata alla master                                      */
#define LEN_TM_ADDR_REQ_RW                      ((uint16_t)1)         /* address len richiesta indirizzamento automatico                                                */
#define LEN_TM_ADDR_ASS_RW                      ((uint16_t)1)         /* address len assegnazione indirizzamento automatico                                             */
#define LEN_ADDR_TM_ERROR1_RO                   ((uint16_t)1)         /* address len errori in fase di collaudo                                                         */
#define LEN_TM_UID_MASTER_RW                    ((uint16_t)4)         /* address len Valore campo UID carta Master                                                      */
#define LEN_TM_UID_USER_RW                      ((uint16_t)4)         /* address len Valore campo UID carta User                                                        */
#define LEN_TM_MEASURED_CURRENT_L2_RW           ((uint16_t)1)         /* address len Valore di corrente misurato dall'EM interno alla macchina di collaudo L2           */
#define LEN_TM_MEASURED_VOLTAGE_L2_RW           ((uint16_t)1)         /* address len Valore di tensione misurato dall'EM interno alla macchina di collaudo L2           */
#define LEN_TM_MEASURED_CURRENT_L3_RW           ((uint16_t)1)         /* address len Valore di corrente misurato dall'EM interno alla macchina di collaudo L3           */
#define LEN_TM_MEASURED_VOLTAGE_L3_RW           ((uint16_t)1)         /* address len Valore di tensione misurato dall'EM interno alla macchina di collaudo L3           */
#define LEN_TM_GET_EEPROM_RW                    ((uint16_t)1)         /* address len Valore per la richiesta parametri in EEPROM                                        */

/****          definizioni lunghezze per l'ambiente APP tecnica          *********************************************************************************  */
#define LEN_CONNECTOR_INIT_STATUS_RO            ((uint16_t)1)         /* address len Stato di attivazione della presa collegata alla App                                */
#define LEN_CONNECTOR_OPERATION_STATUS_RO       ((uint16_t)1)         /* address len Registro di stato Idle della presa, richiesto da Enrico per ios                    */  
#define LEN_PROCEDURE_RESPONSE_RO               ((uint16_t)2)         /* address len Registro contenente l'esito di una Procedura app-modulo Wi-Fi                      */
#define LEN_PM_TOTAL_POWER_RO                   ((uint16_t)2)         /* address len Registro potenza esterna misurata                                                  */
#define LEN_PM_L1_POWER_RO                      ((uint16_t)2)         /* address len Potenza esterna fase 1                                                             */
#define LEN_PM_L2_POWER_RO                      ((uint16_t)2)         /* address len Potenza esterna fase 2                                                             */
#define LEN_PM_L3_POWER_RO                      ((uint16_t)2)         /* address len Potenza esterna fase 3                                                             */
#define LEN_APP_LOGIN_USER_TYPE_RO              ((uint16_t)1)         /* address len Tipologia di utente cheha fatto il login                                           */          
#define LEN_CONNECTOR_CHECK_ACTIV_KEY_RW        ((uint16_t)3)         /* address len Controllo codice di attivazione della presa                                        */
#define LEN_CONNECTOR_NAME_RW                   ((uint16_t)7)         /* address len Nome presa scelto dall'utente                                                      */
#define LEN_CONNECTOR_PIN_RW                    ((uint16_t)3)         /* address len PIN presa scelto dall'utente in fase di inizializzazione                           */
#define LEN_ROUTER_NET_SSID_RW                  ((uint16_t)16)        /* address len SSID rete router domestico                                                         */
#define LEN_ROUTER_NET_PASSWORD_RW              ((uint16_t)32)        /* address len Password rete router domestico                                                     */
#define LEN_CONNECTOR_ROUTER_IP_RW              ((uint16_t)8)         /* address len IP modulo Wi-Fi scelto dal router domestico                                        */
#define LEN_PROCEDURE_REQUEST_RW                ((uint16_t)1)         /* address len Richiesta di una procedura dall App alla SCU                                       */
#define LEN_SCHEDULE_FLAG1_RW                   ((uint16_t)1)         /* address len Flag di attivazione della schedulazione numero 1                                   */
#define LEN_SCHEDULE_START1_RW                  ((uint16_t)1)         /* address len Orario di partenza della prima carica schedulata                                   */
#define LEN_SCHEDULE_STOP1_RW                   ((uint16_t)1)         /* address len Orario di stop della prima carica schedulata                                       */
#define LEN_SCHEDULE_POWER1_RW                  ((uint16_t)2)         /* address len Massima potenza impostabile per la schedulazione 1                                 */          
#define LEN_SCHEDULE_FLAG2_RW                   ((uint16_t)1)         /* address len Flag di attivazione della schedulazione numero 2                                   */
#define LEN_SCHEDULE_START2_RW                  ((uint16_t)1)         /* address len Orario di partenza della seconda carica schedulata                                 */
#define LEN_SCHEDULE_STOP2_RW                   ((uint16_t)1)         /* address len Orario di stop della seconda carica schedulata                                     */
#define LEN_SCHEDULE_POWER2_RW                  ((uint16_t)2)         /* address len Massima potenza impostabile per la schedulazione 2                                 */
#define LEN_SCHEDULE_FLAG3_RW                   ((uint16_t)1)         /* address len Flag di attivazione della schedulazione numero 3                                   */
#define LEN_SCHEDULE_START3_RW                  ((uint16_t)1)         /* address len Orario di partenza della terza carica schedulata                                   */
#define LEN_SCHEDULE_STOP3_RW                   ((uint16_t)1)         /* address len Orario di stop della terza carica schedulata                                       */
#define LEN_SCHEDULE_POWER3_RW                  ((uint16_t)2)         /* address len Massima potenza impostabile per la schedulazione 3                                 */
#define LEN_SCHEDULE_FLAG4_RW                   ((uint16_t)1)         /* address len Flag di attivazione della schedulazione numero 4                                   */
#define LEN_SCHEDULE_START4_RW                  ((uint16_t)1)         /* address len Orario di partenza della quarta carica schedulata                                  */
#define LEN_SCHEDULE_STOP4_RW                   ((uint16_t)1)         /* address len Orario di stop della quarta carica schedulata                                      */
#define LEN_SCHEDULE_POWER4_RW                  ((uint16_t)2)         /* address len Massima potenza impostabile per la schedulazione 4                                 */
#define LEN_CONNECTOR_CONNECTION_STATUS_RO      ((uint16_t)1)         /* address len Stato di connessione alla rete di un router                                        */                
#define LEN_MAX_POWER_RO                        ((uint16_t)2)         /* address len Massima potenza per settaggio tachimetro APP                                       */                  
#define LEN_RANDOM_DELAY_FLAG_RW                ((uint16_t)1)         /* address len abilitazione/disabilitazione schedulazioni                                         */                  
#define LEN_UID_AUTHORIZATION_APP_RW            ((uint16_t)5)         /* address len uid autorizzazione da app                                                          */        
#define LEN_BT_SINAPSI_STATUS_RW                ((uint16_t)1)         /* address len Stato del bluetooth Sinapsi                                                        */                              
#define LEN_FW_UPDATE_NAME_RW                   ((uint16_t)9)         /* address len nome fimrware da aggiornare                                                        */
#define LEN_FW_UPDATE_LEN_RW                    ((uint16_t)2)         /* address len lunghezza firmware da aggiornare                                                   */ 
#define LEN_FW_UPDATE_STATUS_RO                 ((uint16_t)1)         /* address len esito firmware update                                                              */                                
#define LEN_EVSE_POWER_MODE_RO                  ((uint16_t)1)         /* address len alimentazione stazione di ricarica                                                 */
#define LEN_PM_PARAMETERS_RO                    ((uint16_t)6)         /* address len Power Management parameters                                                        */

#define LEN_APP_EXCHANGE_AREA_RO                ((uint16_t)255)       /* len of area used by App to exchange datas with SCU */

/****          definizioni indirizzi per l'ambiente SCU-SEM        ***************************************************************************************  */
#define ADDR_START_RDD                          ((uint16_t)0x0300)                                                                 /* start address per read only register RIR function 04                 */                                 
#define ADDR_BOARD_FW_VERSION_RO                (ADDR_START_RDD                         + 0                                     )  /* address Campo ASCII contenente la versione del main firmware  0x0302 */                                 
#define ADDR_MIFARE_FW_VERSION_RO               (ADDR_BOARD_FW_VERSION_RO               + LEN_BOARD_FW_VERSION_RO               )  /* address Versione FW del lettore RFID                                 */         
#define ADDR_BOARD_SN_RO                        (ADDR_MIFARE_FW_VERSION_RO              + LEN_MIFARE_FW_VERSION_RO              )  /* address Numero di serie della scheda                                 */         
#define ADDR_PLC_FW_VERSION_RO                  (ADDR_BOARD_SN_RO                       + LEN_BOARD_SN_RO                       )  /* address Campo ASCII versione FW del modulo PLC (solo stazione DC)    */         
#define ADDR_PLC_MAC_ADDRESS_RO                 (ADDR_PLC_FW_VERSION_RO                 + LEN_PLC_FW_VERSION_RO                 )  /* address MAC address lendel modulo PLC (solo stazione DC)             */         
#define ADDR_HW_REVISION_RO                     (ADDR_PLC_MAC_ADDRESS_RO                + LEN_PLC_MAC_ADDRESS_RO                )  /* address Versione hardware della SCU                                  */
#define ADDR_WIFI_MAC_ADDRESS_RO                (ADDR_HW_REVISION_RO                    + LEN_HW_REVISION_RO                    )  /* address Indirizzo MAC del modulo Wi-Fi                               */
#define ADDR_POWER_MODULE_SN_RO                 (ADDR_WIFI_MAC_ADDRESS_RO               + LEN_WIFI_MAC_ADDRESS_RO               )  /* address Numero di serie del modulo di potenza                        */
#define ADDR_BLE_MAC_ADDRESS_RO                 (ADDR_POWER_MODULE_SN_RO                + LEN_POWER_MODULE_SN_RO                )  /* address Indirizzo MAC del modulo Bluetooth                           */
#define ADDR_PRODUCT_SN_RO                      (ADDR_BLE_MAC_ADDRESS_RO                + LEN_BLE_MAC_ADDRESS_RO                )  /* address Numero di serie prodotto finito                              */
#define ADDR_PRODUCT_CODE_RO                    (ADDR_PRODUCT_SN_RO                     + LEN_PRODUCT_SN_RO                     )  /* address Codice prodotto SCAME                                        */
#define ADDR_BOOT_FW_VERSION_RO                 (ADDR_PRODUCT_CODE_RO                   + LEN_PRODUCT_CODE_RO                   )  /* address boot firmware version                                        */
#define ADDR_MODBUS_VERSION_RO                  (ADDR_BOOT_FW_VERSION_RO                + LEN_BOOT_FW_VERSION_RO                )  /* address modbus  version                                        */
#define ADDR_SCU_RESERVED1                      (ADDR_MODBUS_VERSION_RO                 + LEN_MODBUS_VERSION_RO                 )  /* address Reserved for future use                                      */         

#define ADDR_NOTIFY_EVSE_PRESENCE_RO            ((uint16_t)0x0400                       + 0)                                       /* address Indica quanti e quali indirizzi sono presenti nel sistema    */         
#define ADDR_NOTIFY_EVSE_CHANGE_RO              (ADDR_NOTIFY_EVSE_PRESENCE_RO           + LEN_NOTIFY_EVSE_PRESENCE_RO           )  /* address Registro per segnalare un cambiamento di stato (prevedere autocleaning)          */         
#define ADDR_EVSE_ERROR1_RO                     (ADDR_NOTIFY_EVSE_CHANGE_RO             + LEN_NOTIFY_EVSE_CHANGE_RO             )  /* address Registro 1 per segnalare allarmi e/o errori                  */         
#define ADDR_EVSE_ERROR2_RO                     (ADDR_EVSE_ERROR1_RO                    + LEN_EVSE_ERROR1_RO                    )  /* address Registro 2 per segnalare allarmi e/o errori                  */         
#define ADDR_EVSE_CHANGE_REGISTERS_RO           (ADDR_EVSE_ERROR2_RO                    + LEN_EVSE_ERROR2_RO                    )  /* address contiene l'indirizzo del registro cambiato per ogni singola scheda               */         
#define ADDR_SCU_RESERVED2                      (ADDR_EVSE_CHANGE_REGISTERS_RO          + LEN_EVSE_CHANGE_REGISTERS_RO          )  /* address Reserved for future use                                      */         

/****          definizioni indirizzi per l'APP local (Read-Only)        ***************************************************************************************  */
#define ADDR_APP_EXCHANGE_AREA_RO               ((uint16_t)0x0500                       + 0)                                      /* address of exchange area used for App local                          */         

#define ADDR_EVSE_EVENT_FLAGS_RO                ((uint16_t)0x0600                       + 0                                     )  /* address contiene lo stato del connettore tethered                    */         
#define ADDR_EVSE_CHARGE_STATUS_RO              (ADDR_EVSE_EVENT_FLAGS_RO               + LEN_EVSE_EVENT_FLAGS_RO               )  /* registro che notifica lo stato della stazione                        */         
#define ADDR_TEMPERATURE_SYSTEM_RO              (ADDR_EVSE_CHARGE_STATUS_RO             + LEN_EVSE_CHARGE_STATUS_RO             )  /* address temperatura del sistema (quella rilevata dal uP nel caso AC) */ 
#define ADDR_SCU_RESERVED3                      (ADDR_TEMPERATURE_SYSTEM_RO             + LEN_TEMPERATURE_SYSTEM_RO             )  /* address Reserved for DC system                                       */         
#define ADDR_DC_RESERVED3_END                   (ADDR_SCU_RESERVED3                     + LEN_RESERVED3_RDD                     )  /* address Reserved for DC system                                       */         

#define ADDR_VOLTAGE_AC_RO                      (ADDR_SCU_RESERVED3                     + LEN_RESERVED3_RDD                     )  /* 0x060E address Tensione di alimentazione del sistema (parametro OCCP)*/         
#define ADDR_CURRENT_AC_L1_RO                   (ADDR_VOLTAGE_AC_RO                     + LEN_VOLTAGE_AC_RO                     )  /* address Corrente fase 1 (parametro OCCP)                             */         
#define ADDR_CURRENT_AC_L2_RO                   (ADDR_CURRENT_AC_L1_RO                  + LEN_CURRENT_AC_L1_RO                  )  /* address Corrente fase 2 (parametro OCCP)                             */         
#define ADDR_CURRENT_AC_L3_RO                   (ADDR_CURRENT_AC_L2_RO                  + LEN_CURRENT_AC_L2_RO                  )  /* address Corrente fase 3 (parametro OCCP)                             */         
#define ADDR_ACTIVE_POWER_DC_RO                 (ADDR_CURRENT_AC_L3_RO                  + LEN_CURRENT_AC_L3_RO                  )  /* address Sommatoria delle correnti                                    */       
#define ADDR_ACTIVE_POWER_AC_RO                 (ADDR_ACTIVE_POWER_DC_RO                + LEN_ACTIVE_POWER_DC                   )  /* address Potenza attiva del sistema     (parametro OCCP)                          */       
#define ADDR_ACTIVE_POWER_AC_L1_RO              (ADDR_ACTIVE_POWER_AC_RO                + LEN_ACTIVE_POWER_AC_RO                )  /* address potenza attiva fase 1                                        */              
#define ADDR_REACTIVE_POWER_AC_RO               (ADDR_ACTIVE_POWER_AC_L1_RO             + LEN_ACTIVE_POWER_AC_L1_RO             )  /* address Potenza reattiva del sistema   (parametro OCCP)              */       
#define ADDR_TOTAL_ACTIVE_ENERGY_AC_EV_RO       (ADDR_REACTIVE_POWER_AC_RO              + LEN_REACTIVE_POWER_AC_RO              )  /* address Energia attiva del sistema     (parametro OCCP)              */       
#define ADDR_TOTAL_ACTIVE_ENERGY_DC_EV_RO       (ADDR_TOTAL_ACTIVE_ENERGY_AC_EV_RO      + LEN_TOTAL_ACTIVE_ENERGY_AC_EV_RO      )  /* address Energia apparente del sistema  (parametro OCCP)              */       
#define ADDR_TOTAL_REACTIVE_ENERGY_AC_EV_RO     (ADDR_TOTAL_ACTIVE_ENERGY_DC_EV_RO      + LEN_TOTAL_ACTIVE_ENERGY_DC_EV_RO      )  /* address Energia reattiva del sistema   (parametro OCCP)              */       
#define ADDR_TRANSACTION_ACTIVE_ENERGY_AC_EV_RO (ADDR_TOTAL_REACTIVE_ENERGY_AC_EV_RO    + LEN_TOTAL_REACTIVE_ENERGY_AC_EV_RO    )  /* address Energia attiva parziale relativa alla sessione corrente    (parametro OCCP)      */       
#define ADDR_ACTIVE_POWER_AC_L2_RO              (ADDR_TRANSACTION_ACTIVE_ENERGY_AC_EV_RO   + LEN_TRANSACTION_ACTIVE_ENERGY_AC_EV_RO)  /* address potenza attiva fase 2                                 */       
#define ADDR_TRANSACTION_REACTIVE_ENERGY_AC_EV_RO  (ADDR_ACTIVE_POWER_AC_L2_RO          + LEN_ACTIVE_POWER_AC_L2_RO             )  /* address Energia reattiva parziale relativa alla sessione corrente  (parametro OCCP)      */       
#define ADDR_FREQUENCY_SUPPLY_RO                (ADDR_TRANSACTION_REACTIVE_ENERGY_AC_EV_RO + LEN_TRANSACTION_REACTIVE_ENERGY_AC_EV_RO )  /* address Frequenza di rete     (parametro OCCP)                       */       
#define ADDR_SCU_RESERVED4                      (ADDR_FREQUENCY_SUPPLY_RO               + LEN_FREQUENCY_SUPPLY_RO               )  /* address Reserved (usati per stazione DC)                             */       
#define ADDR_DC_RESERVED4_END                   (ADDR_SCU_RESERVED4                     + LEN_RESERVED4_RDD                     )  /* address Reserved for DC system                                       */         

#define ADDR_MAX_CURRENT_ROTATORY_SWITCH_RO     (ADDR_SCU_RESERVED4                     + LEN_RESERVED4_RDD                     )  /* 0x0635 address Corrente impostata nel selettore rotativo             */       
#define ADDR_UNDEFINED_EX_RSC_CURR_RDD          (ADDR_MAX_CURRENT_ROTATORY_SWITCH_RO    + LEN_MAX_CURRENT_ROTATORY_SWITCH_RO    )  /* address Corrente massima di sistema                                  */       
#define ADDR_ACTIVE_POWER_AC_L3_RO              (ADDR_UNDEFINED_EX_RSC_CURR_RDD         + LEN_UNDEFINED_EX_RSC_CURR_RDD         )  /* address potenza attiva fase 3                                        */       
#define ADDR_EMPTY_063A                         (ADDR_ACTIVE_POWER_AC_L3_RO             + LEN_ACTIVE_POWER_AC_L3_RO             )  /* address of a empty register                                          */
#define ADDR_MAX_CURRENT_RESULT_RO              (ADDR_EMPTY_063A                        + LEN_EMPTY_063A                        )  /* address Corrente massima di carica risultante dai vari calcoli e confronti*/       
#define ADDR_TRANSACTION_TIME_RO                (ADDR_MAX_CURRENT_RESULT_RO             + LEN_MAX_CURRENT_RESULT_RO             )  /* address Tempo in secondi, trascorsi dall'inizio della carica         */       
#define ADDR_TRANSACTION_COUNTDOWN_RO           (ADDR_TRANSACTION_TIME_RO               + LEN_TRANSACTION_TIME_RO               )  /* address Tempo, in secondi, rimanenti al completamento della carica   */       
#define ADDR_EV_BATTERY_RO                      (ADDR_TRANSACTION_COUNTDOWN_RO          + LEN_TRANSACTION_COUNTDOWN_RO          )  /* address percentuale della carica della batteria  (parametro OCCP)    */       
#define ADDR_SESSION_ID_RO                      (ADDR_EV_BATTERY_RO                     + LEN_EV_BATTERY_RO                     )  /* address percentuale della carica della batteria  (parametro OCCP)    */       
#define ADDR_EVSE_BOOT_EVENT_RO                 (ADDR_SESSION_ID_RO                     + LEN_SESSION_ID_RO                     )  /* address flag di notifica reset di sistema                            */       
#define ADDR_TOTAL_ACTIVE_ENERGY_AC_GRID_RO     (ADDR_EVSE_BOOT_EVENT_RO                + LEN_EVSE_BOOT_EVENT_RO                )  /* address Energia attiva totale funzione GRID V2G                      */
#define ADDR_TOTAL_REACTIVE_ENERGY_AC_GRID_RO   (ADDR_TOTAL_ACTIVE_ENERGY_AC_GRID_RO    + LEN_TOTAL_ACTIVE_ENERGY_AC_GRID_RO    )  /* address Energia reattiva totale funzione GRID V2G                    */
#define ADDR_TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO   (ADDR_TOTAL_REACTIVE_ENERGY_AC_GRID_RO     + LEN_TOTAL_REACTIVE_ENERGY_AC_GRID_RO       )  /* address Energia attiva della transazione funzione GRID V2G           */
#define ADDR_TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO (ADDR_TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO + LEN_TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO   )  /* address Energia Reattiva della transazione funzione GRID V2G         */
#define ADDR_SCU_RESERVED6                      (ADDR_TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO   + LEN_TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO )  /* address -------------- Fine dei parametri Read-Only si passa a quelli RW --------------  */       
#define ADDR_UID_AUTHORIZATION_RO               (ADDR_SCU_RESERVED6                     + LEN_SCU_RESERVED6                     )  /* address valore UID della card letta                                  */       
#define ADDR_TIME_IN_CHARGE_RO                  (ADDR_UID_AUTHORIZATION_RO              + LEN_UID_AUTHORIZATION_RO              )  /* address valore tempo di carica vera (con passaggio di corrente)      */
#define ADDR_SCU_RESERVED6B                     (ADDR_TIME_IN_CHARGE_RO                 + LEN_TIME_IN_CHARGE_RO                 )  /* address valore UID della card letta                                  */

#define ADDR_CONNECTOR_TYPE_RW                  ((uint16_t)0x0000                       + 0                                     )  /* address Registro per modificare configurazione Hardware              */       
#define ADDR_HWC_FLAGS_RW                       (ADDR_CONNECTOR_TYPE_RW                 + LEN_CONNECTOR_TYPE_RW                 )  /* 1 address Hardware flags per presenza/assenza componenti               */                
#define ADDR_ENERGY_METERS_RW                   (ADDR_HWC_FLAGS_RW                      + LEN_HWC_FLAGS_RW                      )  /* 2 address Modifica indirizzo modbus usato come alias della scheda      */       
#define ADDR_POWER_OUTAGE_HW_RW                 (ADDR_ENERGY_METERS_RW                  + LEN_ENERGY_METERS_RW                  )  /* 3 address Tipo di hardware installato per l'assenza di tensione        */
#define ADDR_CONNECTOR_IDS_RW                   (ADDR_POWER_OUTAGE_HW_RW                + LEN_POWER_OUTAGE_HW_RW                )  /* 4 address Modifica indirizzo modbus usato come alias della scheda      */       
#define ADDR_BOARD_SN_RW                        (ADDR_CONNECTOR_IDS_RW                  + LEN_CONNECTOR_IDS_RW                  )  /* 5 address Numero di serie della stazione                               */       
#define ADDR_PRODUCT_SN_RW                      (ADDR_BOARD_SN_RW                       + LEN_BOARD_SN_RW                       )  /* 13 address Numero di serie del prodotto                                 */       
#define ADDR_MASTER_HARDWARE_TYPE_RW            (ADDR_PRODUCT_SN_RW                     + LEN_PRODUCT_SN_RW                     )  /* 21 address Configurazione master / slave                                */       
#define ADDR_UTC_DATE_TIME_RW                   (ADDR_MASTER_HARDWARE_TYPE_RW           + LEN_MASTER_HARDWARE_TYPE_RW           )  /* 22 address data e ora correnti letti da RTC                             */       
#define ADDR_POWER_MODULE_BRAND_RW              (ADDR_UTC_DATE_TIME_RW                  + LEN_UTC_DATE_TIME_RW                  )  /* 31 address Indica la marca del produttore del caricabatteria (solo DC)  */       
#define ADDR_POWER_MODULE_MODEL_RW              (ADDR_POWER_MODULE_BRAND_RW             + LEN_POWER_MODULE_BRAND_RW             )  /* 32 address Indica la marca del modello del caricabatteria (solo DC)     */       
#define ADDR_POWER_MODULE_N_RW                  (ADDR_POWER_MODULE_MODEL_RW             + LEN_POWER_MODULE_MODEL_RW             )  /* 33 address Indica il numero di moduli installati al sistema  (solo DC)  */       
#define ADDR_EVSE_TM_RW                         (ADDR_POWER_MODULE_N_RW                 + LEN_POWER_MODULE_N_RW                 )  /* 34 address Abilitazione prese e stazione alla ricarica                  */       
#define ADDR_EVSE_OPERATION_MODE_RW             (ADDR_EVSE_TM_RW                        + LEN_EVSE_TM_MODE_RW                   )  /* address In dica la modalità di funzionamento del sistema di ricarica */       
#define ADDR_CHARGE_PROTOCOL_SELECTED_RW        (ADDR_EVSE_OPERATION_MODE_RW            + LEN_EVSE_OPERATION_MODE_RW            )  /* address Indica con quale connettore effettuare la ricarica (solo DC) */       
#define ADDR_DISPLAY_DEFAULT_LANGUAGE_RW        (ADDR_CHARGE_PROTOCOL_SELECTED_RW       + LEN_CHARGE_PROTOCOL_SELECTED_RW       )  /* address Indica la lingua utilizzata dal sistema                      */
#define ADDR_HW_CHECKS1_RW                      (ADDR_DISPLAY_DEFAULT_LANGUAGE_RW       + LEN_DISPLAY_DEFAULT_LANGUAGE_RW       )  /* address Registro per abilitazione errori                             */                                 
#define ADDR_HW_CHECKS2_RW                      (ADDR_HW_CHECKS1_RW                     + LEN_HW_CHECKS1_RW                     )  /* address Registro per abilitazione errori                             */                                 
#define ADDR_HW_ACTUATORS_RW                    (ADDR_HW_CHECKS2_RW                     + LEN_HW_CHECKS2_RW                     )  /* address Registro per la configurazione degli attuatori del sistema   */                                 
#define ADDR_SCU_RESERVED7                      (ADDR_HW_ACTUATORS_RW                   + LEN_HW_ACTUATORS_RW                   )  /* address Imposta la corrente massima DC disponibile nel sistema       */

#define ADDR_MAX_TEMPORARY_CURRENT_RW           (ADDR_SCU_RESERVED7                     + LEN_SCU_RESERVED7                     )  /* address Parametro PID per sistema AC                                 */           
#define ADDR_LEN_EMPTY_0033_RW_RWD              (ADDR_MAX_TEMPORARY_CURRENT_RW          + LEN_MAX_TEMPORARY_CURRENT_RW          )  /* address Imposta la corrente minima di ricarica                       */           
#define ADDR_LED_STRIP_RW                       (ADDR_LEN_EMPTY_0033_RW_RWD             + LEN_EMPTY_0033_RW                     )  /* address Registro utilizzato per impostare la sospensione della carica*/           
#define ADDR_REMOTE_COMMANDS_RW                 (ADDR_LED_STRIP_RW                      + LEN_LED_STRIP_RW                      )  /* address Emulazione stato pressione del pulsante remoto               */           
#define ADDR_ENVIRONMENT_BRIGHTNESS_RW          (ADDR_REMOTE_COMMANDS_RW                + LEN_REMOTE_COMMANDS_RW                )  /* address Valore di luminosità letto dal sensore                       */           
#define ADDR_MIN_POWER_DC_RWD                   (ADDR_ENVIRONMENT_BRIGHTNESS_RW         + LEN_ENVIRONMENT_BRIGHTNESS_RW         )  /* address Indica la distanza rilevata dal sensore                      */           
#define ADDR_UNDEFINED_EX_PRX_MOTION_RWD        (ADDR_MIN_POWER_DC_RWD                  + LEN_MIN_POWER_DC_RWD                  )  /* address Registro flag che indica presenza di movimento rilevata      */           
#define ADDR_MAX_TEMPORARY_POWER_AC             (ADDR_UNDEFINED_EX_PRX_MOTION_RWD       + LEN_UNDEFINED_EX_PRX_MOTION_RWD       )  /* address Parametro per impostare il PWM dei led esterni alla stazione di ricarica RGB     */           
#define ADDR_PM_MODE_RW                         (ADDR_MAX_TEMPORARY_POWER_AC            + LEN_MAX_TEMPORARY_POWER_AC            )  /* address registro utilizzato modalità Power management                */           
#define ADDR_ENABLE_LOG_RW                      (ADDR_PM_MODE_RW                        + LEN_PM_MODE_RW                        )  /* address abilitazione log su SD (solo DC)                             */           
#define ADDR_AUTHORIZATION_FEEDBACK_RW          (ADDR_ENABLE_LOG_RW                     + LEN_ENABLE_LOG_RW                     )  /* address in modalità NET autorizza e controlla la carica              */           
#define ADDR_TIMEZONE_RW                        (ADDR_AUTHORIZATION_FEEDBACK_RW         + LEN_AUTHORIZATION_FEEDBACK_RW         )  /* address time zone rispetto a UTC                                     */           
#define ADDR_MENU_VISIBILITY_RW                 (ADDR_TIMEZONE_RW                       + LEN_TIMEZONE_RW                       )  /* address EX LIM_POWER_AC_RW                                           */     
#define ADDR_TIMEOUT_RANGE1_RW                  (ADDR_MENU_VISIBILITY_RW                + LEN_MENU_VISIBILITY_RW                )  /* address per il valore di partenza del contatore T1                   */           
#define ADDR_TIMEOUT_RANGE2_RW                  (ADDR_TIMEOUT_RANGE1_RW                 + LEN_TIMEOUT_RANGE1_RW                 )  /* address per il valore di partenza del contatore T2                   */           
#define ADDR_PRODUCT_CODE_RW                    (ADDR_TIMEOUT_RANGE2_RW                 + LEN_TIMEOUT_RANGE2_RW                 )  /* address Codice prodotto SCAME                                        */           
#define ADDR_TECN_PRODUCT_CODE_RW               (ADDR_PRODUCT_CODE_RW                   + LEN_PRODUCT_CODE_RW                   )  /* address Codice FAKE prodotto SCAME                                   */ 
#define ADDR_CONNECTOR_N_RW                     (ADDR_TECN_PRODUCT_CODE_RW              + LEN_TECN_PRODUCT_CODE_RW              )  /* address Numero connettore nella EVSE                                 */     
#define ADDR_DISPLAY_LANGUAGES_RW               (ADDR_CONNECTOR_N_RW                    + LEN_CONNECTOR_N_RW                    )  /* address Lingua impostata e lingua di default                         */
#define ADDR_MAX_TYPICAL_CURRENT_RW             (ADDR_DISPLAY_LANGUAGES_RW              + LEN_DISPLAY_LANGUAGES_RW              )  /* address Massima corrente in modalità tipica impostata                */
#define ADDR_MAX_SIMPLIFIED_CURRENT_RW          (ADDR_MAX_TYPICAL_CURRENT_RW            + LEN_MAX_TYPICAL_CURRENT_RW            )  /* address Massima corrente in modalità semplificata                    */
#define ADDR_CHARGE_TIME_RW                     (ADDR_MAX_SIMPLIFIED_CURRENT_RW         + LEN_MAX_SIMPLIFIED_CURRENT_RW         )  /* address Flag per presenza componenti hardware (Wi-Fi, BT...)         */
#define ADDR_CHARGE_MAX_ENERGY_RW               (ADDR_CHARGE_TIME_RW                    + LEN_CHARGE_BY_TIME_RW                 )  /* address Tempo massimo di una carica                                  */
#define ADDR_PM_IMIN_RW                         (ADDR_CHARGE_MAX_ENERGY_RW              + LEN_CHARGE_BY_ENERGY_RW               )  /* address Corrente minima erogabile con funzione Power Management      */
#define ADDR_PM_PMAX_RW                         (ADDR_PM_IMIN_RW                        + LEN_PM_IMIN_RW                        )  /* address Potenza massima erogabile con funzione Power Management      */
#define ADDR_PM_FLAGS_RW                        (ADDR_PM_PMAX_RW                        + LEN_PM_PMAX_RW                        )  /* address Flag di abilitazione funzione Power Management               */
#define ADDR_PM_HPOWER_RW                       (ADDR_PM_FLAGS_RW                       + LEN_PM_FLAGS_RW                       )  /* address Isteresi massima di potenza erogabile Power Management       */
#define ADDR_PM_DSET_RW                         (ADDR_PM_HPOWER_RW                      + LEN_PM_HPOWER_RW                      )  /* address Variazione della potenza in erogazione verso l'EV            */
#define ADDR_PM_DMAX_RW                         (ADDR_PM_DSET_RW                        + LEN_PM_DSET_RW                        )  /* address Valore di isteresi potenza in eccesso erogata dall'EVSE      */     
#define ADDR_PIN_EXTERNAL_ENERGY_METER_RW       (ADDR_PM_DMAX_RW                        + LEN_PM_DMAX_RW                        )  /* address pin energy meter esterno                                     */                
#define ADDR_LIM_MAX_POWER_AC_RW                (ADDR_PIN_EXTERNAL_ENERGY_METER_RW      + LEN_PIN_EXTERNAL_ENERGY_METER_RW      )  /* address max power AC                                      */                
#define ADDR_RESERVED_A                         (ADDR_LIM_MAX_POWER_AC_RW               + LEN_LIM_MAX_POWER_AC_RW               )  /* address reserved for future use                                      */           

#define ADDR_FILE_COMMAND_RW                    ((uint16_t)0x0100                       + 0                                     )  /* address Comando per avviare l'aggiornamento SW                                           */           
#define ADDR_FILE_SIZE_RW                       (ADDR_FILE_COMMAND_RW                   + LEN_FILE_COMMAND_RW                   )  /* address Registro con indicazione dello stato di aggiornamento firmware                   */           
#define ADDR_FILE_PACKET_RW                     (ADDR_FILE_SIZE_RW                      + LEN_FILE_SIZE_RW                      )  /* address last rw register    */           
#define ADDR_END_RW_REGS_WO                     (ADDR_FILE_PACKET_RW                    + LEN_FILE_PACKET_RW                    )  /* address last rw register    */           

/****          definizioni indirizzi per l'ambiente RSE-SINAPSI                          ***************************************************************************************  */
#define ADDR_RSE_IOM_CTRL_REG                   ((uint16_t)0x0800                       + 0                                     ) /* address registro di controllo per SINAPSI-RSE                               */           
#define ADDR_RSE_M2_POT_ATT_IMM_IST_TS          (ADDR_RSE_IOM_CTRL_REG                  + LEN_IOM_CTRL_REG                      ) /* address time stamp potenza attiva immessa istantanea letta dal contatore M2 */           
#define ADDR_RSE_M2_POT_ATT_IMM_IST             (ADDR_RSE_M2_POT_ATT_IMM_IST_TS         + LEN_M2_POT_ATT_IMM_IST_TS             ) /* address  potenza attiva immessa istantanea letta dal contatore M2           */           
#define ADDR_RSE_M2_POT_CONTRATTUALE_TS         (ADDR_RSE_M2_POT_ATT_IMM_IST            + LEN_M2_POT_ATT_IMM_IST                ) /* address time stamp potenza contrattuale del contatore M2                    */           
#define ADDR_RSE_M2_POT_CONTRATTUALE            (ADDR_RSE_M2_POT_CONTRATTUALE_TS        + LEN_M2_POT_CONTRATTUALE_TS            ) /* address potenza contrattuale del contatore M2                               */           
#define ADDR_RSE_M1_POT_CONTRATTUALE_TS         (ADDR_RSE_M2_POT_CONTRATTUALE           + LEN_M2_POT_CONTRATTUALE               ) /* address time stamp potenza contrattuale del contatore M1                    */           
#define ADDR_RSE_M1_POT_CONTRATTUALE            (ADDR_RSE_M1_POT_CONTRATTUALE_TS        + LEN_M1_POT_CONTRATTUALE_TS            ) /* address potenza contrattuale del contatore M1                               */           
#define ADDR_RSE_M1_POT_DISPONIBILE_TS          (ADDR_RSE_M1_POT_CONTRATTUALE           + LEN_M1_POT_CONTRATTUALE               ) /* address time stamp potenza disponibile  del contatore M1                    */           
#define ADDR_RSE_M1_POT_DISPONIBILE             (ADDR_RSE_M1_POT_DISPONIBILE_TS         + LEN_M1_POT_DISPONIBILE_TS             ) /* address potenza disponibile  del contatore M1                               */           
#define ADDR_RSE_M1_POT_ATT_PRE_IST_TS          (ADDR_RSE_M1_POT_DISPONIBILE            + LEN_M1_POT_DISPONIBILE                ) /* address time stamp potenza attiva prelevata istantanea al contatore M1      */           
#define ADDR_RSE_M1_POT_ATT_PRE_IST             (ADDR_RSE_M1_POT_ATT_PRE_IST_TS         + LEN_M1_POT_ATT_PRE_IST_TS             ) /* address potenza attiva prelevata istantanea al contatore M1                 */           
#define ADDR_RSE_M1_POT_ATT_IMM_IST_TS          (ADDR_RSE_M1_POT_ATT_PRE_IST            + LEN_M1_POT_ATT_PRE_IST                ) /* address time stamp potenza attiva immessa istantanea al contatore M1        */           
#define ADDR_RSE_M1_POT_ATT_IMM_IST             (ADDR_RSE_M1_POT_ATT_IMM_IST_TS         + LEN_M1_POT_ATT_IMM_IST_TS             ) /* address potenza attiva immessa istantanea al contatore M1                   */           
#define ADDR_RSE_M1_RES_DISTACCO_TS             (ADDR_RSE_M1_POT_ATT_IMM_IST            + LEN_M1_POT_ATT_IMM_IST                ) /* address time stamp da cui si calcola il tempo di distacco al contatore M1   */           
#define ADDR_RSE_M1_TEMPO_RES_DIST              (ADDR_RSE_M1_RES_DISTACCO_TS            + LEN_M1_DISTACCO_TS                    ) /* address tempo di distacco al contatore M1                                   */           
#define ADDR_RSE_M1_PROF_FASCIA_ORARIA_TS       (ADDR_RSE_M1_TEMPO_RES_DIST             + LEN_M1_TEMPO_RES_DIST                 ) /* address time stamp da cui parte la fascia oraria corrente al contatore M1   */           
#define ADDR_RSE_M1_PROF_FASCIA_ORARIA          (ADDR_RSE_M1_PROF_FASCIA_ORARIA_TS      + LEN_M1_PROF_FASCIA_ORARIA_TS          ) /* address tempo di distacco al contatore M1                                   */           
#define ADDR_RSE_M1_POT_MAX_RIC_TLIM            (ADDR_RSE_M1_PROF_FASCIA_ORARIA         + LEN_M1_PROF_FASCIA_ORARIA             ) /* address potenza massima Pmaxt di ricarica a tempo limitato al contatore M1  */           
#define ADDR_RSE_M1_POT_TEMPO_LIMITE_TS         (ADDR_RSE_M1_POT_MAX_RIC_TLIM           + LEN_M1_POT_MAX_RIC_TLIM               ) /* address time stamp, data-ora fino a cui si può ricaricare a Pmaxt           */           
#define ADDR_RSE_M1_SOSP_RIC_TLIM_TS            (ADDR_RSE_M1_POT_TEMPO_LIMITE_TS        + LEN_M1_POT_TEMPO_LIMITE_TS            ) /* address time stamp, data-ora fino a cui è obbligatorio sospendere la carica */           
#define ADDR_RSE_M1_UNIXTIME_SYNC               (ADDR_RSE_M1_SOSP_RIC_TLIM_TS           + LEN_M1_SOSP_RIC_TLIM_TS               ) /* address sincronizzazione orologio nel formato unixtime                      */           
#define ADDR_RSE_SET_CONFIG_MODE                (ADDR_RSE_M1_UNIXTIME_SYNC              + LEN_M1_UNIXTIME_SYNC                  ) /* address set configuration Bluetooth board SINAPSI                           */ 
#define ADDR_RSE_END_RW_REGS                    (ADDR_RSE_SET_CONFIG_MODE               + LEN_SET_CONFIG_MODE                   ) /* address last RSE rw register                                                */           

/****          definizioni indirizzi per l'ambiente collaudo PEN  (ultimo indirizzo precedente 0x081F)  *******************************************************  */
#define ADDR_PEN_RELE_REG                       ((uint16_t)0x0500                       + 0                                     ) /* address registro di controllo per SINAPSI-RSE                               */           
#define ADDR_PEN_RELE_END                       (ADDR_PEN_RELE_REG                      + LEN_PEN_RELE_RWD                      ) /* address fine mappa per test PEN                                             */           

/****          definizioni indirizzi per simulare energy meter Lovato Ethernet   *******************************************************  */
#define ADDR_EM_LOVATO_V_SYS                    ((uint16_t)0x0550                       + 0                                     ) /* address registro lettura tensione di sistema                                */           
#define ADDR_EM_LOVATO_P_AREA                   (ADDR_EM_LOVATO_V_SYS                   + LEN_EM_LOVATO_V_SYS                   ) /* address registro lettura tensione di fase L2                                */           
#define ADDR_EM_LOVATO_END                      (ADDR_EM_LOVATO_P_AREA                  + LEN_EM_LOVATO_P_AREA                  ) /* address last LOVATO EM rw register                                                */           


/****          definizioni indirizzi per l'ambiente Macchina di collaudo  (ultimo indirizzo precedente 0x50F)  *******************************************************  */
#define ADDR_TM_MEASURED_CURRENT_RW             ((uint16_t)0x510                        + 0                                     ) /* address Corrente misurata dall'EM interno alla macchina di collaudo         */
#define ADDR_TM_MEASURED_VOLTAGE_RW             (ADDR_TM_MEASURED_CURRENT_RW            + LEN_TM_MEASURED_CURRENT_RW            ) /* address Tensione misurata dall'EM interno alla macchina di collaudo         */
#define ADDR_TM_EVSE_READY_RO                   (ADDR_TM_MEASURED_VOLTAGE_RW            + LEN_TM_MEASURED_VOLTAGE_RW            ) /* address Flag SCU pronta a proseguire i test di collaudo                     */
#define ADDR_ADDR_S_CONN_RW                     (ADDR_TM_EVSE_READY_RO                  + LEN_TM_EVSE_READY_RO                  ) /* address Codice di attivazione presa segnato anche nel manuale utente        */
#define ADDR_TM_ADDR_REQ_RW                     (ADDR_ADDR_S_CONN_RW                    + LEN_TM_ADDR_S_CONN_RW                 ) /* address richiesta indirizzamento automatico                                 */
#define ADDR_TM_ADDR_ASS_RW                     (ADDR_TM_ADDR_REQ_RW                    + LEN_TM_ADDR_REQ_RW                    ) /* address asseganzione indirizzamento automatico                              */
#define ADDR_TM_ERROR1_RO                       (ADDR_TM_ADDR_ASS_RW                    + LEN_TM_ADDR_ASS_RW                    ) /* address Codice errori in fase di collaudo                                   */
#define ADDR_TM_UID_MASTER_RW                   (ADDR_TM_ERROR1_RO                      + LEN_ADDR_TM_ERROR1_RO                 ) /* address Codice errori in fase di collaudo                                   */
#define ADDR_TM_UID_USER_RW                     (ADDR_TM_UID_MASTER_RW                  + LEN_TM_UID_MASTER_RW                  ) /* address Codice errori in fase di collaudo                                   */
#define ADDR_TM_MEASURED_CURRENT_L2_RW          (ADDR_TM_UID_USER_RW                    + LEN_TM_UID_USER_RW                    ) /* address Corrente misurata dall'EM interno alla macchina di collaudo L2      */
#define ADDR_TM_MEASURED_VOLTAGE_L2_RW          (ADDR_TM_MEASURED_CURRENT_L2_RW         + LEN_TM_MEASURED_CURRENT_L2_RW         ) /* address Tensione misurata dall'EM interno alla macchina di collaudo L2      */
#define ADDR_TM_MEASURED_CURRENT_L3_RW          (ADDR_TM_MEASURED_VOLTAGE_L2_RW         + LEN_TM_MEASURED_VOLTAGE_L2_RW         ) /* address Corrente misurata dall'EM interno alla macchina di collaudo L3      */
#define ADDR_TM_MEASURED_VOLTAGE_L3_RW          (ADDR_TM_MEASURED_CURRENT_L3_RW         + LEN_TM_MEASURED_CURRENT_L3_RW         ) /* address Tensione misurata dall'EM interno alla macchina di collaudo L3      */
#define ADDR_GET_EEPROM_RW                      (ADDR_TM_MEASURED_VOLTAGE_L3_RW         + LEN_TM_MEASURED_VOLTAGE_L3_RW         ) /* address lettura parametri in EEPROM                                         */
#define ADDR_RESERVED_B                         (ADDR_GET_EEPROM_RW                     + LEN_TM_GET_EEPROM_RW                  ) /* address reserved for future use                                             */


/****          definizioni indirizzi per l'ambiente APP - Wi-Fi  (ultimo indirizzo precedente 0x81FF)  *******************************************************  */
#define ADDR_CONNECTOR_INIT_STATUS_RO           ((uint16_t)0x8200                       + 0                                     ) /* address Stato di attivazione della presa                                    */
#define ADDR_CONNECTOR_OPERATION_STATUS_RO      (ADDR_CONNECTOR_INIT_STATUS_RO          + LEN_CONNECTOR_INIT_STATUS_RO          ) /* address Registro stato IDLE della presa, richiesto da Enrico per ios        */       
#define ADDR_PROCEDURE_RESPONSE_RO              (ADDR_CONNECTOR_OPERATION_STATUS_RO     + LEN_CONNECTOR_OPERATION_STATUS_RO     ) /* address Registro di esito procedura richiesta dalla App                     */
#define ADDR_PM_TOTAL_POWER_RO                  (ADDR_PROCEDURE_RESPONSE_RO             + LEN_PROCEDURE_RESPONSE_RO             ) /* address Energia totale esterna                                              */
#define ADDR_PM_L1_POWER_RO                     (ADDR_PM_TOTAL_POWER_RO                 + LEN_PM_TOTAL_POWER_RO                 ) /* address Energia esterna fase 1                                              */
#define ADDR_PM_L2_POWER_RO                     (ADDR_PM_L1_POWER_RO                    + LEN_PM_L1_POWER_RO                    ) /* address Energia esterna fase 2                                              */
#define ADDR_PM_L3_POWER_RO                     (ADDR_PM_L2_POWER_RO                    + LEN_PM_L2_POWER_RO                    ) /* address Energia esterna fase 3                                              */
#define ADDR_APP_LOGIN_USER_TYPE_RO             (ADDR_PM_L3_POWER_RO                    + LEN_PM_L3_POWER_RO                    ) /* address Tipologia di utente che ha fatto il login                           */
#define ADDR_CONNECTOR_CHECK_ACTIV_KEY_RW       (ADDR_APP_LOGIN_USER_TYPE_RO            + LEN_APP_LOGIN_USER_TYPE_RO            ) /* address Controllo codice di attivazione manuale utente                      */
#define ADDR_CONNECTOR_NAME_RW                  (ADDR_CONNECTOR_CHECK_ACTIV_KEY_RW      + LEN_CONNECTOR_CHECK_ACTIV_KEY_RW      ) /* address Nome della presa scelto dall'utente                                 */
#define ADDR_CONNECTOR_PIN_RW                   (ADDR_CONNECTOR_NAME_RW                 + LEN_CONNECTOR_NAME_RW                 ) /* address Pin della presa scelto dall'utente in fase di inizializzazione      */
#define ADDR_ROUTER_NET_SSID_RW                 (ADDR_CONNECTOR_PIN_RW                  + LEN_CONNECTOR_PIN_RW                  ) /* address SSID della rete del router domestico                                */
#define ADDR_ROUTER_NET_PASSWORD_RW             (ADDR_ROUTER_NET_SSID_RW                + LEN_ROUTER_NET_SSID_RW                ) /* address Password della rete del router domestico                            */
#define ADDR_CONNECTOR_ROUTER_IP_RW             (ADDR_ROUTER_NET_PASSWORD_RW            + LEN_ROUTER_NET_PASSWORD_RW            ) /* address Indirizzo IP modulo nella rete del router domestico                 */
#define ADDR_PROCEDURE_REQUEST_RW               (ADDR_CONNECTOR_ROUTER_IP_RW            + LEN_CONNECTOR_ROUTER_IP_RW            ) /* address Registro per richiesta procedura dalla App                          */
#define ADDR_SCHEDULE_FLAG1_RW                  (ADDR_PROCEDURE_REQUEST_RW              + LEN_PROCEDURE_REQUEST_RW              ) /* address Flag attivazione schedulazione 1                                    */
#define ADDR_SCHEDULE_START1_RW                 (ADDR_SCHEDULE_FLAG1_RW                 + LEN_SCHEDULE_FLAG1_RW                 ) /* address Ora inizio carica schedulazione 1                                   */
#define ADDR_SCHEDULE_STOP1_RW                  (ADDR_SCHEDULE_START1_RW                + LEN_SCHEDULE_START1_RW                ) /* address Ora fine carica schedulazione 1                                     */
#define ADDR_SCHEDULE_POWER1_RW                 (ADDR_SCHEDULE_STOP1_RW                 + LEN_SCHEDULE_STOP1_RW                 ) /* address massima potenza schedulazione 1                                     */                
#define ADDR_SCHEDULE_FLAG2_RW                  (ADDR_SCHEDULE_POWER1_RW                + LEN_SCHEDULE_POWER1_RW                ) /* address Flag attivazione schedulazione 2                                    */
#define ADDR_SCHEDULE_START2_RW                 (ADDR_SCHEDULE_FLAG2_RW                 + LEN_SCHEDULE_FLAG2_RW                 ) /* address Ora inizio carica schedulazione 2                                   */
#define ADDR_SCHEDULE_STOP2_RW                  (ADDR_SCHEDULE_START2_RW                + LEN_SCHEDULE_START2_RW                ) /* address Ora fine carica schedulazione 2                                     */
#define ADDR_SCHEDULE_POWER2_RW                 (ADDR_SCHEDULE_STOP2_RW                 + LEN_SCHEDULE_STOP2_RW                 ) /* address massima potenza schedulazione 2                                     */                
#define ADDR_SCHEDULE_FLAG3_RW                  (ADDR_SCHEDULE_POWER2_RW                + LEN_SCHEDULE_POWER2_RW                ) /* address Flag attivazione schedulazione 3                                    */
#define ADDR_SCHEDULE_START3_RW                 (ADDR_SCHEDULE_FLAG3_RW                 + LEN_SCHEDULE_FLAG3_RW                 ) /* address Ora inizio carica schedulazione 3                                   */
#define ADDR_SCHEDULE_STOP3_RW                  (ADDR_SCHEDULE_START3_RW                + LEN_SCHEDULE_START3_RW                ) /* address Ora fine carica schedulazione 3                                     */
#define ADDR_SCHEDULE_POWER3_RW                 (ADDR_SCHEDULE_STOP3_RW                 + LEN_SCHEDULE_STOP3_RW                 ) /* address massima potenza schedulazione 3                                     */                
#define ADDR_SCHEDULE_FLAG4_RW                  (ADDR_SCHEDULE_POWER3_RW                + LEN_SCHEDULE_POWER3_RW                ) /* address Flag attivazione schedulazione 4                                    */
#define ADDR_SCHEDULE_START4_RW                 (ADDR_SCHEDULE_FLAG4_RW                 + LEN_SCHEDULE_FLAG4_RW                 ) /* address Ora inizio carica schedulazione 4                                   */
#define ADDR_SCHEDULE_STOP4_RW                  (ADDR_SCHEDULE_START4_RW                + LEN_SCHEDULE_START4_RW                ) /* address Ora fine carica schedulazione 4                                     */
#define ADDR_SCHEDULE_POWER4_RW                 (ADDR_SCHEDULE_STOP4_RW                 + LEN_SCHEDULE_STOP4_RW                 ) /* address massima potenza schedulazione 4                                     */                
#define ADDR_CONNECTOR_CONNECTION_STATUS_RO     (ADDR_SCHEDULE_POWER4_RW                + LEN_SCHEDULE_POWER4_RW                ) /* address Connector connection status                                         */
#define ADDR_MAX_POWER_RO                       (ADDR_CONNECTOR_CONNECTION_STATUS_RO    + LEN_CONNECTOR_CONNECTION_STATUS_RO    ) /* address Massima potenza stazione per tachimetro app                         */                      
#define ADDR_RANDOM_DELAY_FLAG_RW               (ADDR_MAX_POWER_RO                      + LEN_MAX_POWER_RO                      ) /* address abilitazione/disabilitazione ritardo random schedulazioni           */
#define ADDR_UID_AUTHORIZATION_APP_RW           (ADDR_RANDOM_DELAY_FLAG_RW              + LEN_RANDOM_DELAY_FLAG_RW              ) /* address uid autorizzazione da app wifi                                      */        
#define ADDR_BT_SINAPSI_STATUS_RW               (ADDR_UID_AUTHORIZATION_APP_RW          + LEN_UID_AUTHORIZATION_APP_RW          ) /* address stato del bluetooth Sinapsi                                         */                
#define ADDR_FW_UPDATE_NAME_RW                  (ADDR_BT_SINAPSI_STATUS_RW              + LEN_BT_SINAPSI_STATUS_RW              ) /* address fw update name                                                      */
#define ADDR_FW_UPDATE_LEN_RW                   (ADDR_FW_UPDATE_NAME_RW                 + LEN_FW_UPDATE_NAME_RW                 ) /* address fw update length                                                    */
#define ADDR_FW_UPDATE_STATUS_RO                (ADDR_FW_UPDATE_LEN_RW                  + LEN_FW_UPDATE_LEN_RW                  ) /* address reserved for future use                                             */
#define ADDR_EVSE_POWER_MODE_RO                 (ADDR_FW_UPDATE_STATUS_RO               + LEN_FW_UPDATE_STATUS_RO               ) /* address for evse power mode                                                 */
#define ADDR_RESERVED_C                         (ADDR_EVSE_POWER_MODE_RO                + LEN_EVSE_POWER_MODE_RO                ) /* address reserved for future use                                             */

#define ADDR_UNDEF                              ((uint16_t)0xFFFF)                                                                /* address   undefined (when we use the index of the register)                 */

#define UID_AUTHORIZATION_BY_APP      0xFD

typedef __packed struct
{
  uint8_t         mfwVer[LEN_BOARD_FW_VERSION_RO * 2];                          /* Registro BOARD_FW_VERSION_RO v18b Modbus                     */
  uint8_t         rfdVer[LEN_MIFARE_FW_VERSION_RO * 2];                         /* Registro MIFARE_FW_VERSION_RO v18b Modbus                    */
  uint8_t         devSn[LEN_BOARD_SN_RO * 2];                                   /* Registro BOARD_SN_RO v18b Modbus                             */
  uint8_t         plcVer[LEN_PLC_FW_VERSION_RO * 2];                            /* Registro PLC_FW_VERSION_RO v18b Modbus                       */
  uint8_t         plcMac[LEN_PLC_MAC_ADDRESS_RO * 2];                           /* Registro PLC_MAC_ADDRES_RO v18b Modbus                       */
  uint8_t         hwRev[LEN_HW_REVISION_RO * 2];                                /* Registro HW_REVISION_RO v18b Modbus                          */
  uint8_t         macWifi[LEN_WIFI_MAC_ADDRESS_RO * 2];                         /* Registro WIFI_MAC_ADDRESS_RO v18b Modbus                     */        
  uint8_t         pwrSn[LEN_POWER_MODULE_SN_RO * 2];                            /* Registro POWER_MODULE_SN_RO v18b Modbus                      */
  uint8_t         macBle[LEN_BLE_MAC_ADDRESS_RO * 2];                           /* Registro BLE_MAC_ADDRESS_RO v18b Modbus                      */
  uint8_t         prodSn[LEN_PRODUCT_SN_RO * 2];                                /* Registro PRODUCT_SN_RO v18b Modbus                           */
  uint8_t         prodCode[LEN_PRODUCT_CODE_RO * 2];                            /* Registro PRODUCT_CODE_RO v18b Modbus                         */
  uint8_t         bootfwVer[LEN_BOOT_FW_VERSION_RO * 2];                        /* Registro BOOT CODE VERSION_RO v18b Modbus                    */
  uint16_t        modbusVersion;                                                /* Registro versione modbus                                     */
} scuMapRegInfoVer_st;

typedef __packed struct
{
  uint32_t        ntfPresences;                                                 /* Registro NOTIFY_EVSE_PRESENCE_RO v18b Modbus                 */                                                     
  uint32_t        ntfChangeRo;                                                  /* Registro NOTIFY_EVSE_CHANGE_RO v18b Modbus                   */
  uint16_t        ntfErr1;                                                      /* Registro EVSE_ERROR1_RO v18b Modbus                          */
  uint16_t        ntfErr2;                                                      /* Registro EVSE_ERROR2_RO v18b Modbus                          */
  uint16_t        ntfChangeRegRo[SCU_NUM];                                      /* Registro EVSE_CHANGE_REGISTERS_RO v18b Modbus                */        
} scuMapRegNotify_st;

typedef __packed struct
{
  uint16_t        ntfSktEvent;                                                  /* Registro EVSE_EVENT_FLAGS_RO v18b Modbus                     */
  uint16_t        ntfChgStat;                                                   /* Registro EVSE_CHARGE_STATUS_RO v18b Modbus                   */                                        
  int32_t         tempSys;                                                      /* Registro TEMPERATURE_SYSTEM_RO v18b Modbus                   */
  uint16_t        reserved3DC[LEN_RESERVED3_RDD];                               /* Registri solo per DC                                         */
  uint32_t        mtVsys;                                                       /* Registro VOLTAGE_AC_RO v18b Modbus                           */
  uint32_t        mtPh1Cur;                                                     /* Registro CURRENT_AC_L1_RO v18b Modbus                        */        
  uint32_t        mtPh2Cur;                                                     /* Registro CURRENT_AC_L2_RO v18b Modbus                        */
  uint32_t        mtPh3Cur;                                                     /* Registro CURRENT_AC_L3_RO v18b Modbus                        */
  uint32_t        mtMaxPowerStation;                                            /* Registro ACTIVE_POWER_DC_RO v22  Modbus Pmax stazione        */
  uint32_t        mtSpPower;                                                    /* Registro ACTIVE_POWER_AC_RO v18b Modbus                      */
  uint32_t        mtSpPowerL1;                                                  /* Registro potenza attiva fase 1 v24 Modbus                    */                                                      
  uint32_t        mtSqPower;                                                    /* Registro REACTIVE_POWER_AC_RO v18b Modbus                    */
  uint32_t        mtTpEnrg;                                                     /* Registro TOTAL_ACTIVE_ENERGY_AC_EV_RO v18b Modbus            */
  uint32_t        mtSysCur;                                                     /* Registro CURRENT_AC_SYS_RO v22 Modbus                        */
  uint32_t        mtTqEnrg;                                                     /* Registro TOTAL_REACTIVE_ENERGY_ENERGY_RO v18b Modbus         */
  uint32_t        mtTppEnrg;                                                    /* Registro TRANSACTION_ACTIVE_ENERGY_AC_EV_RO v18b Modbus      */
  uint32_t        mtSpPowerL2;                                                  /* Registro potenza attiva fase 3 v24 Modbus                    */                                                      
  uint32_t        mtTqpEnrg;                                                    /* Registro TRANSACTION_REACTIVE_ENERGY_AC_EV_RO v18b Modbus    */
  uint32_t        mtFreq;                                                       /* Registro FREQUENCY_SUPPLY_RO v18b Modbus                     */                                                       
  uint16_t        reserved4DC[LEN_RESERVED4_RDD];                               /* Registri solo per DC v18b Modbus                             */                               
  uint16_t        rswCurr;                                                      /* Registro MAX_CURRENT_ROTATORY_SWITCH_RO v18b Modbus          */
  uint32_t        exRscCurr;                                                    /* Registro EX_RSC_CURR_RO migrato in RW v18b Modbus            */
  uint32_t        mtSpPowerL3;                                                  /* Registro potenza attiva fase 3 v24 Modbus                    */
  uint16_t        empty_063A;
  uint16_t        pwrCurr;                                                      /* Registro MAX_POWER_RESULT_RO v24 Modbus                      */
  uint32_t        evSessionT;                                                   /* Registro TRANSACTION_TIME_RO v18b Modbus                     */
  uint32_t        evRemainT;                                                    /* Registro TRANSACTION_COUNTDOWN_RO v18b Modbus                */        
  uint16_t        evSoc;                                                        /* Registro EV_BATTERY_RO v18b Modbus                           */
  uint32_t        evSessionId;                                                  /* Registro SESSION_ID_RO v18b Modbus                           */
  uint16_t        evRstFlag;                                                    /* Registro EVSE_BOOT_EVENT_RO v18b Modbus                      */
  uint32_t        totActEnrgGrid;                                               /* Registro TOTAL_ACTIVE_ENERGY_AC_GRID_RO v18b Modbus          */
  uint32_t        totReactEnrgGrid;                                             /* Registro TOTAL_REACTIVE_ENERGY_AC_GRID_RO v18b Modbus        */
  uint32_t        transActEnrgGrid;                                             /* Registro TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO v18b Modbus    */
  uint32_t        transReactEnrgGrid;                                           /* Registro TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO v18b Modbus  */
  uint16_t        reservedDC6[LEN_SCU_RESERVED6];                               /* Registro TOTAL_ENERGY_DC_GRID_RO e TRANS_ENERGY_DC_GRID_RO   */
  uint8_t         uidAuth[LEN_UID_AUTHORIZATION_RO * 2];                        /* Registro UID_AUTHORIZATION_RO v18b Modbus                    */
  uint32_t        timeInCharge;                                                 /* Registro TIME_IN_CHARGE_RO v24 Modbus                        */
} scuMapRegStatusMeas_st;


typedef __packed struct
{
  uint16_t        connType;                                                     /* Registro CONNECTOR_TYPE_RW v18b Modbus                       */
  uint16_t        hwcFlags;                                                     /* Registro HWC_FLAGS_RW v18b Modbus                            */
  uint16_t        mtType;                                                       /* Registro ENERGY_METERS_RW v18b Modbus                    */
  uint16_t        pwrOutage;                                                    /* Registro POWER_OUTAGE_RW v18b Modbus                         */
  uint16_t        devAlias;                                                     /* Registro CONNECTOR_IDS_RW v18b Modbus                             */
  uint8_t         devSn[LEN_BOARD_SN_RW  * 2];                                  /* Registro BOARD_SN_RW v18b Modbus                             */
  uint8_t         prdSn[LEN_PRODUCT_SN_RW * 2];                                 /* Registro PRODUCT_SN_RW v18b Modbus                           */
  uint16_t        mstCfg;                                                       /* Registro MASTER_HW_TYPE_RW v18b Modbus                       */
  uint8_t         rtcInf[LEN_UTC_DATE_TIME_RW * 2];                             /* Registro UTC_DATE_TIME_RW v18b Modbus                        */
  uint16_t        pwrVendor;                                                    /* Registro POWER_MODULE_BRAND_RW v18b Modbus                   */
  uint16_t        pwrModel;                                                     /* Registro POWER_MODULE_MODEL_RW v18b Modbus                   */        
  uint16_t        pwrModules;                                                   /* Registro POWER_MODULE_N_RW v18b Modbus                       */
  uint16_t        tmMode;                                                       /* Registro EVSE_TM_MODE_RW v18b Modbus                         */
  uint16_t        evseMod;                                                      /* Registro EVSE_OPERATION_MODE_RW v18b Modbus                  */        
  uint16_t        cableChgSel;    /* solo DC */                                 /* Registro CHARGE_PROTOCOL_SELECTED_RW v18b Modbus             */        
  uint16_t        defDispLng;                                                   /* Registro EX_DISPLAY_LANGUAGES_RW v18b Modbus                 */
  uint16_t        hwChecks1;                                                    /* Registro HW_CHECKS1_RW v18b Modbus                           */        
  uint16_t        hwChecks2;                                                    /* Registro HW_CHECKS2_RW v18b Modbus                           */
  uint16_t        hwActuators;                                                  /* Registro HW_ACTUATORS_RW v18b Modbus                         */
  uint16_t        res7DC[LEN_SCU_RESERVED7];                                    /* Registro UNDEFINED_EX_SCU_RESERVED7 v18b Modbus              */
  uint32_t        maxTempCurr;                                                  /* Registro MAX_TEMPORARY_CURRENT_RW v18b Modbus                */                                                       
  uint16_t        empty_0033;                                                   /* Registro UNDEFINED_EX_LIM_LOW_CURR_RW v18b Modbus            */
  uint16_t        ledStrip;                                                     /* Registro LED_STRIP_RWD v24 Modbus                            */
  uint16_t        rmtCmd;                                                       /* Registro REMOTE_COMMANDS_RW v18b Modbus                      */
  uint16_t        alsBright;                                                    /* Registro ENVIRONMENT_BRIGHTNESS_RW v18b Modbus               */
  uint32_t        exPrxDist;                                                    /* Registro UNDEFINED_EX_PRX_DIST_RW v18b Modbus                */
  uint16_t        exPrxMotion;                                                  /* Registro UNDEFINED_EX_PRX_MOTION_RW v18b Modbus              */
  uint32_t        maxTempPowerAc;                                               /* Registro UNDEFINED_EX_LED_EXT_RW v18b Modbus                 */                                       
  uint16_t        pmMode;                                                       /* Registro PM_MODE_RW v22 Modbus                               */
  uint16_t        logEna;                                                       /* Registro ENABLE_LOG_RW v18b Modbus                           */
  uint16_t        authLnk;                                                      /* Registro AUTHORIZATION_FEEDBACK_RW v18b Modbus               */
  uint16_t        rtcTimeZone;                                                  /* Registro TIMEZONE_RW v18b Modbus                             */        
  uint16_t        menuVisible;                                                  /* Registro MENU_VISIBILITY_RW v18b Modbus                      */
  uint16_t        counter_T1;                                                   /* Registro TIMEOUT_RANGE1_RW v18b Modbus                       */
  uint16_t        counter_T2;                                                   /* Registro TIMEOUT_RANGE2_RW v18b Modbus                       */
  uint8_t         prdCode[LEN_PRODUCT_CODE_RW * 2];                             /* Registro PRODUCT_CODE_RW v18b Modbus                         */
  uint8_t         fakePrdCode[LEN_TECN_PRODUCT_CODE_RW * 2];                    /* Registro TECN_PRODUCT_CODE_RW v18b Modbus                    */
  uint16_t        connNumb;                                                     /* Registro CONNECTOR_N_RW v18b Modbus                          */
  uint32_t        availDispLng;                                                 /* Registro DISPLAY_LANGUAGES_RW v18b Modbus                    */
  uint16_t        maxTypCurr;                                                   /* Registro MAX_TYPICAL_CURRENT_RW v18b Modbus                  */
  uint16_t        maxSimplCurr;                                                 /* Registro MAX_SIMPLIFIED_CURRENT_RW v18b Modbus               */
  uint16_t        chgTime;                                                      /* Registro CHARGE_TIME_RW v18b Modbus                          */
  uint16_t        chgEnrg;                                                      /* Registro CHARGE_MAX_ENERGY_RW v18b Modbus                    */
  uint16_t        pmImin;                                                       /* Registro PM_IMIN_RW v18b Modbus                              */
  uint16_t        pmPmax;                                                       /* Registro PM_PMAX_RW v18b Modbus                              */
  uint16_t        pmFlags;                                                      /* Registro PM_FLAGS_RW v18b Modbus                             */
  uint16_t        pmHpower;                                                     /* Registro PM_HPOWER_RW v18b Modbus                            */
  uint16_t        pmDset;                                                       /* Registro PM_DSET_RW v18b Modbus                              */        
  uint16_t        pmDmax;                                                       /* Registro PM_DMAX_RW v18b Modbus                              */
  uint16_t        pmEmex;                                                       /* Registro PIN_EXTERNAL_ENERGY_METER_RW v21.3 Modbus           */                                
  uint32_t        limMaxPowerAc;                                                /* Registro LIM_MAX_POWER_AC_RW v24 Modbus                      */
} scuSetRegister_st;

#ifdef MODBUS_TCP_EM_LOVATO
typedef __packed struct
{
  uint16_t        sysVoltage;                                                   /* Registro versione modbus                                     */
  uint16_t        socketActivePower[SCU_NUM][3];                                /* Registro potenze attive per le possibili 16 prese trifase    */
} scuMapRegLovatoEmSim_st;
#endif

typedef __packed struct
{
  uint16_t        fileCommand;                                                       /* Registro FW_UPDATE_RW v18b Modbus                            */        
  uint32_t        fileSize;                                                          /* Registro FW_UPDATE_EVENT_RW v18b Modbus                      */  
  uint8_t         commandRx;      
  uint8_t         filesizeRx;      
} scuSetRegFwUpd_st;


/* MAPPA REGISTRI MACCHINA DI COLLAUDO */
typedef __packed struct
{
  uint16_t        tmMeasCurr;                                                   /* Registro TM_MEASURED_CURRENT_RW v18b Modbus                  */ 
  uint16_t        tmMeasVolt;                                                   /* Registro TM_MEASURED_VOLTAGE_RW v18b Modbus                  */ 
  uint16_t        tmCommand;                                                    /* Registro TM_COMMAND_RW v25 Modbus                            */ 
  uint16_t        tmAddrSconnM;                                                 /* Registro ADDR_ADDR_S_CONN_RW                                 */ 
  uint16_t        tmAddrReq;                                                    /* Registro ADDR_TM_ADDR_REQ_RW v24 Modbus                      */ 
  uint16_t        tmAddrAss;                                                    /* Registro ADDR_TM_ADDR_ASS_RW v24 Modbus                      */ 
  uint16_t        tmError1InTest;                                               /* Registro TM_ERROR1_IN_TEST_RO v25 Modbus                     */ 
  uint8_t         uidMaster[LEN_TM_UID_MASTER_RW * 2];                          /* Registro TM_UID_MASTER_RW                                    */ 
  uint8_t         uidUser[LEN_TM_UID_USER_RW * 2];                              /* Registro TM_UID_USER_RW                                      */ 
  uint16_t        tmMeasCurrL2;                                                 /* Registro TM_MEASURED_CURRENT_RW L2 v24 Modbus                */ 
  uint16_t        tmMeasVoltL2;                                                 /* Registro TM_MEASURED_VOLTAGE_RW L2 v24 Modbus                */ 
  uint16_t        tmMeasCurrL3;                                                 /* Registro TM_MEASURED_CURRENT_RW L3 v24 Modbus                */ 
  uint16_t        tmMeasVoltL3;                                                 /* Registro TM_MEASURED_VOLTAGE_RW L3 v24 Modbus                */ 
  uint16_t        tmGetEeprom;                                                  /* Registro ADDR_GET_EEPROM_RW per lettura EEPROM               */ 
} tmMapRegister_st;


/* MAPPA REGISTRI APP - WIFI (RW) */
typedef __packed struct
{
  uint16_t        connInitStat;                                                 /* Registro CONNECTOR_INIT_STATUS_RO v19.2 Modbus               */
  uint16_t        connIdleStat; /* DO NOT USE! It's used by iOS app Scame E-Mobility Registro CONNECTOR_OPERATION_STATUS_RO v19.2 Modbus        */        
  uint8_t         procResp[LEN_PROCEDURE_RESPONSE_RO * 2];                      /* Registro PROCEDURE_RESPONSE_RO v19.2 Modbus                  */
  uint32_t        pmTotPwr;                                                     /* Registro PM_TOTAL_POWER_RO v19.2 Modbus                      */
  uint32_t        pmL1Pwr;                                                      /* Registro PM_L1_POWER_RO v19.2 Modbus                         */
  uint32_t        pmL2Pwr;                                                      /* Registro PM_L2_POWER_RO v19.2 Modbus                         */
  uint32_t        pmL3Pwr;                                                      /* Registro PM_L3_POWER_RO v19.2 Modbus                         */
  uint16_t        userLogin;                                                    /* Login fatto da utente o da installatore                      */
  uint8_t         connActivKey[LEN_CONNECTOR_CHECK_ACTIV_KEY_RW * 2];           /* Registro CONNECTOR_CHECK_ACTIV_KEY_RW v19.2 Modbus           */
  uint8_t         connName[LEN_CONNECTOR_NAME_RW * 2];                          /* Registro CONNECTOR_NAME_RW v19.2 Modbus                      */
  uint8_t         connPin[LEN_CONNECTOR_PIN_RW * 2];                            /* Registro CONNECTOR_PIN_RW v19.2 Modbus                       */
  uint8_t         RoutSSID[LEN_ROUTER_NET_SSID_RW * 2];                         /* Registro ROUTER_NET_SSID_RW v19.2 Modbus                     */
  uint8_t         RoutPass[LEN_ROUTER_NET_PASSWORD_RW * 2];                     /* Registro ROUTER_NET_PASSWORD_RW v19.2 Modbus                 */
  uint8_t         RoutIP[LEN_CONNECTOR_ROUTER_IP_RW * 2];                       /* Registro CONNECTOR_ROUTER_IP_RW v19.2 Modbus                 */
  uint16_t        procReq;                                                      /* Registro PROCEDURE_REQUEST_RW v19.2 Modbus                   */
  uint16_t        schFlag1;                                                     /* Registro SCHEDULE_FLAG1_RW v19.2 Modbus                      */
  uint16_t        schStart1;                                                    /* Registro SCHEDULE_START1_RW v19.2 Modbus                     */
  uint16_t        schStop1;                                                     /* Registro SCHEDULE_STOP1_RW v19.2 Modbus                      */
  uint32_t        schPower1;                                                    /* Registro SCHEDULE_POWER1_RW v19.2 Modbus                     */
  uint16_t        schFlag2;                                                     /* Registro SCHEDULE_FLAG2_RW v19.2 Modbus                      */
  uint16_t        schStart2;                                                    /* Registro SCHEDULE_START2_RW v19.2 Modbus                     */
  uint16_t        schStop2;                                                     /* Registro SCHEDULE_STOP2_RW v19.2 Modbus                      */
  uint32_t        schPower2;                                                    /* Registro SCHEDULE_POWER2_RW v19.2 Modbus                     */
  uint16_t        schFlag3;                                                     /* Registro SCHEDULE_FLAG3_RW v19.2 Modbus                      */
  uint16_t        schStart3;                                                    /* Registro SCHEDULE_START3_RW v19.2 Modbus                     */
  uint16_t        schStop3;                                                     /* Registro SCHEDULE_STOP3_RW v19.2 Modbus                      */
  uint32_t        schPower3;                                                    /* Registro SCHEDULE_POWER3_RW v19.2 Modbus                     */
  uint16_t        schFlag4;                                                     /* Registro SCHEDULE_FLAG4_RW v19.2 Modbus                      */
  uint16_t        schStart4;                                                    /* Registro SCHEDULE_START4_RW v19.2 Modbus                     */
  uint16_t        schStop4;                                                     /* Registro SCHEDULE_STOP4_RW v19.2 Modbus                      */
  uint32_t        schPower4;                                                    /* Registro SCHEDULE_POWER4_RW v19.2 Modbus                     */
  uint16_t        connectStatus;                                                /* Registro CONNECTOR_CONNECTION_STATUS_RO v19.2 Modbus         */                
  uint32_t        maxPower;                                                     /* Registro MAX_POWER_RO v20 Modbus                             */ 
  uint16_t        randomDelay;                                                  /* Registro RANDOM_DELAY_FLAG_RW v20.2 Modbus                   */                
  uint8_t         uidAuthApp[LEN_UID_AUTHORIZATION_APP_RW * 2];                 /* Registro UID_AUTHORIZATION_APP_RW v21 Modbus                 */        
  uint16_t        btSinapsiStatus;                                              /* Registro BT_SINAPSI_STATUS_RW v21.3 Modbus                   */
  uint8_t         fwUpdateName[LEN_FW_UPDATE_NAME_RW * 2];                      /* Registro FW_UPDATE_NAME_RW v21.3 Modbus                      */                        
  uint32_t        fwUpdateLen;                                                  /* Registro FW_UPDATE_LEN_RW v21.3 Modbus                       */
  uint16_t        fwUpdateStatus;                                               /* Registro FW_UPDATE_STATUS_RO v21.3 Modbus                    */
  uint16_t        evsePwrMode;                                                  /* Registro EVSE_POWER_MODE_RO v21.3 Modbus                       */
} appMapRwRegister_st;

/* EXCHANGE AREA FORMAT: this structure data is put inside the exchange area by the SCU and used by APP during the login phase  */
typedef __packed struct
{
  uint16_t        rswCurr;                                                      /* Registro MAX_CURRENT_ROTATORY_SWITCH_RO v24 Modbus       */
  uint16_t        evsePwrMode;                                                  /* Registro EVSE_POWER_MODE_RO v24 Modbus                   */
  uint32_t        maxPower;                                                     /* Registro MAX_POWER_RO v24 Modbus                         */ 
  uint16_t        maxTypCurr;                                                   /* Registro MAX_TYPICAL_CURRENT_RO v24 Modbus               */
  uint16_t        evseMod;                                                      /* Registro EVSE_OPERATION_MODE_RO v24 Modbus               */        
  uint8_t         mfwVer[LEN_BOARD_FW_VERSION_RO * 2];                          /* Registro BOARD_FW_VERSION_RO v24 Modbus                  */
  uint8_t         rfdVer[LEN_MIFARE_FW_VERSION_RO * 2];                         /* Registro MIFARE_FW_VERSION_RO v24 Modbus                 */
  uint16_t        mtType;                                                       /* Registro ENERGY_METERS_RO v24 Modbus                     */
  uint16_t        connectStatus;                                                /* Registro CONNECTOR_CONNECTION_STATUS_RO v24 Modbus       */                
  uint8_t         RoutSSID[LEN_ROUTER_NET_SSID_RW * 2];                         /* Registro ROUTER_NET_SSID_RW v24 Modbus                   */
  uint16_t        schFlag1[20];                                                 /* Registro SCHEDULE_FLAG1_RO v24 Modbus                    */
  uint16_t        menuVisible;                                                  /* Registro MENU_VISIBILITY_RO v24 Modbus                   */
  uint16_t        pmImin;                                                       /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmPmax;                                                       /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmFlags;                                                      /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmHpower;                                                     /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmDset;                                                       /* Registro PM_PARAMETERS_RO v24 Modbus                     */        
  uint16_t        pmDmax;                                                       /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmMode;                                                       /* Registro PM_MODE_RO v24 Modbus                           */
  uint16_t        hwChecks1;                                                    /* Registro HW_CHECKS1_RO v24 Modbus                        */        
  uint16_t        hwChecks2;                                                    /* Registro HW_CHECKS2_RO v24 Modbus                        */
  uint16_t        hwActuators;                                                  /* Registro HW_ACTUATORS_RO v24 Modbus                      */
} appMapRoRegister_st;

typedef __packed struct
{
  uint16_t        startAddr;
  uint16_t        endAddr;
} addrLimits_st;

typedef __packed struct
{
  addrLimits_st   inventoryData;
  addrLimits_st   notifyData;
  addrLimits_st   statusData;
} infoAddr_st;


/* MAPPA REGISTRI READ ONLY */
typedef __packed struct
{
  scuMapRegInfoVer_st     scuMapRegInfoVer;                                             // struttura che contiene informazioni sulle versioni HW e SW Start 0x0300
  scuMapRegNotify_st      scuMapRegNotify;                                              // struttura per i registri di notifica                       Start 0x0400
  scuMapRegStatusMeas_st  scuMapRegStatusMeas;                                          // struttura per i registri di status e misure                Start 0x0600
  uint8_t                 rfdUid[LEN_UID_AUTHORIZATION_RO * 2];                         // struttura per i registro di info suUID carta RFID          Start 0x0650       
} scuRoMapRegister_st;


/* MAPPA REGISTRI READ/WRITE */
typedef __packed struct
{
  scuSetRegister_st     scuSetRegister;                                                 // struttura che contiene informazioni di settings            Start 0x0000
  uint8_t               reserved_A[(uint16_t)0x100 - sizeof(scuSetRegister_st)];        // spare area 
  scuSetRegFwUpd_st     scuSetRegFwUpd;                                                 // struttura che contiene informazioni per Fw upgrade         Start 0x0100
  rseSetReg_st          rseSetReg;                                                      // struttura che contiene informazioni RSE-SINAPSI            Start 0x0800
  uint16_t              penReleReg;                                                     // struttura che contiene informazioni condi relè gig PEN     Start 0x0830
} scuRwMapRegister_st;


typedef __packed struct
{
  headerScuRx_st      headerScuRx;
  ScuMessage_u        message;
} frameScuRx_st;

typedef __packed struct
{
  ScuMessage_u        message;
} frameMdbRx_st;


/* REGISTRO EVSE_CHARGE_STATUS_RO --> Address = 0x0601, 1 word */
typedef enum
{
  INITIAL_EVSE_STATE            = 0x00,         /* Initial EVSE state modbus v19.2                      */ 
  IDLE_STATE                    = 0x01,         /* IDLE EVSE state modbus v19.2                         */ 
  PREPARING_STATE               = 0x02,         /* PREPARING EVSE state modbus v19.2                    */ 
  EV_CONNECTED_STATE,                           /* CONNECTED EVSE state modbus v19.2                    */
  CHARGING_STATE,                               /* INCHARGE EVSE state modbus v19.2                     */
  SUSPENDED_EV_STATE,                           /* SUSPENDED EV EVSE state modbus v19.2                 */
  SUSPENDED_EVSE_STATE,                         /* SUSPENDED EVSE EVSE state modbus v19.2               */
  END_CHARGE_STATE,                             /* END CHARGE EVSE state modbus v19.2                   */
  FAULTED_STATE,                                /* FAULTED EVSE state modbus v20                        */
  UNVAILABLE_STATE,                             /* UNVAILABLE EVSE state modbus v20                     */
  RESERVED_STATE,                               /* RESERVED EVSE state modbus v20                       */
  BOOTLOADER_STATE,                             /* BOOTLOADER EVSE state modbus v20                     */
  SHUTDOWN_STATE,                               /* SHUTDOWN EVSE state modbus v20                       */
  REBOOTING_STATE,                              /* REBOOTING EVSE state modbus v20                      */
  SUSPENDED_NOPOWER_STATE                       /* SUSPENDED EVSE by NO POWER state modbus v24          */
} evseChargeStatusReg_e;


/* REGISTRO EVSE_EVENT_FLAGS_RO --> Address = 0x0600, 1 word */
typedef enum
{
  EVSE_EVENT_UNDEFINED          = 0x00,         /* EVENT UNDEFINED                                      */
  SOCKET_BLOCKED                = 0x01,         /* SOCKET BLOCKED event modbus v20                      */ 
  CONNECTOR_PLUGGED_IN          = 0x02,         /* CONNECTOR PLUGGED IN event modbus v20                */ 
} evseEventFlagsReg_e;


/* REGISTRO HWC_FLAGS_RW --> Address = 0x0001, 1 word */
typedef enum
{
  HW_FLAGS_UNDEFINED            = 0x0000,       /* FLAGS UNDEFINED                                      */
  DIFF_RIARM_FLAG               = 0x0001,       /* DIFFERENZIALE RIARMABILE                             */ 
  DISPLAY_LCD_FLAG              = 0x0002,       /* DISPLAY GRAFICO + TOUCH                              */ 
  RFID_READER_FLAG              = 0x0004,       /* LETTORE RFID                                         */ 
  WIFI_CONNECTION_FLAG          = 0x0008,       /* WIFI CONNECTION                                      */
} hwFlags_e;


/* REGISTRO EVSE_OPERATION_MODE_RW --> Address = 0x0023, 1 word */
typedef enum
{
  OP_MODE_FREE                  = 0x00,         /* FREE operation mode                                  */
  OP_MODE_PERSONAL              = 0x01,         /* PERSONAL operation mode                              */ 
  OP_MODE_NET                   = 0x02,         /* NET operation mode                                   */ 
  OP_MODE_OCPP                  = 0x03          /* OCPP operation mode                                  */ 
} opMode_e;


/* REGISTRO EVSE_AVAILABILITY_RW --> Address = 0x0023, 1 word */
typedef enum
{
  EVSE_UNDEFINED_AVAILAB         = 0x00,         /* Valore non definito, init                            */        
  EVSE_DISPONIBILE               = 0x01,         /* Socket disponibile                                   */
  EVSE_NON_DISPONIBILE           = 0x02,         /* Socket non disponibile / in manutenzione             */ 
  EVSE_RISERVATO                 = 0x03          /* Socket riservata                                     */ 
} evseAvailab_e;
  

/* REGISTRO POWER_OUTAGE_TYPE_RW --> Address = 0x0003, 1 word */
typedef enum
{
  POWER_NONE                     = 0x00,         /* Power outage module NONE                             */
  POWER_BACK                     = 0x01,         /* Power outage Backup battery                          */ 
  POWER_MON                      = 0x02,         /* Power outage Monitor module                          */
  POWER_PEN                      = 0x03          /* Power outage PEN module                              */    
} powerOutage_e;


/* REGISTRO EVSE_ERROR1_RO --> Address = 0x0404, 1 word */
typedef enum
{
  ERROR1_NONE                    = 0x0000,       /* Error 1 register, value NO error                     */
  ERROR1_RCDM                    = 0x0001,       /* Error 1 register, value RCDM error                   */ 
  ERROR1_LIDE                    = 0x0002,       /* Error 1 register, value LIDE error                   */
  ERROR1_VENT                    = 0x0004,       /* Error 1 register, value ventilation error            */
  ERROR1_BLCK                    = 0x0008,       /* Error 1 register, value socket block error           */
  ERROR1_BLEF                    = 0x0010,       /* Error 1 register, value Bluetooth error              */
  ERROR1_WIFI                    = 0x0020,       /* Error 1 register, value Wi-fi error                  */
  ERROR1_MIRR                    = 0x0040,       /* Error 1 register, value Mirror error                 */
  ERROR1_RCBO                    = 0x0080,       /* Error 1 register, value magnetothermic error         */
  ERROR1_CPSE                    = 0x0100,       /* Error 1 register, value CP short circuit error       */
  ERROR1_PPSE                    = 0x0200,       /* Error 1 register, value PP short circuit error       */
  ERROR1_CPLS                    = 0x0400,       /* Error 1 register, value CP lost error                */
  ERROR1_PPLS                    = 0x0800,       /* Error 1 register, value PP lost error                */
  ERROR1_VBUS                    = 0x1000,       /* Error 1 register, value low voltage supply error     */
  ERROR1_MFRE                    = 0x2000,       /* Error 1 register, value RFID reader error            */
  ERROR1_EMTR                    = 0x4000,       /* Error 1 register, value internal energy meter error  */
  ERROR1_OVCE                    = 0x8000,       /* Error 1 register, value overcurrent error            */
} error1Reg_e;


/* REGISTRO EVSE_ERROR2_RO --> Address = 0x0405, 1 word */
typedef enum
{
  ERROR2_NONE                    = 0x0000,       /* Error 2 register, value NO error                     */
  ERROR2_RCTE                    = 0x0001,       /* Error 2 register, value rectifier diode presence error */ 
  ERROR2_EMEX                    = 0x0002,       /* Error 2 register, value external energy meter error  */
  ERROR2_CHN2                    = 0x0004,       /* Error 2 register, value chain2  error                */
  ERROR2_OFFL                    = 0x0008,       /* Error 2 register, communication error on RS485       */
  ERROR2_PENF                    = 0x0010,       /* Error 2 register, value PEN error                    */
  ERROR2_HGTP                    = 0x0020,       /* Error 2 register, value high temperature error       */
} error2Reg_e;


/* REGISTRO HW_ACTUATORS_RW --> Address = 0x0028, 1 word */
typedef enum
{
  ACT_NONE                       = 0x0000,       /* Actuator NONE value                                  */
  ACT_BLCK                       = 0x0001,       /* Actuator BLOCK                                       */ 
  ACT_MIRR                       = 0x0002,       /* Actuator MIRROR                                      */
  ACT_RCBO                       = 0x0004,       /* Actuator RCBO                                        */
  ACT_WIFI                       = 0x0008,       /* Actuator WIFI                                        */
  ACT_BACK                       = 0x0010,       /* Battery backup enable                                */
  UNSED_MASK                     = 0x00E0        /* unused bit                                           */
} actuatorsReg_e;

/* REGISTRO EVSE_OPERATION_MODE_RW --> Address = 0x0023, 1 word */
#define MASTER_MODE_LOCAL        0x100
#define MASTER_MODE_OCPP         0x200

// --------------------------------------------------------------------------------------------------------------------------- //

// -------------------------- global constats -------------------------------------------------------------------------------- //

// --------------------------------------------------------------------------------------------------------------------------- //

// -------------------------- global references ------------------------------------------------------------------------------ //
extern frameMdbRx_st*           pMsgShared;                                                      /* Variabile globale per usare il frameMdbRx anche nel File Wi-Fi tramite una copia */
extern uint16_t                 frameLength;                                                     /* Lunghezza messaggio da inviare                                                   */
extern uint8_t                  InitModbusRegisters_Stop;

extern appMapRwRegister_st*     pAppRwRegs;
// --------------------------------------------------------------------------------------------------------------------------- //

/****************** FUNCTIONS IMPLEMENTATION **************************************************************************/
void                  scuGestTask                   (void * pvParameters);
void                  scuUartRxTimeoutTask          (void * pvParameters);
void                  scuDataLinkTask               (void * pvParameters);
void                  scuSemGestTask                (void * pvParameters);
xQueueHandle          getScuDataLinkQueueHandle     (void);
uint8_t*              getBuffRxScu                  (void);
xQueueHandle          getScuQueueHandle             (void);
xQueueHandle          getScuUartRxTimeoutQueueHandle(void);
void                  getFromScuRegister            (uint16_t regAddr, uint8_t size, uint8_t lpoAddr, uint8_t function);
void                  freeTxBuffer                  (void);
void                  scuModbus_IRQHandler          (void); 
uint8_t*              getRegInfoFromIdx             (uint16_t scuIdx, scuAllRegIdx_e scuRegIdx, uint16_t* pLen);        
scuOpModes_e          getScuOpMode                  (void);
void                  setScuOpMode                  (scuOpModes_e mode);
scuTypeModes_e        getScuTypeMode                (void);
void                  setScuTypeMode                (scuTypeModes_e typeMode);
void                  txOnRs485Bus                  (uint8_t* pTxBuffer, uint16_t len); 
void                  freeSemTxBuffer               (void);
void                  getFromModbusMap              (frameMdbRx_st* pRdRxFrame, uint16_t totalLen, scuOpModes_e opMode);
void                  setModbusInpReg               (uint8_t inpSig, GPIO_PinState state);
void                  setModbusErrorTesting         (uint8_t inpSig, GPIO_PinState state);
uint8_t               getLogicalMdbAddr             (void);
uint8_t               getPhysicalMdbAddr            (void);
uint8_t               getLogicalMdbAddrSem          (void);
scuRoMapRegister_st*  getRoMdbRegs                  (uint8_t addr);
scuRwMapRegister_st*  getRwMdbRegs                  (uint8_t addr);
appMapRwRegister_st*  getAppMdbRwRegs               (uint8_t addr);
osSemaphoreId         getScuUartInitSemaphoreHandle (void);
xQueueHandle          getScuSemQueueHandle          (void);
osSemaphoreId         getScuSinapsiTxUartSemaphoreHandle  (void);

void                  setModbusRotarySwitchCurr     (rotaryPos_e position);      
void                  setModbusMaxPowerResult       (uint32_t value);  
void                  setModbusMaxCurrentResult     (uint16_t value);
void                  setSessionId                  (unsigned int numSession); 
void                  setHwFlags                    (void); 
void                  setNumberOfLeds               (void);
uint16_t              getHwFlags                    (void); 
void                  setPowerOutage                (uint8_t power); 
uint16_t              getPowerOutage                (void);
void                  setEnergyMetersType           (void); 
void                  setStationOperationMode       (void);
uint32_t              getSessionId                  (void);
void                  setErrorModbus                (uint16_t error, uint8_t errorReg);
void                  setModbusBootEvent            (void); 
void                  setFwVersion                  (char* fwVersion);
void                  setMifareFwVersion            (char* MifarefwVersion);
uint16_t              getOperationMode              (void);
void                  setHwVersion                  (char* hwVersion);
void                  iniProductSerialNumber        (char* productSn, uint8_t length);
char*                 getProductSerialNumber        (void);
char*                 getProductCode                (void);
void                  setTecnProductCode            (char* fakeCode, uint8_t length);
char*                 getFakeProductCode            (void);
void                  setConnectorNumber            (uint8_t connPos, uint8_t connNumb); 
uint16_t              setMaxTypicalCurrent          (void);
void                  setMaxSimplifiedCurrent       (void);
void                  setUtcDateTimeRegister        (void); 
void                  setSchedulationInModbusTable  (sck_schedule_t *schedulations);
void                  setUpdateFirmwareByAppResult  (void); 
void                  setUidAuthorizationByApp      (char* uidApp);
void                  getUidAuthorizationByCard     (char* dest); 
void                  setUidAuthorizationByCard     (uint8_t* uidCard); 
void                  setSinapsiStatusForApp        (uint8_t state);
uint16_t              getPmFlags                    (void);
uint16_t              getPmPmax                     (void);
uint16_t              getPmImin                     (void);
uint16_t              getPmHpower                   (void);
uint16_t              getPmDset                     (void);
uint16_t              getPmDmax                     (void);
uint16_t              getPmEmex                     (void);
void                  setPmEmexInModbus             (uint8_t emexFlag);
uint16_t              getChargeByTime               (void);
void                  setChargeByTime               (uint16_t chargeTime); 
uint16_t              getDefaultLanguage            (void);
void                  setDefaultLanguage            (uint8_t lang);
uint32_t              getAvailableLanguages         (void);
void                  setAvailableLanguages         (uint32_t availLang);
void                  setPowerManagementRegisters   (void);
uint16_t              getPmMenuVisibility           (void);
void                  setPmMenuVisibility           (uint8_t visibility);
void                  setEvsePowerMode              (void); 
void                  setChargeTimeVisibility       (uint8_t visibility);
void                  setHwChecks                   (uint16_t checks1, uint16_t checks2);
uint16_t              getHwChecks1                  (void);
uint16_t              getHwChecks2                  (void);
uint16_t              getHwActuators                (void);
void                  setHwActuators                (uint8_t actEeprom);
void                  setActuatorsInEeprom          (uint16_t actModbus);
void                  setPmMode                     (uint8_t mode); 
void                  setTimeZone                   (uint8_t timeZone);
uint8_t               getPmMode                     (); 
void                  iniBoardSerialNumber          (char* boardSn, uint8_t length);
void                  setProductSerialNumber        (char* productSn, uint8_t length);
void                  setProductCodeString           (char* pProductCode, uint8_t length);
void                  iniProductCodeString          (char* productCode, uint8_t length);
void                  setBoardSnHwVerString         (char* pBoardStr, uint8_t length);
uint16_t              getRegisterFromModbusMap      (uint16_t addr); 
uint8_t               getRandomDelay                (void);
void                  setMallocTx485                (uint8_t* pBuff);
void                  UART_SCU_DMA_Tx               (uint8_t* pTxBuffer, uint16_t len); 
uint8_t               getCollaudoRunning            (void);
void                  setCollaudoRunning            (void);
uint8_t               getCollaudoParamWritten       (void);
uint8_t               isSemMode                     (void);
void                  setModbusVersion              (uint16_t  mdbVersion); 
void                  iniProductFakeString          (char* fakeCode, uint8_t length);
void                  setConnectorType              (void); 
void                  setChargeByEnergy             (uint16_t chargeEnrg);
uint16_t              getChargeByEnergy               (void);
void                  sendAnswToSem                 (mbError_e codeError, uint8_t ixScu, uint16_t rAddr, uint16_t len, scuEvents_e ev, uint8_t funct);
uint32_t              getMaxTempPowerAc             (void);
uint16_t              getRandomId16                 (void);
tmMapRegister_st*     getTmMdbRegs                  (uint8_t addr);
scuAddModeSktNum_e    getScuAddressTypeMode         (void);
uint8_t               setScuAddressTypeMode         (scuAddModeSktNum_e addrType);
uint8_t               setNominalPower               (uint16_t ITypical); 
uint8_t               getNumSktInProduct            (void);
void                  updateScuModbusAddrr          (void);
uint16_t              getConnectorId                (void);
void                  saveMaxTypicalCurrentEeprom   (uint8_t current);
void                  saveMaxSimplifiedCurrentEeprom  (uint8_t current);
void                  savePmModeEeprom              (uint8_t pmMode);
void                  savePmPmaxEeprom              (uint8_t* pMax);
void                  savePmIminEeprom              (uint8_t iMin); 
void                  savePmHpowerEeprom            (uint8_t hPower);
void                  savePmDsetEeprom              (uint8_t* dset);
void                  savePmDmaxEeprom              (uint8_t dMax); 
void                  saveDefaultDisplayLanguageEeprom (uint8_t lang);
void                  saveDisplayLanguagesEeprom    (uint8_t* langs);
void                  saveConnectorAliasEeprom      (uint8_t alias);
void                  saveConnectorTypeEeprom       (uint8_t conn);
uint8_t               modbusToHttpSocketConverter   (uint8_t conn);
void                  saveEnergyMetersTypeEeprom    (uint8_t* em);
uint8_t               modbusToHttpEnergyMeterConverter (uint8_t em); 
void                  saveVisibleFlagsEeprom        (uint8_t flags); 
void                  saveChargeTimeEeprom          (uint8_t timeEnum);
void                  savePowerManagementFlagsEeprom (uint8_t pmFlags);
void                  saveChargeEnergyEeprom        (uint8_t enrgEnum);
uint8_t               isSlaveWaitToBeOperative      (void); 

void                  uartReintialization           (void);
void                  UART_SCU_DMA_RX_IRQHandler    (void);
uint8_t               setPmRemoteSemFlag            (uint8_t writeImm);
uint8_t               ResetPmRemoteSemFlag          (uint8_t writeImm);
uint16_t              getMaxSimplifiedCurrent       (void);
uint16_t              getMaxTypicalCurrent          (void);
void                  setInChargeTime               (uint32_t timeCharge); 
void                  setScuTypeModeFromEeprom      (void);
void                  resetSbcGardTime              (void);
uint8_t               isSemMasterFz                 (void);

uint16_t              getScuModbusTableId           ( uint16_t idFromInterface );
void                  sendScuDataLinkMsg            (scuDlEvents_e scuDlEvents); 
void                  setEmFaultTrap                (void);

#ifdef MODBUS_TCP_EM_LOVATO
scuMapRegLovatoEmSim_st* getLovatoEthRegs           (void);
xQueueHandle          getEmLovatoQueueHandle        (void);

#endif

// --------------------------------------------------------------------------------------------------------------------------- //
#endif // _SCUMDB_H






/*************** END OF FILE ******************************************************************************************/



=======
/**
* @file        scuMdb.h
*
* @brief       Uart for RS485 SCU mobus communication  - Definition -
*
* @author      Nick
*
* @riskClass   C
*
* @moduleID
*
* @vcsInfo
*     $Id: scuMdb.h 763 2025-06-05 15:05:27Z npiergi $
*
*     $Revision: 763 $
*
*     $Author: npiergi $
*
*     $Date: 2025-06-05 17:05:27 +0200 (gio, 05 giu 2025) $
*
*
* @copyright
*       Copyright (C) 2016 SCAME S.p.A. All rights reserved.
*       This file is copyrighted and the property of Aesys S.p.A.. It contains confidential and proprietary
*       information. Any copies of this file (in whole or in part) made by any method must also include a copy of this
*       legend.
*       Developed by:  SCAME S.p.A.
***********************************************************************************************************************/


#ifndef _SCUMDB_H
#define _SCUMDB_H
#include "wrapper.h"
#include "Em_Task.h"
#include "sbcGsy.h"


// -------------------------- global defines --------------------------------------------------------------------------------- //
#define   LAST_ITEM                         ((uint16_t)0xFFFF)

#define   CURR_MODBUS_VERSION               ((uint16_t)24)

/** nel caso di SCU slave SBC SEM può interrogare solo indirizzi 1 e 2  **/
#define   MAX_ID_FOR_SCU_S                  ((uint8_t)2)

#define   SCU_M_P_ADDR                       ((uint8_t)1)   /* SCU working as principal SCU connected to SBC master has fixed address at 1          */ 
#define   SCU_M_P_ADDR_LOG                   ((uint8_t)0)   /* SCU working as principal SCU connected to SBC master has fixed address logical at 0  */ 
#define   SCU_S_S_ADDR                       ((uint8_t)2)   /* SCU working as secondary SCU connected to SCU principal with address 2               */ 
#define   SCU_S_S_ADDR_LOG                   ((uint8_t)1)   /* SCU working as secondary SCU connected to SCU principal with address logical 1       */ 
#define   SCU_M_P_OFFSET_ADDR                ((uint8_t)100) /* for other SCU the principal SCU has address 100 + local address                      */ 
#define   MODBUS_BROADCAST_ADDR              ((uint8_t)0)   /* address for broadcast message over modbus RS485                                      */ 
#define   SCU_S_REPL_ADDR                    ((uint8_t)99)  /* in SEM enviroment a the address for replacement board                                */ 

#define   SCU_S_S_COLLAUDO_ADDR              ((uint8_t)11)  /* SCU working as secondary SCU (after factory testing procedure)                       */ 
#define   SCU_SLAVE_PRINCIPAL_ADDR           ((uint8_t)11)  /* SCU working as principal  slave in a pillar                                          */ 
#define   SCU_SLAVE_SECONDARY_MAX_ADDR       ((uint8_t)14)  /* SCU working as secondary has this max value  in a pillar                             */ 

#define   MODBUS_MAX_LEN                     ((uint8_t)250) /* max numeber of data bytes  over modbus RS485       0x7D = 125 * 2 = 250              */ 

#define   FILE_COMMAND_MASK                  ((uint16_t)0x000F)
#define   FILE_COMMAND_BROAD                 ((uint16_t)0x000F)

#define   TIMER_UART_WD                      pdMS_TO_TICKS((uint16_t)60000)
#define   TIMER_UART_TO_RESET                pdMS_TO_TICKS((uint16_t)5000)
#define   TIMER_UART_GARD_TIME               pdMS_TO_TICKS((uint16_t)500)

#define   TIMER_MDB_UART_ID                  ((uint16_t)0)

/* 2 min gard time to be sure that SBC has been powered correctly */
#define   TIMER_SBC_GARD_ID                  ((uint16_t)0)
#define   TIMER_SBC_GARD_TIME                pdMS_TO_TICKS((uint32_t)120000) 
/* 1 min gard time to be sure that SLAVE has been powered correctly */
#define   TIMER_SLAVE_GARD_ID                ((uint16_t)1)
#define   TIMER_SLAVE_GARD_TIME              pdMS_TO_TICKS((uint32_t)130000) 
#define   TIMER_GARD_BLOCK_TIME              pdMS_TO_TICKS((uint32_t)(100))

/* ----------- numero buffer nella coda di ricezione  -------------*/
#define   NUM_BUFF_SCU_RX                   ((uint16_t)8)
#define   NUM_BUFF_SCU_RX_TIMEOUT           ((uint16_t)8)
     
#define   NUM_BUFF_SCU_MSG_DL_TX            ((uint16_t)16)      
#define   NUM_BUFF_SCU_MSG_DL_RX            ((uint16_t)16)      

/**** mask bit for modbus map register   ****/
/* BIT MASK for REG_ERR_0 */
#define   LID_MASK                          ((uint16_t)0x0002)
#define   RCBO_MASK                         ((uint16_t)0x0080)
#define   PEN_ERR_MASK                      ((uint16_t)0x0010)
#define   VAC230_ZC_MASK                    ((uint16_t)0x1000)
#define   MIRROR_SEM_MASK                   ((uint16_t)0x0040)
#define   RCDM_SEM_MASK                     ((uint16_t)0x0001)
#define   PULS_SEM_MASK                     ((uint16_t)0x8000)

#define   ALL_CONF_PARS_EXT_FLASH_ADDR      ((uint32_t)0x140000)

/**       ---------------------------  DATA LINK MANAGER ----------------------------- **/

/********* -----------  USART1 -- SCUs  -------- ***************************/
/* Definition for USART SCU  clock resources We use UART1 PA10=Rx,PA9=TX, and PA12=DE  */
#define UART_SCU                           USART1
#define UART_SCU_HANDLE                    huart1
#define UART_SCU_DEFAULT_BR                ((uint32_t)19200)
#define UART_SCU_SINAPSI_BR                ((uint32_t)115200)
#define UART_SCU_CLK_ENABLE()              __HAL_RCC_UART1_CLK_ENABLE() 
#define UART_SCU_RX_GPIO_CLK_ENABLE()      __GPIOA_CLK_ENABLE()
#define UART_SCU_TX_GPIO_CLK_ENABLE()      __GPIOA_CLK_ENABLE()
#define DMAx_SCU_CLK_ENABLE()              __DMA2_CLK_ENABLE()

/* Definition for USARTx Pins */
#define UART_SCU_TX_PIN                    GPIO_PIN_9
#define UART_SCU_TX_GPIO_PORT              GPIOA
#define UART_SCU_TX_AF                     GPIO_AF7_USART1
#define UART_SCU_RX_PIN                    GPIO_PIN_10
#define UART_SCU_RX_GPIO_PORT              GPIOA
#define UART_SCU_RX_AF                     GPIO_AF7_UART1
#define UART_SCU_DE_PIN                    GPIO_PIN_12
#define UART_SCU_DE_GPIO_PORT              GPIOA
#define UART_SCU_DE_AF                     GPIO_AF7_UART1

/* Definition for USARTx's DMA */
#ifndef GD32F4xx
#define UART_SCU_TX_DMA_STREAM              GPDMA1_Channel1
#define UART_SCU_RX_DMA_STREAM              GPDMA1_Channel0
#else
#define UART_SCU_TX_DMA_STREAM              DMA2_Stream7
#define UART_SCU_RX_DMA_STREAM              DMA2_Stream5
#endif

#define UART_SCU_TX_DMA_CHANNEL             DMA_CHANNEL_4
#define UART_SCU_RX_DMA_CHANNEL             DMA_CHANNEL_4

/* Definition for USARTx's NVIC */
#define UART_SCU_DMA                        DMA2
#define UART_SCU_DMA_STREAM                 DMA2_Stream5
#define UART_SCU_DMA_TX_IRQn                DMA2_Stream7_IRQn
#define UART_SCU_DMA_RX_IRQn                DMA2_Stream5_IRQn
#define UART_SCU_DMA_TX_IRQHandler          DMA2_Stream7_IRQHandler
#ifndef GD32F4xx
#define UART_SCU_DMA_RX_IRQHandler          DMA2_Stream5_IRQHandler
#endif

/* Definition for USARTx's NVIC */
#define UART_SCU_IRQn                       USART1_IRQn
#define UART_SCU_IRQHandler                 USART1_IRQHandler

/* Dimensione massimo campo dati del messaggio   */
#define SCU_DL_RX_PAYLOAD_MAX_LEN       ((uint16_t)64)
#define SCU_DL_RX_MSG_MAX_LEN           ((uint16_t)(SCU_DL_RX_PAYLOAD_MAX_LEN + (uint16_t)10))
#define SCU_DMA_RX_BUFFER_SIZE          SCU_DL_RX_MSG_MAX_LEN
#define SCU_DL_TX_MSG_MAX_LEN           SCU_DL_RX_MSG_MAX_LEN

/* ----------- numero buffer nella coda di ricezione  -------------*/
#define   NUM_BUFF_SCU_DL_RX                ((uint16_t)2) 
     
#define   NUM_BUFF_SCU_MSG_DL_TX            ((uint16_t)16)      
#define   NUM_BUFF_SCU_MSG_DL_RX            ((uint16_t)16)      

/* ----------- Indici campi modbus RTU   -------------*/
//#define   IDX_ID_SCU                    ((uint8_t) 0)                           /* Indice numero SCU nel comando Modbus                                                         */
//#define   IDX_FUNCTION                  ((uint8_t) 1)                           /* Indice Function nel comando Modbus                                                           */
//#define   IDX_REG_ADDR_H                ((uint8_t) 2)                           /* Indice Indirizzo registro byte high nel comando Modbus                                       */
//#define   IDX_REG_ADDR_L                ((uint8_t) 3)                           /* Indice Indirizzo registro byte low nel comando Modbus                                        */
//#define   IDX_N_WORD_H                  ((uint8_t) 4)                           /* Indice Numero word byte high nel comando Modbus                                              */
//#define   IDX_N_WORD_L                  ((uint8_t) 5)                           /* Indice Numero word byte low nel comando Modbus                                               */
//#define   IDX_N_BYTE                    ((uint8_t) 6)                           /* Indice Numero di byte nel comando Modbus (solo scrittura)                                    */
//#define   IDX_FIRST_DATA_BYTE           ((uint8_t) 7)                           /* Indice Primo byte di data nei comandi di scrittura                                           */        

/* ----------- Indici campi modbus TCP (richiesto per app ios)  -------------*/
#define   IDX_COUNTER_H                 ((uint8_t) 0)                            /* Indice contatore progressivo inizio pacchetto Modbus TCP                                      */
#define   IDX_COUNTER_L                 ((uint8_t) 1)                            /* Indice contatore progressivo inizio pacchetto Modbus TCP                                      */
#define   IDX_LEN_PAYL_H                ((uint8_t) 4)                            /* Indice Lunghezza payload nel protocollo MODBUS TCP byte high                                  */
#define   IDX_LEN_PAYL_L                ((uint8_t) 5)                            /* Indice Indirizzo registro byte low nel comando Modbus                                         */
#define   IDX_ID_SCU                    ((uint8_t) 6)                            /* Indice numero SCU nel comando Modbus                                                          */
#define   IDX_FUNCTION                  ((uint8_t) 7)                            /* Indice Function nel comando Modbus                                                            */
#define   IDX_REG_ADDR_H                ((uint8_t) 8)                            /* Indice Indirizzo registro byte high nel comando Modbus                                        */
#define   IDX_REG_ADDR_L                ((uint8_t) 9)                            /* Indice Indirizzo registro byte low nel comando Modbus                                         */
#define   IDX_N_WORD_H                  ((uint8_t) 10)                           /* Indice Numero word byte high nel comando Modbus                                               */
#define   IDX_N_WORD_L                  ((uint8_t) 11)                           /* Indice Numero word byte low nel comando Modbus                                                */
#define   IDX_N_BYTE                    ((uint8_t) 12)                           /* Indice Numero di byte nel comando Modbus (solo scrittura)                                     */
#define   IDX_FIRST_DATA_BYTE           ((uint8_t) 13)                           /* Indice Primo byte di data nei comandi di scrittura                                            */        


#define   IDX_CHNL_NUMB_CIPSEND         ((uint8_t) 11)                           /* Indice al byte del comando AT+CIPSEND dove scrivere il numero del canale su cui comunicare    */

/* ----------- Indici registro PROCEDURE_RESPONSE_RO  -------------*/
#define   IDX_RESP_REQ_BYTE             ((uint8_t) 0)                            /* Indice byte 0 PROCEDURE_RESPONSE_RO contenente la richiesta fatta                             */                
#define   IDX_RESP_STATUS_BYTE          ((uint8_t) 1)                            /* Indice byte 1 PROCEDURE_RESPONSE_RO contenente lo stato di elaborazione della procedura       */
#define   IDX_RESP_RESULT_BYTE          ((uint8_t) 2)                            /* Indice byte 2 PROCEDURE_RESPONSE_RO contenente l'esito della procedura                        */
#define   IDX_RESP_DETAIL_BYTE          ((uint8_t) 3)                            /* Indice byte 3 PROCEDURE_RESPONSE_RO contenente il dettaglio dell'esito della procedura        */

/* ----------- Flag per risposte errori comandi modbus  -----------*/
#define   REC_ILLEGAL_ADDRESS           ((uint8_t) 1)                            /* Received modbus command with illegale address                                                 */
#define   REC_ILLEGAL_ADDRESS_RST       ((uint8_t) 0)                            /* Reset flag illegal address command modbus received                                            */ 

/* MAPPA COMANDI MACCHINA DI COLLAUDO */
#define   TM_CONTATTORE_MASK            ((uint16_t)0x0001)                        /* Flag Mask for contactor command                                    */ 
#define   TM_CONTATTORE_ON              ((uint16_t)0x0001)                        /* Flag status ON for contactor                                       */ 
#define   TM_MODO_FREE_MASK             ((uint16_t)0x0004)                        /* Flag Mask for modo free command                                    */ 
#define   TM_MODE_FREE_ON               ((uint16_t)0x0004)                        /* Flag status ON for modo free                                       */ 


typedef enum
{
  SCU_NO_REQ_ANSWER = 0x0000,       /* Message right, answer not necessary   */ 
  SCU_SEND_ANSWER   = 0x0001,       /* Message right, answer  necessary    */ 
  SCU_ADDRESS_ERROR = 0x0002,       /* Message with address wrong  */ 
  SCU_MSG_ERROR     = 0x0003,       /* Message wrong  */ 
  SCU_DEFAULT_ANSW  = 0xFFFF
} scuMsgResult_e;


/**       ---------------------------  SCU OPERATIVE MODES  -------------------------------- **/
typedef enum
{
  SCU_EMUMAX0_S     = 0x0000,       /* SCU is working as MAX0 in slave position on RS485 bus                    */ 
  SCU_EMUMAX0_M     = 0x0001,       /* SCU is working as MAX0 in master position on RS485 bus                   */ 
  SCU_M_P           = 0x0002,       /* SCU is working as principal SCU connected to SBC master                  */ 
  SCU_S_P           = 0x0003,       /* SCU is working as principal SCU connected to SBC (TFT) slave             */ 
  SCU_S_S           = 0x0004,       /* SCU is working as secondary SCU connected to SCU principal on RS485 bus --> PUT @VALUE 6 TO AVOID WARNINGS IN COMPILE TIME */ 
  SCU_M_STAND_ALONE = 0x0005,       /* SCU is working as a master in stand alone mode */
  SCU_NUM_MODES     = 0x0006,
  SCU_MODE_UNDEF    = 0xFFFF
} scuOpModes_e;

typedef enum
{
  SCU_SEM_M           = 0x0000,       /* SCU is working with SEM as master           */ 
  SCU_GSY             = 0x0001,       /* SCU is working with GSY                     */ 
  SCU_SEM_S           = 0x0002,       /* SCU is working with SEM as slave            */ 
  SCU_SEM_MS          = 0x0003,       /* SCU is working with SEM as secondary master */ 
  SCU_SEM_STAND_ALONE = 0x0004,       /* SCU is working with SEM out of the WB or Pillar */ 
  SCU_NUM_TYPE        = 0x0005,
  SCU_MASK_TYPE       = 0x0007,
  SCU_TYPE_UNDEF      = 0x00FF
}scuTypeModes_e;

typedef enum
{
  SCU_S_PS_STARTUP        = 0x0004,       /* code to search SCU  working as secondary SCU  on RS485 bus  at startup   */ 
  SCU_S_PS_LIVE           = 0x0005,       /* code to search SCU  working as secondary SCU  on RS485 bus  at live      */ 
  SCU_S_PS_NEW            = 0x0006,       /* code to search new SCU  working as secondary SCU  on RS485 bus  at live  */ 
  SCU_ALL_FACTORY_PARAM   = 0xFFEC,       /* code to restore on all SCU the factory parameters                        */ 
  SCU_SEARCH_UNDEF        = 0xFFFF
} scuSearchCode_e;


/**       ---------------------------  SCU SEM CONTROL BITS FLAGS   -------------------------------- **/
typedef enum
{
  SCU_TEMPORARY_ADDR  = 0x0000,       /* SCU address is temporary and could be changed in discovery phase */ 
  SCU_FIXED_ADDR      = 0x0001,       /* SCU address is fixed and couldn't be changed in discovery phase */ 
  SCU_ADDR_MODE_MASK  = 0x0001,

  SCU_SKT_NUM_MASK    = 0x000E        /* socket number inside the product 1..4                            */
}scuAddModeSktNum_e;

/**       ---------------------------  SCU SPERIMENTAL MODES  -------------------------------- **/

typedef enum
{
  SCU_SINAPSI_NOT_PRESENT   = 0x00,    /* SINAPSI board not present                             */ 
  SCU_SINAPSI_PRESENT       = 0x01,    /* SINAPSI board present but with bluetooth OFF          */
  SCU_SINAPSI_BT_ON         = 0x02     /* SINAPSI board present and bluetooth ON                */
} sinapsiStateApp_e;


/**       ---------------------------  SCU RS485 L3  MANAGER ----------------------------- **/
/* define for task request */

typedef enum
{
  TX_TO_SCU           = 0x00,      /* Request to send a msg to SCU     */ 
  TX_TO_SCU_TIMEOUT   = 0x01,      /* polling request                  */ 
  RX_FROM_SCU         = 0x02,      /* Request to take a msg from SCU   */
  TX_TO_WIFI          = 0x03,      /* Request to send a msg to Wi-Fi   */
  RX_FROM_WIFI        = 0x04,      /* Request to take a msg from Wi-Fi */     
  SCU_ERROR           = 0xFFFF     /* Error on uart   */ 
} scuMsgDir_e;

typedef enum
{
  SCU_IDLE            = 0x0000,       /* initial state                    */ 
  SCU_OPERATIVE       = 0x0001,       /* normal condition                 */ 
  SCU_REQ_INT_RD_WR   = 0x0002,       /* internal read or write request   */ 
  SCU_DUMMY           = 0xFFFF
} scuStates_e;

typedef enum
{
  SCU_DL_IDLE     = 0x0000,       /* initial state   */ 
  SCU_DL_READY    = 0x0001,       /* ready state     */ 
  SCU_DL_READING  = 0x0002,       /* reading phase    */ 
  SCU_DL_WRITING  = 0x0003,       /* writing phase    */ 
  SCU_DL_PH_DUMMY = 0xFFFF
} scuDlStates_e;

typedef enum
{
  SCU_EVENT_START             = 0x00,      /* timeout evet                                                                    */ 
  SCU_EVENT_RD_ANSW_WR_REQ,                /* incoming RD answer or WR request message SCU side                               */ 
  SCU_EVENT_RD_REQ_WR_ACK,                 /* incoming RD request or WR ack answer message SCU side                           */ 
  SCU_EVENT_MSG_FROM_SBC,                  /* incoming message SBC side                                                       */ 
  SCU_EVENT_MSG_INTERNAL_WR,               /* an internal task ask to send a message to write a reg: an example is for debug  */ 
  SCU_EVENT_MSG_INTERNAL_RD,               /* an internal task ask to send a message to read a reg: an example is for debug   */ 
  SCU_EVENT_MSG_NO_ANSWER,                 /* no answer at the previous request                                               */
  SCU_EVENT_MSG_FROM_WIFI,                 /* incoming message from Wi-Fi module                                              */       
  SCU_EVENT_DUMMY = 0xFFFF
} scuEvents_e;

typedef enum
{
  SCU_DL_START                = 0x00,       /* start data link                                                                 */ 
  SCU_DL_SEND,                              /* send a frame                                                                    */ 
  SCU_DL_RX_IDLE,                           /* IDLE detected                                                                   */
  SCU_DL_RECEIVE_FROM_RS485,                /* received frame                                                                  */ 
  SCU_DL_TIMEOUT,                           /* elapsed timerout                                                                */ 
  SCU_DL_ERR_UART,                          /* error on uart                                                                   */
  SCU_DL_RX_COLLAUDO,                       /* ricezione messaggio dalla macchina di collaudo                                  */
  SCU_DL_CHANGE_TO_SEM,                     /* error on uart due to wrong enviroment we are in SEM but set in EMUMAX           */
  SCU_DL_CHANGE_TO_SEM_FROM_TEST,           /* vhange from SEM to EMUMAX0 at the end of all automatic test                     */
  SCU_DL_DUMMY = 0xFFFF
} scuDlEvents_e;

typedef enum
{
  SCU_DL_OP_RD                = 0x00,       /* read operation                                                                  */ 
  SCU_DL_OP_WR,                             /* write operation                                                                 */ 
  SCU_DL_OP_DUMMY = 0xFFFF
} scuDlOp_e;

typedef __packed struct
{
  uint32_t    microId1;
  uint32_t    microId2;
  uint32_t    microId3;
} microId_t;

/* define error code for SCU */
typedef enum
{
  SCU_NO_ERROR     = 0,            /* no error                          */ 
  SCU_REG_UNDEF,                   /* Register undefined                */ 
  SCU_NO_ANSWER                    /* SCU not answering                  */ 
} scuError_e;

/* define for register type  */
typedef enum
{
  BIG_ENDIANESS = 0,
  LITTLE_ENDIANESS
} endianessType_e;

/* define for register type  */
typedef enum
{
  RO     = 0,                      /* read only register                */ 
  RW,                              /* read/write register               */ 
  WO
} regType_e;

/* define error code for modbus */
typedef enum
{
  NO_ERROR     = 0,           /* no error                      */ 
  MB_ILLEGAL_FUNC = 1,        /* Register undefined            */ 
  MB_ILLEGAL_ADDR,            /* Illegal address               */ 
  MB_ILLEGAL_DATA,            /* Illegal dats                  */ 
  MB_NAK = 0x07               /* negative ACK                  */ 
} mbError_e;

/* define SCU index registers linked strictly to const scuRegInfo_st   scuRegister[SCU_LAST_REG_IDX] */
typedef enum
{
  BOARD_FW_VERSION_RO      = 0,         /* Campo ASCII contenente la versione del main firmware                                      0 */ 
  MIFARE_FW_VERSION_RO     = 1,         /* Versione FW del lettore RFID                                                                */ 
  BOARD_SN_RO,                          /* Numero di serie della scheda                                                                */ 
  PLC_FW_VERSION_RO,                    /* Campo ASCII versione FW del modulo PLC (solo stazione DC)                                   */ 
  PLC_MAC_ADDRESS_RO,                   /* MAC address del modulo PLC (solo stazione DC)                                               */
  HW_REVISION_RO,                       /* Revisione hardware della SCU                                                                */
  WIFI_MAC_ADDRESS_RO,                  /* MAC address del modulo Wi-Fi Espressif                                                      */
  POWER_MODULE_SN_RO,                   /* Numero di serie del modulo di potenza inserito nella EVSE                                   */
  BLE_MAC_ADDRESS_RO,                   /* MAC address del modulo Bluetooth                                                            */
  PRODUCT_SN_RO,                        /* Numero di serie del prodotto Scame                                                          */
  PRODUCT_CODE_RO,                      /* Codice prodotto di Scame                                                                 10 */ 
  BOOT_FW_VERSION_RO,                   /* Campo ASCII contenente la versione del boot firmware                                        */ 
  MODBUS_FW_VERSION_RO,                 /* Campo binario contenente la versione del modbus                                             */ 
  SCU_RESERVED1,                        /* Reserved for future use                                                                     */ 
  NOTIFY_EVSE_PRESENCE_RO,              /* Indica quanti e quali indirizzi sono presenti nel sistema                                   */ 
  NOTIFY_EVSE_CHANGE_RO,                /* Registro per segnalare un cambiamento di stato (prevedere autocleaning)                     */ 
  EVSE_ERROR1_RO,                       /* Registro 1 per segnalare allarmi e/o errori                                                 */ 
  EVSE_ERROR2_RO,                       /* Registro 2 per segnalare allarmi e/o errori                                                 */ 
  EVSE_CHANGE_REGISTERS_RO,             /* registro che notifica lo stato della stazione                                               */ 
  SCU_RESERVED2,                        /* Reserved for future use                                                                     */ 
  APP_EXCHANGE_AREA_RO,                 /* Area used by app to exchange data with SCU                                                  */   
  /* -------------- Inizio dei parametri Read-Only eventi --> 0x600                                         --------------             */                         
  EVSE_EVENT_FLAGS_RO,                  /* contiene lo stato del connettore tethered                                                21 */ 
  EVSE_CHARGE_STATUS_RO,                /* registro che notifica lo stato della stazione                                               */ 
  TEMPERATURE_SYSTEM_RO,                /* temperatura del sistema (quella rilevata dal uP nel caso AC)                                */ 
  SCU_RESERVED3,                        /* Reserved for duture use                                                                     */ 
  VOLTAGE_AC_RO,                        /* Tensione di alimentazione del sistema (parametro OCCP)                                      */ 
  CURRENT_AC_L1_RO,                     /* Corrente fase 1 (parametro OCCP)                                                            */ 
  CURRENT_AC_L2_RO,                     /* Corrente fase 2 (parametro OCCP)                                                            */ 
  CURRENT_AC_L3_RO,                     /* Corrente fase 3 (parametro OCCP)                                                            */ 
  ACTIVE_POWER_DC_RO,                   /* Potenza attiva del sistema DC  (parametro OCPP)                                             */ 
  ACTIVE_POWER_AC_RO,                   /* Potenza attiva del sistema     (parametro OCCP)                                             */ 
  CURRENT_AC_SYS_RO,                    /* Corrent di sistema (mono / trifase) (parametro OCCP)                                     31 */ 
  REACTIVE_POWER_AC_RO,                 /* Potenza reattiva del sistema   (parametro OCCP)                                             */ 
  TOTAL_ACTIVE_ENERGY_AC_EV_RO,         /* Energia attiva del sistema     (parametro OCCP)                                             */ 
  TOTAL_ACTIVE_ENERGY_DC_EV_RO,         /* Energia attiva del sistema DC  (parametro OCCP)                                             */ 
  TOTAL_REACTIVE_ENERGY_AC_EV_RO,       /* Energia reattiva del sistema   (parametro OCCP)                                             */
  TRANSACTION_ACTIVE_ENERGY_AC_EV_RO,   /* Energia attiva parziale relativa alla sessione corrente    (parametro OCCP)                 */ 
  ACTIVE_POWER_AC_L2_RO,                /* Potenza attiva fase L2                                                                      */ 
  TRANSACTION_REACTIVE_ENERGY_AC_EV_RO, /* Energia reattiva parziale relativa alla sessione corrente  (parametro OCCP)                 */
  FREQUENCY_SUPPLY_RO,                  /* Frequenza di rete     (parametro OCCP)                                                      */ 
  SCU_RESERVED4,                        /* Reserved (usati per stazione DC)                                                            */ 
  MAX_CURRENT_ROTATORY_SWITCH_RO,       /* Corrente impostata nel selettore rotativo                                                41 */ 
  UNDEFINED_EX_RSC_CURR_RDD,            /* Corrente massima di sistema                                                                 */ 
  ACTIVE_POWER_AC_L3_RO,                /* Potenza attiva fase L2                                                                      */ 
  EMPTY_063A,
  MAX_CURRENT_RESULT_RO,                /* Corrente massima di carica risultante dai vari calcoli e confronti                          */ 
  TRANSACTION_TIME_RO,                  /* Tempo in secondi, trascorsi dall'inizio della carica                                        */ 
  TRANSACTION_COUNTDOWN_RO,             /* Tempo, in secondi, rimanenti al completamento della carica                                  */ 
  EV_BATTERY_RO,                        /* percentuale della carica della batteria  (parametro OCCP)                                   */ 
  SESSION_ID_RO,                        /* identificatore univoco della sessione di carica                                          48 */ 
  EVSE_BOOT_EVENT_RO,                   /* flag di notifica reset di sistema                                                           */ 
  TOTAL_ACTIVE_ENERGY_AC_GRID_RO,       /* Energia attiva totale con funzionalità GRID V2G                                          50 */
  TOTAL_REACTIVE_ENERGY_AC_GRID_RO,     /* Energia reattiva totale con funzionalità GRID V2G                                           */
  TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO, /* Energia attiva erogata durante una transazione, funzionalità GRID V2G                       */
  TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO,  /* Energia reattiva erogata durante una transazione, funcionalità GRID V2G                  */ 
  SCU_RESERVED6,                        /*                                                                                             */
  UID_AUTHORIZATION_RO,                 /* valore UID della card letta                                                                 */ 
  TIME_CHARGE_RO,                       /* tempo ricarica effettivo                                                                    */ 
  SCU_RESERVED6B,                       /* -------------- Fine dei parametri Read-Only si passa a quelli RW --------------             */

  CONNECTOR_TYPE_RW,                    /* Registro per modificare configurazione Hardware                                          58 */ 
  HWC_FLAGS_RW,                         /* Flag componenti hardware aggiuntivi                                                         */                          
  ENERGY_METERS_RW,                     /* tipo di energy meter                                                                     60 */ 
  POWER_OUTAGE_TYPE_RW,                 /* Hardware impiegato per l'assenza di tensione                                                */
  CONNECTOR_IDS_RW,                     /* Modifica indirizzo modbus usato come alias della scheda                                     */ 
  BOARD_SN_RW,                          /* Numero di serie della stazione                                                              */ 
  PRODUCT_SN_RW,                        /* Numero di serie del prodotto                                                                */ 
  MASTER_HW_TYPE_RW,                    /* Configurazione master / slave                                                               */ 
  UTC_DATE_TIME_RW,                     /* data e ora correnti letti da RTC                                                            */ 
  POWER_MODULE_BRAND_RW,                /* Indica la marca del produttore del caricabatteria (solo DC)                                 */ 
  POWER_MODULE_MODEL_RW,                /* Indica la marca del modello del caricabatteria (solo DC)                                 68 */ 
  POWER_MODULE_N_RW,                    /* Indica il numero di moduli installati al sistema  (solo DC)                              69 */ 
  EVSE_TM_MODE_RW,                      /* Abilitazione macchina di collaudo         a                                              70 */ 
  EVSE_OPERATION_MODE_RW,               /* In dica la modalità di funzionamento del sistema di ricarica                                */ 
  CHARGE_PROTOCOL_SELECTED_RW,          /* Indica con quale connettore effettuare la ricarica (solo DC)                                */ 
  DISPLAY_DEFAULT_LANGUAGE_RW,          /* Indica la lingua utilizzata dal sistema                                                     */ 
  HW_CHECKS1_RW,                        /* Registro per abilitazione errori e configurazioni HW                                        */ 
  HW_CHECKS2_RW,                        /* Registro per abilitazione errori e configurazioni HW                                        */ 
  HW_ACTUATORS_RW,                      /* Registro per la configurazione degli attuatori del sistema                                  */ 
  SCU_RESERVED7,                        /* Registri riservati per stazione DC                                                          */         
  MAX_TEMPORARY_CURRENT_RW,             /* Parametro PID per sistema AC                                                             78 */ 
  UNDEFINED_EX_LIM_LOW_CURR_RWD,        /* Imposta la corrente minima di ricarica                                                   79 */ 
  LED_STRIP_RWD,                        /* Registro utilizzato per impostare numero led nella strip                                 80 */ 
  REMOTE_COMMANDS_RW,                   /* Emulazione stato pressione del pulsante remoto                                              */ 
  ENVIRONMENT_BRIGHTNESS_RW,            /* Valore di luminosità letto dal sensore                                                      */ 
  UNDEFINED_EX_PRX_DIST_RWD,            /* Indica la distanza rilevata dal sensore                                                     */ 
  UNDEFINED_EX_PRX_MOTION_RWD,          /* Registro flag che indica presenza di movimento rilevata                                     */ 
  MAX_TEMPORARY_POWER_AC_RW,            /* Parametro per impostare potenza massima temporanea AC disponibile                        85 */ 
  PM_MODE_RW,                           /* registro utilizzato per la modalità di funzionamento del Power Management                   */ 
  ENABLE_LOG_RW,                        /* abilitazione log su SD (solo DC)                                                            */ 
  AUTHORIZATION_FEEDBACK_RW,            /* in modalità NET autorizza e controlla la carica                                          88 */ 
  TIMEZONE_RW,                          /* registro per gestire il time zone rispetto a UTC                                         89 */ 
  MENU_VISIBILITY_RW,                   /* registro per impostare la visibilità di alcuni menù della stazione AC                    90 */ 
  TIMEOUT_RANGE1_RW,                    /* registro per impostare il valore di partenza del counter 1                                  */ 
  TIMEOUT_RANGE2_RW,                    /* registro per impostare il valore di partenza del counter 2                                  */
  PRODUCT_CODE_RW,                      /* Codice prodotto SCAME                                                                       */
  TECN_PRODUCT_CODE_RW,                 /* Codice prodotto fake SCAME                                                                  */
  CONNECTOR_N_RW,                       /* Numero della presa all'interno della EVSE                                                   */
  DISPLAY_LANGUAGES_ENABLED_RW,         /* Lingua impostata e di default della EVSE                                                    */
  MAX_TYPICAL_CURRENT_RW,               /* Massima corrente in modalità tipica                                                         */
  MAX_SIMPLIFIED_CURRENT_RW,            /* Massima corrente in modalità semplificata                                                98  */
  CHARGE_TIME_RW,                       /* Tempo di carica massimo per Power Management                                             99 */
  CHARGE_MAX_ENERGY_RW,                 /* Massima potenza totale utilizzabile in una carica                                       100 */                          
  PM_IMIN_RW,                           /* Corrente minima con funzione Power Management                                               */
  PM_PMAX_RW,                           /* Potenza massima con funzione Power Management                                               */
  PM_FLAGS_RW,                          /* Flag di abilitazione funzione Power Management                                              */
  PM_HPOWER_RW,                         /* Isteresi soglia di potenza con funzione Power Management                                    */
  PM_DSET_RW,                           /* Valore di variazione della potenza erogata, funzione Power Management                       */
  PM_DMAX_RW,                           /* Valore di isteresi della potenza in eccesso, funzione Power Management                      */ 
  PIN_EXTERNAL_ENERGY_METER_RW,         /* Pin di energy meter esterno                                                                 */         
  LIM_MAX_POWER_AC_RW,                  /* massima potenza AC                                                                      108 */ 
  RESERVED_A,                           /* reserved for future use                                                                     */ 
  FILE_COMMAND_RW,                      /* Comando per avviare l'aggiornamento SW                                                  110 */ 
  FILE_SIZE_RW,                         /* Registro con indicazione del size del file da caricare                                      */ 
  FILE_PACKET_RW,                       /* Registro con indicazione del numero pacchetti del file da caricare                          */ 
  
  /****          definizioni identificatori  per l'ambiente SINAPSI - RSE ************************************************************ */
  IOM_CTRL,                             /*                                                                                             */
  M2_PAII_TS,                           /*                                                                                             */
  M2_PAII,
  M2_PC_TS,                             /*                                                                                             */     
  M2_PC,
  M1_PC_TS,
  M1_PC,                                                                                                                           
  M1_PD_TS,
  M1_PD,                                /*                                                                                         122 */
  M1_PAPI_TS,                           /*                                                                                             */        
  M1_PAPI,                              
  M1_PAII_TS,                           
  M1_PAII,
  M1_RES_DIST_TS,                       /*                                                                                             */      
  M1_TIME_RES_DIST,                      
  M1_PFO_TS,
  M1_PFO,                                
  M1_PMRTLIM,
  M1_PMRTLIM_TS,                        /*                                                                                         132 */
  M1_SOSP_RIC_TLIM,                     /*                                                                                             */     
  M1_UT_SYNC,                                  
  SET_CONFIG_MODE,                                      
  
  /****          definizioni identificatori  per l'ambiente test PEN **************************************************************    */
  PEN_RELE,                             /*                                                                                             */ 
  
  /****          definizioni identificatori  per l'ambiente MACCHINA DI COLLAUDO  *************************************************    */
  TM_MEASURED_CURRENT_RW,               /* Corrente misurata dall'EM interno alla macchina di collaudo                             137 */
  TM_MEASURED_VOLTAGE_RW,               /* Tensione misurata dall'EM interno alla macchina di collaudo                                 */
  TM_COMMAND_RW,                        /* Registro per comandi da eseguire durante il collaudo                                        */
  TM_ADDR_S_CONN_RW,                    /* Registro notifica scheda collegata tramite ponticello J1-J2                                 */
  TM_ADDR_REQ_RW,                       /* Registro per comandi fase di richiesta indirizzamento automatico                            */
  TM_ADDR_ASS_RW,                       /* Registro per comandi fase di assegnazione indirizzamento automatico                         */
  TM_ERROR1_IN_TEST_RO,                 /* registro errori durante la fase di collaudo                                                 */
  TM_UID_MASTER_RW,                     /* Registro per scrittura UID carta Master                                                     */
  TM_UID_USER_RW,                       /* Registro per scrittura UID carta Master                                                     */
  TM_MEASURED_CURRENT_L2_RW,            /* Corrente misurata dall'EM interno alla macchina di collaudo  L2 (solo trifase)          146 */
  TM_MEASURED_VOLTAGE_L2_RW,            /* Tensione misurata dall'EM interno alla macchina di collaudo  L2 (solo trifase)              */
  TM_MEASURED_CURRENT_L3_RW,            /* Corrente misurata dall'EM interno alla macchina di collaudo  L3 (solo trifase)          148 */
  TM_MEASURED_VOLTAGE_L3_RW,            /* Tensione misurata dall'EM interno alla macchina di collaudo  L3 (solo trifase)              */
  TM_GET_EEPROM_INFO,                   /* Richiesta lettura parametri in EEPROM                                                       */
  
  /****          definizioni identificatori  per l'ambiente APP WIFI  *************************************************************    */
  CONNECTOR_INIT_STATUS_RO,             /* Stato di attivazione della presa                                                            */
  CONNECTOR_OPERATION_STATUS_RO,        /* Stato IDLE o meno della presa (c'è attiva o meno una procedura?? Richiesto da Enrico    152 */ 
  PROCEDURE_RESPONSE_RO,                /* Esito procedura SCU richiesta dalla App                                                     */
  PM_TOTAL_POWER_RO,                    /* Potenza totale esterna                                                                      */
  PM_L1_POWER_RO,                       /* Potenza esterna fase 1                                                                      */
  PM_L2_POWER_RO,                       /* Potenza esterna fase 2                                                                      */
  PM_L3_POWER_RO,                       /* Potenza esterna fase 3                                                                      */
  USER_LOGIN_RO,                        /* Tipologia di utente che ha fatto il login                                                   */
  CONNECTOR_CHECK_ACTIV_KEY_RW,         /* Controllo pin di attivazione presa con quello riportato nel manuale                         */
  CONNECTOR_NAME_RW,                    /* Nome presa scelto dall'utente                                                               */
  CONNECTOR_PIN_RW,                     /* Pin presa scelto dall'utente in fase di Init                                                */
  ROUTER_NET_SSID_RW,                   /* SSID della rete del router domestico                                                    162 */
  ROUTER_NET_PASSWORD_RW,               /* Password della rete del router domestico                                                    */
  CONNECTOR_ROUTER_IP_RW,               /* Indirizzo IP assegnato dal router al modulo Espressif                                       */
  PROCEDURE_REQUEST_RW,                 /* Richiesta di una procedura da parte della App                                               */
  SCHEDULE_FLAG1_RW,                    /* Flag di attivazione schedulazione 1                                                         */
  SCHEDULE_START1_RW,                   /* Orario di start della carica schedulata 1                                                   */
  SCHEDULE_STOP1_RW,                    /* Orario di stop della carica schedulata 1                                                    */
  SCHEDULE_POWER1_RW,                   /* Massima potenza impostabile per la schudulazione 1                                          */
  SCHEDULE_FLAG2_RW,                    /* Flag di attivazione schedulazione 2                                                         */
  SCHEDULE_START2_RW,                   /* Orario di start della carica schedulata 2                                                   */
  SCHEDULE_STOP2_RW,                    /* Orario di stop della carica schedulata 2                                                172 */
  SCHEDULE_POWER2_RW,                   /* Massima potenza impostabile per la schudulazione 2                                          */
  SCHEDULE_FLAG3_RW,                    /* Flag di attivazione schedulazione 3                                                         */
  SCHEDULE_START3_RW,                   /* Orario di start della carica schedulata 3                                                   */
  SCHEDULE_STOP3_RW,                    /* Orario di stop della carica schedulata 3                                                    */
  SCHEDULE_POWER3_RW,                   /* Massima potenza impostabile per la schudulazione 3                                          */
  SCHEDULE_FLAG4_RW,                    /* Flag di attivazione schedulazione 4                                                         */
  SCHEDULE_START4_RW,                   /* Orario di start della carica schedulata 4                                                   */
  SCHEDULE_STOP4_RW,                    /* Orario di stop della carica schedulata 4                                                    */
  SCHEDULE_POWER4_RW,                   /* Massima potenza impostabile per la schudulazione 4                                          */
  CONNECTOR_CONNECTION_STATUS_RO,       /* Stato di connessione ad una rete domestica                                              182 */
  MAX_POWER_RO,                         /* Massima potenza stazione per settaggio tachimetro su APP                                    */        
  RANDOM_DELAY_FLAG_RW,                 /* Registro per abilitare/disabilitare il ritardo randomico sulle schedulazioni                */        
  UID_AUTHORIZATION_APP_RW,             /* Registro per modalità PERSONAL BY APP richiesta dal marketing. UID app                      */ 
  BT_SINAPSI_STATUS_RW,                 /* Registro per lo stato del bluetooth della scheda Sinapsi                                    */
  FW_UPDATE_NAME_RW,                    /* Registro per settare il nome del file del nuovo fw che si vuole installare                  */
  FW_UPDATE_LEN_RW,                     /* Registro per settare la lunghezza dei byte del nuovo fw che si vuole installare             */
  FW_UPDATE_STATUS_RO,                  /* Registro per segnalare l'esito di un'aggiornamento firmware da app                          */ 
  EVSE_POWER_MODE_RO,                   /* Registro per mostrare se è trifase o monofase l'alimentazione                               */ 
  
  /****          definizioni identificatori  per SIMULATORE EM LOVATO Ethernet    *************************************************    */
  EM_LOVATO_SIM_V_SYS,                  /* tensione di fase                                                                       191  */
  EM_LOVATO_SIM_P_AREA,                 /* elenco delle potenze delle varie stazioni                                                   */
    
  /****          end definitions  ************************************************************** */
  SCU_LAST_REG_IDX,                     /* last index                                                                             193  */ 
  SCU_SBC_DUMMY                         /* index register not used                                                                     */ 
} scuAllRegIdx_e;


/* ----------- Transmission definition to SCU   -------------*/
typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint8_t     payload[SCU_DL_TX_MSG_MAX_LEN];
} headerSCU_t;


typedef __packed union
{
  headerSCU_t           nodeReadInputReg;
} messageScuTx_u;


typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint16_t    regAdd;
  uint16_t    numWords;
  uint8_t     numBytes;
  uint16_t    data[SCU_DL_RX_PAYLOAD_MAX_LEN];
} scuRWmultipleReg_st;

typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint8_t     numBytes;
  uint8_t     data[MODBUS_MAX_LEN];
} headerAnwsRIR_t;

typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint8_t     numBytes;
  uint8_t     data;
} scuAnwsRIR_t;


typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint16_t    regAdd;
  uint16_t    numWord;
} headerAnwsWMR_t;

typedef __packed struct
{
  uint8_t     unitId;
  uint8_t     function;
  uint8_t     errorCode;
} headerAnwsError_t;


typedef __packed union
{
  nodeRWsingleReg_st    nodeRWsingleReg;
  headerRIR_t           nodeReadInputReg;
  headerRHR_t           nodeReadHoldingReg;
  scuRWmultipleReg_st   nodeRWmultipleReg;
  nodeWsingleReg_st     nodeWsingleReg;
  headerAnwsRIR_t       headerAnwsRIR; 
  headerAnwsWMR_t       headerAnwsWMR;
  headerAnwsError_t     headerAnwsError;
  scuAnwsRIR_t          scuAnwsRIR;
  frameSbcRx_st         frameSbcRx;
} ScuMessage_u;


typedef __packed struct
{
  uint16_t            totalLen;
  uint8_t*            pMessage;
  uint16_t            idSCU;          /* address on RS485 1..16                   */
  uint16_t            reqRegAddr;     /* address register required                */
  scuAllRegIdx_e      scuRegIdx;      /* index of the request register            */
  scuEvents_e         scuEvents;
  scuMsgDir_e         scuMsgDir;
} frameScu_st;


/* ----------- Receive  definition from  SCU   -------------*/
typedef __packed struct
{
  scuDlEvents_e       dlEvent;
  scuDlOp_e           scuDlOp;
  uint16_t            idSCU;          /* address on RS485 1..16                   */
  uint16_t            reqRegAddr;     /* address register required                */
  scuAllRegIdx_e      scuRegIdx;      /* index of the request register            */
  uint16_t            totalLen;
} headerScuRx_st;


typedef __packed struct
{
  uint8_t     startFrame;
  uint8_t     address;
  uint8_t     len;
  uint8_t     payload[SCU_DL_RX_PAYLOAD_MAX_LEN];
} reqScuUser_st;


typedef __packed union
{
  reqScuUser_st         reqScuUser;
  uint8_t               msgComplete[NUM_BUFF_SCU_DL_RX];
} messageScuRx_u;

/* define for SCU single registers  info */
typedef __packed struct
{
  uint16_t    regAdd;
  uint16_t    size;           /* number of word to be read/write for the specified reg address  */
  regType_e   regType;        /* register type                                                  */
} scuRegInfo_st;

/* SCU index and relative address  */
typedef __packed struct
{
  uint16_t    index;
  uint16_t    rAddr;
}regScuAddr_t;

/* start  registers  info linked a request from RS485 */
typedef __packed struct
{
  uint16_t    index;
  uint8_t*    pRegAdd;
}regStartInfo_t;

typedef __packed struct
{
  scuStates_e         scuStates;
  uint16_t            crcCpuId;
  headerScuRx_st      frameScuDlRxTmp;
} scuInfoMng_st;

typedef __packed struct
{
  scuDlStates_e       scuStates;
  headerRIR_t         lastRd;
} scuDlInfoMng_st;

/***                                                                                                                                                 ***/
/*** Definizioni per il protocollo MODBUS tra SCU e SBC ************************************************************************************************/
/***                                                                                                                                                 ***/
#define LEN_BOARD_FW_VERSION_RO                 ((uint16_t)12)        /* address len Campo ASCII contenente la versione del main firmware                               */                                 
#define LEN_MIFARE_FW_VERSION_RO                ((uint16_t)10)        /* address len Versione FW del lettore RFID                                                       */         
#define LEN_BOARD_SN_RO                         ((uint16_t)8)         /* address len Numero di serie della scheda                                                       */         
#define LEN_PLC_FW_VERSION_RO                   ((uint16_t)12)        /* address len Campo ASCII versione FW del modulo PLC (solo stazione DC)                          */         
#define LEN_PLC_MAC_ADDRESS_RO                  ((uint16_t)10)        /* address len MAC address lendel modulo PLC (solo stazione DC)                                   */         
#define LEN_HW_REVISION_RO                      ((uint16_t)8)         /* address len Campo versione hardware della scheda                                               */
#define LEN_WIFI_MAC_ADDRESS_RO                 ((uint16_t)10)        /* address len MAC address del modulo Wi-Fi Espressif                                             */
#define LEN_POWER_MODULE_SN_RO                  ((uint16_t)10)        /* address len Numero di serie del modulo di potenza                                              */   
#define LEN_BLE_MAC_ADDRESS_RO                  ((uint16_t)10)        /* address len MAC address del modulo Bluetooth (da valutare se serve)                            */   
#define LEN_PRODUCT_SN_RO                       ((uint16_t)8)         /* address len Campo numero di serie del prodotto                                                 */
#define LEN_PRODUCT_CODE_RO                     ((uint16_t)12)        /* address len Campo codice prodotto SCAME                                                        */
#define LEN_BOOT_FW_VERSION_RO                  ((uint16_t)12)        /* address len Campo ASCII contenente la versione del boot firmware                               */
#define LEN_MODBUS_VERSION_RO                   ((uint16_t)1)         /* address len Campo lunghezza versione del modbus                                                */
#define LEN_SCU_RESERVED1                       ((uint16_t)133)       /* address len Reserved for future use                                                            */         

#define LEN_NOTIFY_EVSE_PRESENCE_RO             ((uint16_t)2)         /* address len Indica quanti e quali indirizzi sono presenti nel sistema                          */         
#define LEN_NOTIFY_EVSE_CHANGE_RO               ((uint16_t)2)         /* address len Registro per segnalare un cambiamento di stato (prevedere autocleaning)            */         
#define LEN_EVSE_ERROR1_RO                      ((uint16_t)1)         /* address len Registro 1 per segnalare allarmi e/o errori                                        */         
#define LEN_EVSE_ERROR2_RO                      ((uint16_t)1)         /* address len Registro 2 per segnalare allarmi e/o errori                                        */         
#define LEN_EVSE_CHANGE_REGISTERS_RO            ((uint16_t)32)        /* address len contiene l'indirizzo del registro cambiato per ogni singola scheda                 */         
#define LEN_SCU_RESERVED2                       ((uint16_t)474)       /* address len Reserved for future use                                                            */         

#define LEN_EVSE_EVENT_FLAGS_RO                 ((uint16_t)1)         /* address len Registro stato del connettore tethered                                             */         
#define LEN_EVSE_CHARGE_STATUS_RO               ((uint16_t)1)         /* address len registro che notifica lo stato della stazione                                      */    
#define LEN_TEMPERATURE_SYSTEM_RO               ((uint16_t)2)         /* address len temperatura del sistema (quella rilevata dal uP nel caso AC)                       */         
#define LEN_RESERVED3_RDD                       ((uint16_t)10)        /* address len Reserved for duture use                                                            */        
 
#define LEN_VOLTAGE_AC_RO                       ((uint16_t)2)         /* address len Tensione di alimentazione del sistema (parametro OCCP)                             */         
#define LEN_CURRENT_AC_L1_RO                    ((uint16_t)2)         /* address len Corrente fase 1 (parametro OCCP)                                                   */         
#define LEN_CURRENT_AC_L2_RO                    ((uint16_t)2)         /* address len Corrente fase 2 (parametro OCCP)                                                   */         
#define LEN_CURRENT_AC_L3_RO                    ((uint16_t)2)         /* address len Corrente fase 3 (parametro OCCP)                                                   */         
#define LEN_ACTIVE_POWER_DC                     ((uint16_t)2)         /* address len Sommatoria delle correnti                                                          */       
#define LEN_ACTIVE_POWER_AC_RO                  ((uint16_t)2)         /* address len Potenza attiva del sistema     (parametro OCCP)                                    */       
#define LEN_ACTIVE_POWER_AC_L1_RO               ((uint16_t)2)         /* address len potenza attiva fase 1                                                              */       
#define LEN_REACTIVE_POWER_AC_RO                ((uint16_t)2)         /* address len Potenza reattiva del sistema   (parametro OCCP)                                    */       
#define LEN_TOTAL_ACTIVE_ENERGY_AC_EV_RO        ((uint16_t)2)         /* address len Energia attiva del sistema     (parametro OCCP)                                    */       
#define LEN_TOTAL_ACTIVE_ENERGY_DC_EV_RO        ((uint16_t)2)         /* address len Energia apparente del sistema  (parametro OCCP)                                    */       
#define LEN_TOTAL_REACTIVE_ENERGY_AC_EV_RO      ((uint16_t)2)         /* address len Energia reattiva del sistema   (parametro OCCP)                                    */       
#define LEN_TRANSACTION_ACTIVE_ENERGY_AC_EV_RO  ((uint16_t)2)         /* address len Energia attiva parziale relativa alla sessione corrente    (parametro OCCP)        */       
#define LEN_ACTIVE_POWER_AC_L2_RO               ((uint16_t)2)         /* address len potenza attiva fase 2                                                              */       
#define LEN_TRANSACTION_REACTIVE_ENERGY_AC_EV_RO ((uint16_t)2)        /* address len Energia reattiva parziale relativa alla sessione corrente  (parametro OCCP)        */       
#define LEN_FREQUENCY_SUPPLY_RO                 ((uint16_t)2)         /* address len Frequenza di rete     (parametro OCCP)                                             */       
#define LEN_RESERVED4_RDD                       ((uint16_t)9)         /* address len Reserved (usati per stazione DC)                                                   */       
#define LEN_MAX_CURRENT_ROTATORY_SWITCH_RO      ((uint16_t)1)         /* address len Corrente impostata nel selettore rotativo                                          */       
#define LEN_UNDEFINED_EX_RSC_CURR_RDD           ((uint16_t)2)         /* address len Corrente massima di sistema                                                        */       
#define LEN_ACTIVE_POWER_AC_L3_RO               ((uint16_t)2)         /* address len potenza attiva fase 2                                                              */       
#define LEN_EMPTY_063A                          ((uint16_t)1)         /* address len of empty register at address 063A                                                  */
#define LEN_MAX_CURRENT_RESULT_RO               ((uint16_t)1)         /* address len Corrente massima di carica risultante dai vari calcoli e confronti                 */       
#define LEN_TRANSACTION_TIME_RO                 ((uint16_t)2)         /* address len Tempo in secondi, trascorsi dall'inizio della carica                               */       
#define LEN_TRANSACTION_COUNTDOWN_RO            ((uint16_t)2)         /* address len Tempo, in secondi, rimanenti al completamento della carica                         */       
#define LEN_EV_BATTERY_RO                       ((uint16_t)1)         /* address len percentuale della carica della batteria  (parametro OCCP)                          */       
#define LEN_SESSION_ID_RO                       ((uint16_t)2)         /* address len identificatore della sessione di carica                                            */       
#define LEN_EVSE_BOOT_EVENT_RO                  ((uint16_t)1)         /* address len identificatore tipo di reset                                                       */       

/* Aggiunti per v18b Modbus */
#define LEN_TOTAL_ACTIVE_ENERGY_AC_GRID_RO      ((uint16_t)2)         /* address len Energia Attiva totale funzione GRID V2G                                            */
#define LEN_TOTAL_REACTIVE_ENERGY_AC_GRID_RO    ((uint16_t)2)         /* address len Energia Reattiva totale funzione GRID V2G                                          */
#define LEN_TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO   ((uint16_t)2)      /* address len Energia Attiva erogata in una transazione, funzione GRID V2G                       */
#define LEN_TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO ((uint16_t)2)      /* address len Energia Reattiva erogata in una transazione, funzione GRID V2G                     */ 
#define LEN_SCU_RESERVED6                       ((uint16_t)4)         /* address len reserved                                                                           */   

/* Registro di notifica quindi messo in una sezione a parte */
#define LEN_UID_AUTHORIZATION_RO                ((uint16_t)24)        /* address len valore UID della card letta                                                        */
#define LEN_TIME_IN_CHARGE_RO                   ((uint16_t)2)         /* address len tempo effettivo di carica                                                          */
#define LEN_SCU_RESERVED6B                      ((uint8_t)198)        /* address len reserved                                                                           */                

/* ----- Fine dei parametri Read-Only si passa a quelli RW --------------   */

#define LEN_CONNECTOR_TYPE_RW                   ((uint16_t)1)         /* address len modello della stazione                                                             */  
#define LEN_HWC_FLAGS_RW                        ((uint16_t)1)         /* address len flag componenti hardware aggiuntivi                                                */  
#define LEN_ENERGY_METERS_RW                    ((uint16_t)1)         /* address len tipo di energy meter                                                               */
#define LEN_POWER_OUTAGE_HW_RW                  ((uint16_t)1)         /* address len Tipo di hardware installato per gestire l'assenza di tensione                      */ 

#define LEN_CONNECTOR_IDS_RW                    ((uint16_t)1)         /* address len Modifica indirizzo modbus usato come alias della scheda                            */       
#define LEN_BOARD_SN_RW                         ((uint16_t)8)         /* address len Numero di serie della stazione                                                     */       
#define LEN_PRODUCT_SN_RW                       ((uint16_t)8)         /* address len Numero di serie del prodotto                                                       */       
#define LEN_MASTER_HARDWARE_TYPE_RW             ((uint16_t)1)         /* address len Configurazione master / slave                                                      */       
#define LEN_UTC_DATE_TIME_RW                    ((uint16_t)9)         /* address len data e ora correnti letti da RTC                                                   */       
#define LEN_POWER_MODULE_BRAND_RW               ((uint16_t)1)         /* address len Indica la marca del produttore del caricabatteria (solo DC)                        */       
#define LEN_POWER_MODULE_MODEL_RW               ((uint16_t)1)         /* address len Indica la marca del modello del caricabatteria (solo DC)                           */       
#define LEN_POWER_MODULE_N_RW                   ((uint16_t)1)         /* address len Indica il numero di moduli installati al sistema  (solo DC)                        */       
#define LEN_EVSE_TM_MODE_RW                     ((uint16_t)1)         /* address len Abilitazione macchina di collaudo                                                  */       
#define LEN_EVSE_OPERATION_MODE_RW              ((uint16_t)1)         /* address len In dica la modalità di funzionamento del sistema di ricarica                       */       
#define LEN_CHARGE_PROTOCOL_SELECTED_RW         ((uint16_t)1)         /* address len Quale connettore utilizzare per la ricarica (DC)                                   */       
#define LEN_DISPLAY_DEFAULT_LANGUAGE_RW         ((uint16_t)1)         /* address len Indica la lingua utilizzata dal sistema                                            */
#define LEN_HW_CHECKS1_RW                       ((uint16_t)1)         /* address len Registro per abilitazione errori                                                   */                                 
#define LEN_HW_CHECKS2_RW                       ((uint16_t)1)         /* address len Registro per abilitazione errori                                                   */                                 
#define LEN_HW_ACTUATORS_RW                     ((uint16_t)1)         /* address len Registro per la configurazione degli attuatori del sistema                         */                                 

#define LEN_SCU_RESERVED7                       ((uint16_t)8)         /* address len Imposta la corrente massima AC disponibile nel sistema                             */                                 
#define LEN_MAX_TEMPORARY_CURRENT_RW            ((uint16_t)2)         /* address len Parametro PID per sistema AC                                                       */           
#define LEN_EMPTY_0033_RW                       ((uint16_t)1)         /* address len --------------                                                                     */        

#define LEN_LED_STRIP_RW                        ((uint16_t)1)         /* address len Registro utilizzato per impostare lunghezza strip led                              */           
#define LEN_REMOTE_COMMANDS_RW                  ((uint16_t)1)         /* address len Emulazione stato pressione del pulsante remoto                                     */           
#define LEN_ENVIRONMENT_BRIGHTNESS_RW           ((uint16_t)1)         /* address len Valore di luminosità letto dal sensore                                             */           
#define LEN_MIN_POWER_DC_RWD                    ((uint16_t)2)         /* address len minima potenza DC (non usato in AC)                                            */           
#define LEN_UNDEFINED_EX_PRX_MOTION_RWD         ((uint16_t)1)         /* address len Registro flag che indica presenza di movimento rilevata                            */           
#define LEN_MAX_TEMPORARY_POWER_AC              ((uint16_t)2)         /* address len Parametro per impostare potenza massima temporanea AC disponibile                  */             
#define LEN_PM_MODE_RW                          ((uint16_t)1)         /* address len registro utilizzato modalità Power Management                                      */           
#define LEN_ENABLE_LOG_RW                       ((uint16_t)1)         /* address len abilitazione log su SD (solo DC)                                                   */           
#define LEN_AUTHORIZATION_FEEDBACK_RW           ((uint16_t)1)         /* address len in modalità NET autorizza e controlla la carica                                    */           
#define LEN_TIMEZONE_RW                         ((uint16_t)1)         /* address definizione time zone rispetto a UTC                                                   */           
#define LEN_MENU_VISIBILITY_RW                  ((uint16_t)1)         /* address len visibilità di alcuni menu                                                          */      
#define LEN_TIMEOUT_RANGE1_RW                   ((uint16_t)1)         /* address len valore di partenza contatore 1                                                     */           
#define LEN_TIMEOUT_RANGE2_RW                   ((uint16_t)1)         /* address len valore di partenza contatore 2                                                     */
#define LEN_PRODUCT_CODE_RW                     ((uint16_t)12)        /* address len Codice prodotto Scame                                                              */

/* Aggiunti per v18b Modbus */
#define LEN_TECN_PRODUCT_CODE_RW                ((uint16_t)10)        /* address len Codice prodotto Fake per algoritmo configuratore e SEM                             */
#define LEN_CONNECTOR_N_RW                      ((uint16_t)1)         /* address len Numero connettore basato sulla posizione nella EVSE                                */
#define LEN_DISPLAY_LANGUAGES_RW                ((uint16_t)2)         /* address len Lingua impostata e lingua di default della EVSE                                    */
#define LEN_MAX_TYPICAL_CURRENT_RW              ((uint16_t)1)         /* address len Corrente massima erogabile in modalità tipica (ex RSC_CURR_RO v18)                 */
#define LEN_MAX_SIMPLIFIED_CURRENT_RW           ((uint16_t)1)         /* address len Corrente massima erogabile in modalità semplificata                                */
#define LEN_CHARGE_BY_TIME_RW                   ((uint16_t)1)         /* address len Tempo di carica massimo                                                            */
#define LEN_CHARGE_BY_ENERGY_RW                 ((uint16_t)1)         /* address len Potenza massima di carica permessa                                                 */  
#define LEN_PM_IMIN_RW                          ((uint16_t)1)         /* address len Corrente minima erogabile in funzionalità di Power Management                      */
#define LEN_PM_PMAX_RW                          ((uint16_t)1)         /* address len Potenza massima erogabile in funzionalità di Power Management                      */
#define LEN_PM_FLAGS_RW                         ((uint16_t)1)         /* address len Flag di abilitazione Power Management                                              */
#define LEN_PM_HPOWER_RW                        ((uint16_t)1)         /* address len Valore di isteresi soglia di potenza Power Management                              */
#define LEN_PM_DSET_RW                          ((uint16_t)1)         /* address len Valore di variazione della potenza in erogazione verso l'EV                        */
#define LEN_PM_DMAX_RW                          ((uint16_t)1)         /* address len Valore di potenza in eccesso che può essere erogato dall'EVSE                      */
#define LEN_PIN_EXTERNAL_ENERGY_METER_RW        ((uint16_t)1)         /* address len Pin energy meter esterno                                                           */ 
#define LEN_LIM_MAX_POWER_AC_RW                 ((uint16_t)2)         /* address len per massima potenza in AC                                                          */ 
#define LEN_RESERVED_A                          ((uint16_t)10)        /* address len reserved                                                                           */  

#define LEN_FILE_COMMAND_RW                     ((uint16_t)1)         /* address len Comando per avviare l'aggiornamento SW                                             */           
#define LEN_FILE_SIZE_RW                        ((uint16_t)2)         /* address len Registro con indicazione della lunghezza del file da caricare                      */           
#define LEN_FILE_PACKET_RW                      ((uint16_t)1)         /* address len Registro con indicazione del numero di pacchetti da caricare                       */           
          
/****          definizioni lunghezze per l'ambiente SINAPSI - RSE ***************************************************************************************  */
#define LEN_IOM_CTRL_REG                        ((uint16_t)1)         /* address len Registro controllo per nuovi dati disponibili                                      */           
#define LEN_M2_POT_ATT_IMM_IST_TS               ((uint16_t)2)         /* address len time stamp potenza attiva immessa istantanea letta dal contatore M2                */           
#define LEN_M2_POT_ATT_IMM_IST                  ((uint16_t)1)         /* address len potenza attiva immessa istantanea letta dal contatore M2                           */           
#define LEN_M2_POT_CONTRATTUALE_TS              ((uint16_t)2)         /* address len time stamp potenza contrattuale del contatore M2                                   */           
#define LEN_M2_POT_CONTRATTUALE                 ((uint16_t)1)         /* address len potenza contrattuale del contatore M2                                              */           
#define LEN_M1_POT_CONTRATTUALE_TS              ((uint16_t)2)         /* address len time stamp potenza contrattuale del contatore M1                                   */           
#define LEN_M1_POT_CONTRATTUALE                 ((uint16_t)1)         /* address len potenza contrattuale del contatore M1                                              */           
#define LEN_M1_POT_DISPONIBILE_TS               ((uint16_t)2)         /* address len time stamp potenza disponibile  del contatore M1                                   */           
#define LEN_M1_POT_DISPONIBILE                  ((uint16_t)1)         /* address len potenza disponibile del contatore M1                                               */           
#define LEN_M1_POT_ATT_PRE_IST_TS               ((uint16_t)2)         /* address len time stamp potenza attiva prelevata istantanea  del contatore M1                   */           
#define LEN_M1_POT_ATT_PRE_IST                  ((uint16_t)1)         /* address len attiva prelevata istantanea  del contatore M1                                      */           
#define LEN_M1_POT_ATT_IMM_IST_TS               ((uint16_t)2)         /* address len time stamp potenza attiva immessa istantanea  del contatore M1                     */           
#define LEN_M1_POT_ATT_IMM_IST                  ((uint16_t)1)         /* address len attiva immessa istantanea  del contatore M1                                        */           
#define LEN_M1_DISTACCO_TS                      ((uint16_t)2)         /* address len time stamp da cui si calcola tempo di distacco al contatore M1                     */           
#define LEN_M1_TEMPO_RES_DIST                   ((uint16_t)1)         /* address len tempo residuo di distacco al   contatore M1                                        */           
#define LEN_M1_PROF_FASCIA_ORARIA_TS            ((uint16_t)2)         /* address len time stamp da cui parte la fascia oraria corrente al contatore M1                  */           
#define LEN_M1_PROF_FASCIA_ORARIA               ((uint16_t)1)         /* address len fascia oraria corrente  al   contatore M1                                          */           
#define LEN_M1_POT_TEMPO_LIMITE_TS              ((uint16_t)2)         /* address len time stamp dat e ora fino a cui si può ricaricare alla Pmaxt  al contatore M1      */           
#define LEN_M1_POT_MAX_RIC_TLIM                 ((uint16_t)1)         /* address len potenza massima Pmaxt di ricarica a tempo limitata al contatore M1                 */           
#define LEN_M1_SOSP_RIC_TLIM_TS                 ((uint16_t)2)         /* address len time stamp data e ora fino a cui è obbligatorio sospendere la carica al cnt M1     */           
#define LEN_M1_UNIXTIME_SYNC                    ((uint16_t)2)         /* address len sincronizzazione orologio formato unixtime tra IOM e SCU                           */           
#define LEN_SET_CONFIG_MODE                     ((uint16_t)1)         /* address len set configuration Bluetoth board SINAPSI                                           */ 

/****          definizioni lunghezze per simulatore EM LOVATO Ethernet   *********************************************************************************  */
#define LEN_EM_LOVATO_V_SYS                     ((uint16_t)2)         /* address registro tensione di fase L1                                                           */ 
#define LEN_EM_LOVATO_P_AREA                    ((uint16_t)48)        /* address registro potenza attiva delle prese                                                    */ 


/****          definizioni lunghezze per l'ambiente collaudo scheda PEN  *********************************************************************************  */
#define LEN_PEN_RELE_RWD                        ((uint16_t)1)         /* address registro comando relè                                                                  */ 

/****          definizioni lunghezze per l'ambiente Macchina di Collaudo *********************************************************************************  */
#define LEN_TM_MEASURED_CURRENT_RW              ((uint16_t)1)         /* address len Valore di corrente misurato dall'EM interno alla macchina di collaudo              */
#define LEN_TM_MEASURED_VOLTAGE_RW              ((uint16_t)1)         /* address len Valore di tensione misurato dall'EM interno alla macchina di collaudo              */
#define LEN_TM_EVSE_READY_RO                    ((uint16_t)1)         /* address len Flag per mostrare quando una EVSE è disponibile a proseguire con i test            */
#define LEN_TM_ADDR_S_CONN_RW                   ((uint16_t)1)         /* address len Flag per presenza slave collegata alla master                                      */
#define LEN_TM_ADDR_REQ_RW                      ((uint16_t)1)         /* address len richiesta indirizzamento automatico                                                */
#define LEN_TM_ADDR_ASS_RW                      ((uint16_t)1)         /* address len assegnazione indirizzamento automatico                                             */
#define LEN_ADDR_TM_ERROR1_RO                   ((uint16_t)1)         /* address len errori in fase di collaudo                                                         */
#define LEN_TM_UID_MASTER_RW                    ((uint16_t)4)         /* address len Valore campo UID carta Master                                                      */
#define LEN_TM_UID_USER_RW                      ((uint16_t)4)         /* address len Valore campo UID carta User                                                        */
#define LEN_TM_MEASURED_CURRENT_L2_RW           ((uint16_t)1)         /* address len Valore di corrente misurato dall'EM interno alla macchina di collaudo L2           */
#define LEN_TM_MEASURED_VOLTAGE_L2_RW           ((uint16_t)1)         /* address len Valore di tensione misurato dall'EM interno alla macchina di collaudo L2           */
#define LEN_TM_MEASURED_CURRENT_L3_RW           ((uint16_t)1)         /* address len Valore di corrente misurato dall'EM interno alla macchina di collaudo L3           */
#define LEN_TM_MEASURED_VOLTAGE_L3_RW           ((uint16_t)1)         /* address len Valore di tensione misurato dall'EM interno alla macchina di collaudo L3           */
#define LEN_TM_GET_EEPROM_RW                    ((uint16_t)1)         /* address len Valore per la richiesta parametri in EEPROM                                        */

/****          definizioni lunghezze per l'ambiente APP tecnica          *********************************************************************************  */
#define LEN_CONNECTOR_INIT_STATUS_RO            ((uint16_t)1)         /* address len Stato di attivazione della presa collegata alla App                                */
#define LEN_CONNECTOR_OPERATION_STATUS_RO       ((uint16_t)1)         /* address len Registro di stato Idle della presa, richiesto da Enrico per ios                    */  
#define LEN_PROCEDURE_RESPONSE_RO               ((uint16_t)2)         /* address len Registro contenente l'esito di una Procedura app-modulo Wi-Fi                      */
#define LEN_PM_TOTAL_POWER_RO                   ((uint16_t)2)         /* address len Registro potenza esterna misurata                                                  */
#define LEN_PM_L1_POWER_RO                      ((uint16_t)2)         /* address len Potenza esterna fase 1                                                             */
#define LEN_PM_L2_POWER_RO                      ((uint16_t)2)         /* address len Potenza esterna fase 2                                                             */
#define LEN_PM_L3_POWER_RO                      ((uint16_t)2)         /* address len Potenza esterna fase 3                                                             */
#define LEN_APP_LOGIN_USER_TYPE_RO              ((uint16_t)1)         /* address len Tipologia di utente cheha fatto il login                                           */          
#define LEN_CONNECTOR_CHECK_ACTIV_KEY_RW        ((uint16_t)3)         /* address len Controllo codice di attivazione della presa                                        */
#define LEN_CONNECTOR_NAME_RW                   ((uint16_t)7)         /* address len Nome presa scelto dall'utente                                                      */
#define LEN_CONNECTOR_PIN_RW                    ((uint16_t)3)         /* address len PIN presa scelto dall'utente in fase di inizializzazione                           */
#define LEN_ROUTER_NET_SSID_RW                  ((uint16_t)16)        /* address len SSID rete router domestico                                                         */
#define LEN_ROUTER_NET_PASSWORD_RW              ((uint16_t)32)        /* address len Password rete router domestico                                                     */
#define LEN_CONNECTOR_ROUTER_IP_RW              ((uint16_t)8)         /* address len IP modulo Wi-Fi scelto dal router domestico                                        */
#define LEN_PROCEDURE_REQUEST_RW                ((uint16_t)1)         /* address len Richiesta di una procedura dall App alla SCU                                       */
#define LEN_SCHEDULE_FLAG1_RW                   ((uint16_t)1)         /* address len Flag di attivazione della schedulazione numero 1                                   */
#define LEN_SCHEDULE_START1_RW                  ((uint16_t)1)         /* address len Orario di partenza della prima carica schedulata                                   */
#define LEN_SCHEDULE_STOP1_RW                   ((uint16_t)1)         /* address len Orario di stop della prima carica schedulata                                       */
#define LEN_SCHEDULE_POWER1_RW                  ((uint16_t)2)         /* address len Massima potenza impostabile per la schedulazione 1                                 */          
#define LEN_SCHEDULE_FLAG2_RW                   ((uint16_t)1)         /* address len Flag di attivazione della schedulazione numero 2                                   */
#define LEN_SCHEDULE_START2_RW                  ((uint16_t)1)         /* address len Orario di partenza della seconda carica schedulata                                 */
#define LEN_SCHEDULE_STOP2_RW                   ((uint16_t)1)         /* address len Orario di stop della seconda carica schedulata                                     */
#define LEN_SCHEDULE_POWER2_RW                  ((uint16_t)2)         /* address len Massima potenza impostabile per la schedulazione 2                                 */
#define LEN_SCHEDULE_FLAG3_RW                   ((uint16_t)1)         /* address len Flag di attivazione della schedulazione numero 3                                   */
#define LEN_SCHEDULE_START3_RW                  ((uint16_t)1)         /* address len Orario di partenza della terza carica schedulata                                   */
#define LEN_SCHEDULE_STOP3_RW                   ((uint16_t)1)         /* address len Orario di stop della terza carica schedulata                                       */
#define LEN_SCHEDULE_POWER3_RW                  ((uint16_t)2)         /* address len Massima potenza impostabile per la schedulazione 3                                 */
#define LEN_SCHEDULE_FLAG4_RW                   ((uint16_t)1)         /* address len Flag di attivazione della schedulazione numero 4                                   */
#define LEN_SCHEDULE_START4_RW                  ((uint16_t)1)         /* address len Orario di partenza della quarta carica schedulata                                  */
#define LEN_SCHEDULE_STOP4_RW                   ((uint16_t)1)         /* address len Orario di stop della quarta carica schedulata                                      */
#define LEN_SCHEDULE_POWER4_RW                  ((uint16_t)2)         /* address len Massima potenza impostabile per la schedulazione 4                                 */
#define LEN_CONNECTOR_CONNECTION_STATUS_RO      ((uint16_t)1)         /* address len Stato di connessione alla rete di un router                                        */                
#define LEN_MAX_POWER_RO                        ((uint16_t)2)         /* address len Massima potenza per settaggio tachimetro APP                                       */                  
#define LEN_RANDOM_DELAY_FLAG_RW                ((uint16_t)1)         /* address len abilitazione/disabilitazione schedulazioni                                         */                  
#define LEN_UID_AUTHORIZATION_APP_RW            ((uint16_t)5)         /* address len uid autorizzazione da app                                                          */        
#define LEN_BT_SINAPSI_STATUS_RW                ((uint16_t)1)         /* address len Stato del bluetooth Sinapsi                                                        */                              
#define LEN_FW_UPDATE_NAME_RW                   ((uint16_t)9)         /* address len nome fimrware da aggiornare                                                        */
#define LEN_FW_UPDATE_LEN_RW                    ((uint16_t)2)         /* address len lunghezza firmware da aggiornare                                                   */ 
#define LEN_FW_UPDATE_STATUS_RO                 ((uint16_t)1)         /* address len esito firmware update                                                              */                                
#define LEN_EVSE_POWER_MODE_RO                  ((uint16_t)1)         /* address len alimentazione stazione di ricarica                                                 */
#define LEN_PM_PARAMETERS_RO                    ((uint16_t)6)         /* address len Power Management parameters                                                        */

#define LEN_APP_EXCHANGE_AREA_RO                ((uint16_t)255)       /* len of area used by App to exchange datas with SCU */

/****          definizioni indirizzi per l'ambiente SCU-SEM        ***************************************************************************************  */
#define ADDR_START_RDD                          ((uint16_t)0x0300)                                                                 /* start address per read only register RIR function 04                 */                                 
#define ADDR_BOARD_FW_VERSION_RO                (ADDR_START_RDD                         + 0                                     )  /* address Campo ASCII contenente la versione del main firmware  0x0302 */                                 
#define ADDR_MIFARE_FW_VERSION_RO               (ADDR_BOARD_FW_VERSION_RO               + LEN_BOARD_FW_VERSION_RO               )  /* address Versione FW del lettore RFID                                 */         
#define ADDR_BOARD_SN_RO                        (ADDR_MIFARE_FW_VERSION_RO              + LEN_MIFARE_FW_VERSION_RO              )  /* address Numero di serie della scheda                                 */         
#define ADDR_PLC_FW_VERSION_RO                  (ADDR_BOARD_SN_RO                       + LEN_BOARD_SN_RO                       )  /* address Campo ASCII versione FW del modulo PLC (solo stazione DC)    */         
#define ADDR_PLC_MAC_ADDRESS_RO                 (ADDR_PLC_FW_VERSION_RO                 + LEN_PLC_FW_VERSION_RO                 )  /* address MAC address lendel modulo PLC (solo stazione DC)             */         
#define ADDR_HW_REVISION_RO                     (ADDR_PLC_MAC_ADDRESS_RO                + LEN_PLC_MAC_ADDRESS_RO                )  /* address Versione hardware della SCU                                  */
#define ADDR_WIFI_MAC_ADDRESS_RO                (ADDR_HW_REVISION_RO                    + LEN_HW_REVISION_RO                    )  /* address Indirizzo MAC del modulo Wi-Fi                               */
#define ADDR_POWER_MODULE_SN_RO                 (ADDR_WIFI_MAC_ADDRESS_RO               + LEN_WIFI_MAC_ADDRESS_RO               )  /* address Numero di serie del modulo di potenza                        */
#define ADDR_BLE_MAC_ADDRESS_RO                 (ADDR_POWER_MODULE_SN_RO                + LEN_POWER_MODULE_SN_RO                )  /* address Indirizzo MAC del modulo Bluetooth                           */
#define ADDR_PRODUCT_SN_RO                      (ADDR_BLE_MAC_ADDRESS_RO                + LEN_BLE_MAC_ADDRESS_RO                )  /* address Numero di serie prodotto finito                              */
#define ADDR_PRODUCT_CODE_RO                    (ADDR_PRODUCT_SN_RO                     + LEN_PRODUCT_SN_RO                     )  /* address Codice prodotto SCAME                                        */
#define ADDR_BOOT_FW_VERSION_RO                 (ADDR_PRODUCT_CODE_RO                   + LEN_PRODUCT_CODE_RO                   )  /* address boot firmware version                                        */
#define ADDR_MODBUS_VERSION_RO                  (ADDR_BOOT_FW_VERSION_RO                + LEN_BOOT_FW_VERSION_RO                )  /* address modbus  version                                        */
#define ADDR_SCU_RESERVED1                      (ADDR_MODBUS_VERSION_RO                 + LEN_MODBUS_VERSION_RO                 )  /* address Reserved for future use                                      */         

#define ADDR_NOTIFY_EVSE_PRESENCE_RO            ((uint16_t)0x0400                       + 0)                                       /* address Indica quanti e quali indirizzi sono presenti nel sistema    */         
#define ADDR_NOTIFY_EVSE_CHANGE_RO              (ADDR_NOTIFY_EVSE_PRESENCE_RO           + LEN_NOTIFY_EVSE_PRESENCE_RO           )  /* address Registro per segnalare un cambiamento di stato (prevedere autocleaning)          */         
#define ADDR_EVSE_ERROR1_RO                     (ADDR_NOTIFY_EVSE_CHANGE_RO             + LEN_NOTIFY_EVSE_CHANGE_RO             )  /* address Registro 1 per segnalare allarmi e/o errori                  */         
#define ADDR_EVSE_ERROR2_RO                     (ADDR_EVSE_ERROR1_RO                    + LEN_EVSE_ERROR1_RO                    )  /* address Registro 2 per segnalare allarmi e/o errori                  */         
#define ADDR_EVSE_CHANGE_REGISTERS_RO           (ADDR_EVSE_ERROR2_RO                    + LEN_EVSE_ERROR2_RO                    )  /* address contiene l'indirizzo del registro cambiato per ogni singola scheda               */         
#define ADDR_SCU_RESERVED2                      (ADDR_EVSE_CHANGE_REGISTERS_RO          + LEN_EVSE_CHANGE_REGISTERS_RO          )  /* address Reserved for future use                                      */         

/****          definizioni indirizzi per l'APP local (Read-Only)        ***************************************************************************************  */
#define ADDR_APP_EXCHANGE_AREA_RO               ((uint16_t)0x0500                       + 0)                                      /* address of exchange area used for App local                          */         

#define ADDR_EVSE_EVENT_FLAGS_RO                ((uint16_t)0x0600                       + 0                                     )  /* address contiene lo stato del connettore tethered                    */         
#define ADDR_EVSE_CHARGE_STATUS_RO              (ADDR_EVSE_EVENT_FLAGS_RO               + LEN_EVSE_EVENT_FLAGS_RO               )  /* registro che notifica lo stato della stazione                        */         
#define ADDR_TEMPERATURE_SYSTEM_RO              (ADDR_EVSE_CHARGE_STATUS_RO             + LEN_EVSE_CHARGE_STATUS_RO             )  /* address temperatura del sistema (quella rilevata dal uP nel caso AC) */ 
#define ADDR_SCU_RESERVED3                      (ADDR_TEMPERATURE_SYSTEM_RO             + LEN_TEMPERATURE_SYSTEM_RO             )  /* address Reserved for DC system                                       */         
#define ADDR_DC_RESERVED3_END                   (ADDR_SCU_RESERVED3                     + LEN_RESERVED3_RDD                     )  /* address Reserved for DC system                                       */         

#define ADDR_VOLTAGE_AC_RO                      (ADDR_SCU_RESERVED3                     + LEN_RESERVED3_RDD                     )  /* 0x060E address Tensione di alimentazione del sistema (parametro OCCP)*/         
#define ADDR_CURRENT_AC_L1_RO                   (ADDR_VOLTAGE_AC_RO                     + LEN_VOLTAGE_AC_RO                     )  /* address Corrente fase 1 (parametro OCCP)                             */         
#define ADDR_CURRENT_AC_L2_RO                   (ADDR_CURRENT_AC_L1_RO                  + LEN_CURRENT_AC_L1_RO                  )  /* address Corrente fase 2 (parametro OCCP)                             */         
#define ADDR_CURRENT_AC_L3_RO                   (ADDR_CURRENT_AC_L2_RO                  + LEN_CURRENT_AC_L2_RO                  )  /* address Corrente fase 3 (parametro OCCP)                             */         
#define ADDR_ACTIVE_POWER_DC_RO                 (ADDR_CURRENT_AC_L3_RO                  + LEN_CURRENT_AC_L3_RO                  )  /* address Sommatoria delle correnti                                    */       
#define ADDR_ACTIVE_POWER_AC_RO                 (ADDR_ACTIVE_POWER_DC_RO                + LEN_ACTIVE_POWER_DC                   )  /* address Potenza attiva del sistema     (parametro OCCP)                          */       
#define ADDR_ACTIVE_POWER_AC_L1_RO              (ADDR_ACTIVE_POWER_AC_RO                + LEN_ACTIVE_POWER_AC_RO                )  /* address potenza attiva fase 1                                        */              
#define ADDR_REACTIVE_POWER_AC_RO               (ADDR_ACTIVE_POWER_AC_L1_RO             + LEN_ACTIVE_POWER_AC_L1_RO             )  /* address Potenza reattiva del sistema   (parametro OCCP)              */       
#define ADDR_TOTAL_ACTIVE_ENERGY_AC_EV_RO       (ADDR_REACTIVE_POWER_AC_RO              + LEN_REACTIVE_POWER_AC_RO              )  /* address Energia attiva del sistema     (parametro OCCP)              */       
#define ADDR_TOTAL_ACTIVE_ENERGY_DC_EV_RO       (ADDR_TOTAL_ACTIVE_ENERGY_AC_EV_RO      + LEN_TOTAL_ACTIVE_ENERGY_AC_EV_RO      )  /* address Energia apparente del sistema  (parametro OCCP)              */       
#define ADDR_TOTAL_REACTIVE_ENERGY_AC_EV_RO     (ADDR_TOTAL_ACTIVE_ENERGY_DC_EV_RO      + LEN_TOTAL_ACTIVE_ENERGY_DC_EV_RO      )  /* address Energia reattiva del sistema   (parametro OCCP)              */       
#define ADDR_TRANSACTION_ACTIVE_ENERGY_AC_EV_RO (ADDR_TOTAL_REACTIVE_ENERGY_AC_EV_RO    + LEN_TOTAL_REACTIVE_ENERGY_AC_EV_RO    )  /* address Energia attiva parziale relativa alla sessione corrente    (parametro OCCP)      */       
#define ADDR_ACTIVE_POWER_AC_L2_RO              (ADDR_TRANSACTION_ACTIVE_ENERGY_AC_EV_RO   + LEN_TRANSACTION_ACTIVE_ENERGY_AC_EV_RO)  /* address potenza attiva fase 2                                 */       
#define ADDR_TRANSACTION_REACTIVE_ENERGY_AC_EV_RO  (ADDR_ACTIVE_POWER_AC_L2_RO          + LEN_ACTIVE_POWER_AC_L2_RO             )  /* address Energia reattiva parziale relativa alla sessione corrente  (parametro OCCP)      */       
#define ADDR_FREQUENCY_SUPPLY_RO                (ADDR_TRANSACTION_REACTIVE_ENERGY_AC_EV_RO + LEN_TRANSACTION_REACTIVE_ENERGY_AC_EV_RO )  /* address Frequenza di rete     (parametro OCCP)                       */       
#define ADDR_SCU_RESERVED4                      (ADDR_FREQUENCY_SUPPLY_RO               + LEN_FREQUENCY_SUPPLY_RO               )  /* address Reserved (usati per stazione DC)                             */       
#define ADDR_DC_RESERVED4_END                   (ADDR_SCU_RESERVED4                     + LEN_RESERVED4_RDD                     )  /* address Reserved for DC system                                       */         

#define ADDR_MAX_CURRENT_ROTATORY_SWITCH_RO     (ADDR_SCU_RESERVED4                     + LEN_RESERVED4_RDD                     )  /* 0x0635 address Corrente impostata nel selettore rotativo             */       
#define ADDR_UNDEFINED_EX_RSC_CURR_RDD          (ADDR_MAX_CURRENT_ROTATORY_SWITCH_RO    + LEN_MAX_CURRENT_ROTATORY_SWITCH_RO    )  /* address Corrente massima di sistema                                  */       
#define ADDR_ACTIVE_POWER_AC_L3_RO              (ADDR_UNDEFINED_EX_RSC_CURR_RDD         + LEN_UNDEFINED_EX_RSC_CURR_RDD         )  /* address potenza attiva fase 3                                        */       
#define ADDR_EMPTY_063A                         (ADDR_ACTIVE_POWER_AC_L3_RO             + LEN_ACTIVE_POWER_AC_L3_RO             )  /* address of a empty register                                          */
#define ADDR_MAX_CURRENT_RESULT_RO              (ADDR_EMPTY_063A                        + LEN_EMPTY_063A                        )  /* address Corrente massima di carica risultante dai vari calcoli e confronti*/       
#define ADDR_TRANSACTION_TIME_RO                (ADDR_MAX_CURRENT_RESULT_RO             + LEN_MAX_CURRENT_RESULT_RO             )  /* address Tempo in secondi, trascorsi dall'inizio della carica         */       
#define ADDR_TRANSACTION_COUNTDOWN_RO           (ADDR_TRANSACTION_TIME_RO               + LEN_TRANSACTION_TIME_RO               )  /* address Tempo, in secondi, rimanenti al completamento della carica   */       
#define ADDR_EV_BATTERY_RO                      (ADDR_TRANSACTION_COUNTDOWN_RO          + LEN_TRANSACTION_COUNTDOWN_RO          )  /* address percentuale della carica della batteria  (parametro OCCP)    */       
#define ADDR_SESSION_ID_RO                      (ADDR_EV_BATTERY_RO                     + LEN_EV_BATTERY_RO                     )  /* address percentuale della carica della batteria  (parametro OCCP)    */       
#define ADDR_EVSE_BOOT_EVENT_RO                 (ADDR_SESSION_ID_RO                     + LEN_SESSION_ID_RO                     )  /* address flag di notifica reset di sistema                            */       
#define ADDR_TOTAL_ACTIVE_ENERGY_AC_GRID_RO     (ADDR_EVSE_BOOT_EVENT_RO                + LEN_EVSE_BOOT_EVENT_RO                )  /* address Energia attiva totale funzione GRID V2G                      */
#define ADDR_TOTAL_REACTIVE_ENERGY_AC_GRID_RO   (ADDR_TOTAL_ACTIVE_ENERGY_AC_GRID_RO    + LEN_TOTAL_ACTIVE_ENERGY_AC_GRID_RO    )  /* address Energia reattiva totale funzione GRID V2G                    */
#define ADDR_TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO   (ADDR_TOTAL_REACTIVE_ENERGY_AC_GRID_RO     + LEN_TOTAL_REACTIVE_ENERGY_AC_GRID_RO       )  /* address Energia attiva della transazione funzione GRID V2G           */
#define ADDR_TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO (ADDR_TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO + LEN_TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO   )  /* address Energia Reattiva della transazione funzione GRID V2G         */
#define ADDR_SCU_RESERVED6                      (ADDR_TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO   + LEN_TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO )  /* address -------------- Fine dei parametri Read-Only si passa a quelli RW --------------  */       
#define ADDR_UID_AUTHORIZATION_RO               (ADDR_SCU_RESERVED6                     + LEN_SCU_RESERVED6                     )  /* address valore UID della card letta                                  */       
#define ADDR_TIME_IN_CHARGE_RO                  (ADDR_UID_AUTHORIZATION_RO              + LEN_UID_AUTHORIZATION_RO              )  /* address valore tempo di carica vera (con passaggio di corrente)      */
#define ADDR_SCU_RESERVED6B                     (ADDR_TIME_IN_CHARGE_RO                 + LEN_TIME_IN_CHARGE_RO                 )  /* address valore UID della card letta                                  */

#define ADDR_CONNECTOR_TYPE_RW                  ((uint16_t)0x0000                       + 0                                     )  /* address Registro per modificare configurazione Hardware              */       
#define ADDR_HWC_FLAGS_RW                       (ADDR_CONNECTOR_TYPE_RW                 + LEN_CONNECTOR_TYPE_RW                 )  /* 1 address Hardware flags per presenza/assenza componenti               */                
#define ADDR_ENERGY_METERS_RW                   (ADDR_HWC_FLAGS_RW                      + LEN_HWC_FLAGS_RW                      )  /* 2 address Modifica indirizzo modbus usato come alias della scheda      */       
#define ADDR_POWER_OUTAGE_HW_RW                 (ADDR_ENERGY_METERS_RW                  + LEN_ENERGY_METERS_RW                  )  /* 3 address Tipo di hardware installato per l'assenza di tensione        */
#define ADDR_CONNECTOR_IDS_RW                   (ADDR_POWER_OUTAGE_HW_RW                + LEN_POWER_OUTAGE_HW_RW                )  /* 4 address Modifica indirizzo modbus usato come alias della scheda      */       
#define ADDR_BOARD_SN_RW                        (ADDR_CONNECTOR_IDS_RW                  + LEN_CONNECTOR_IDS_RW                  )  /* 5 address Numero di serie della stazione                               */       
#define ADDR_PRODUCT_SN_RW                      (ADDR_BOARD_SN_RW                       + LEN_BOARD_SN_RW                       )  /* 13 address Numero di serie del prodotto                                 */       
#define ADDR_MASTER_HARDWARE_TYPE_RW            (ADDR_PRODUCT_SN_RW                     + LEN_PRODUCT_SN_RW                     )  /* 21 address Configurazione master / slave                                */       
#define ADDR_UTC_DATE_TIME_RW                   (ADDR_MASTER_HARDWARE_TYPE_RW           + LEN_MASTER_HARDWARE_TYPE_RW           )  /* 22 address data e ora correnti letti da RTC                             */       
#define ADDR_POWER_MODULE_BRAND_RW              (ADDR_UTC_DATE_TIME_RW                  + LEN_UTC_DATE_TIME_RW                  )  /* 31 address Indica la marca del produttore del caricabatteria (solo DC)  */       
#define ADDR_POWER_MODULE_MODEL_RW              (ADDR_POWER_MODULE_BRAND_RW             + LEN_POWER_MODULE_BRAND_RW             )  /* 32 address Indica la marca del modello del caricabatteria (solo DC)     */       
#define ADDR_POWER_MODULE_N_RW                  (ADDR_POWER_MODULE_MODEL_RW             + LEN_POWER_MODULE_MODEL_RW             )  /* 33 address Indica il numero di moduli installati al sistema  (solo DC)  */       
#define ADDR_EVSE_TM_RW                         (ADDR_POWER_MODULE_N_RW                 + LEN_POWER_MODULE_N_RW                 )  /* 34 address Abilitazione prese e stazione alla ricarica                  */       
#define ADDR_EVSE_OPERATION_MODE_RW             (ADDR_EVSE_TM_RW                        + LEN_EVSE_TM_MODE_RW                   )  /* address In dica la modalità di funzionamento del sistema di ricarica */       
#define ADDR_CHARGE_PROTOCOL_SELECTED_RW        (ADDR_EVSE_OPERATION_MODE_RW            + LEN_EVSE_OPERATION_MODE_RW            )  /* address Indica con quale connettore effettuare la ricarica (solo DC) */       
#define ADDR_DISPLAY_DEFAULT_LANGUAGE_RW        (ADDR_CHARGE_PROTOCOL_SELECTED_RW       + LEN_CHARGE_PROTOCOL_SELECTED_RW       )  /* address Indica la lingua utilizzata dal sistema                      */
#define ADDR_HW_CHECKS1_RW                      (ADDR_DISPLAY_DEFAULT_LANGUAGE_RW       + LEN_DISPLAY_DEFAULT_LANGUAGE_RW       )  /* address Registro per abilitazione errori                             */                                 
#define ADDR_HW_CHECKS2_RW                      (ADDR_HW_CHECKS1_RW                     + LEN_HW_CHECKS1_RW                     )  /* address Registro per abilitazione errori                             */                                 
#define ADDR_HW_ACTUATORS_RW                    (ADDR_HW_CHECKS2_RW                     + LEN_HW_CHECKS2_RW                     )  /* address Registro per la configurazione degli attuatori del sistema   */                                 
#define ADDR_SCU_RESERVED7                      (ADDR_HW_ACTUATORS_RW                   + LEN_HW_ACTUATORS_RW                   )  /* address Imposta la corrente massima DC disponibile nel sistema       */

#define ADDR_MAX_TEMPORARY_CURRENT_RW           (ADDR_SCU_RESERVED7                     + LEN_SCU_RESERVED7                     )  /* address Parametro PID per sistema AC                                 */           
#define ADDR_LEN_EMPTY_0033_RW_RWD              (ADDR_MAX_TEMPORARY_CURRENT_RW          + LEN_MAX_TEMPORARY_CURRENT_RW          )  /* address Imposta la corrente minima di ricarica                       */           
#define ADDR_LED_STRIP_RW                       (ADDR_LEN_EMPTY_0033_RW_RWD             + LEN_EMPTY_0033_RW                     )  /* address Registro utilizzato per impostare la sospensione della carica*/           
#define ADDR_REMOTE_COMMANDS_RW                 (ADDR_LED_STRIP_RW                      + LEN_LED_STRIP_RW                      )  /* address Emulazione stato pressione del pulsante remoto               */           
#define ADDR_ENVIRONMENT_BRIGHTNESS_RW          (ADDR_REMOTE_COMMANDS_RW                + LEN_REMOTE_COMMANDS_RW                )  /* address Valore di luminosità letto dal sensore                       */           
#define ADDR_MIN_POWER_DC_RWD                   (ADDR_ENVIRONMENT_BRIGHTNESS_RW         + LEN_ENVIRONMENT_BRIGHTNESS_RW         )  /* address Indica la distanza rilevata dal sensore                      */           
#define ADDR_UNDEFINED_EX_PRX_MOTION_RWD        (ADDR_MIN_POWER_DC_RWD                  + LEN_MIN_POWER_DC_RWD                  )  /* address Registro flag che indica presenza di movimento rilevata      */           
#define ADDR_MAX_TEMPORARY_POWER_AC             (ADDR_UNDEFINED_EX_PRX_MOTION_RWD       + LEN_UNDEFINED_EX_PRX_MOTION_RWD       )  /* address Parametro per impostare il PWM dei led esterni alla stazione di ricarica RGB     */           
#define ADDR_PM_MODE_RW                         (ADDR_MAX_TEMPORARY_POWER_AC            + LEN_MAX_TEMPORARY_POWER_AC            )  /* address registro utilizzato modalità Power management                */           
#define ADDR_ENABLE_LOG_RW                      (ADDR_PM_MODE_RW                        + LEN_PM_MODE_RW                        )  /* address abilitazione log su SD (solo DC)                             */           
#define ADDR_AUTHORIZATION_FEEDBACK_RW          (ADDR_ENABLE_LOG_RW                     + LEN_ENABLE_LOG_RW                     )  /* address in modalità NET autorizza e controlla la carica              */           
#define ADDR_TIMEZONE_RW                        (ADDR_AUTHORIZATION_FEEDBACK_RW         + LEN_AUTHORIZATION_FEEDBACK_RW         )  /* address time zone rispetto a UTC                                     */           
#define ADDR_MENU_VISIBILITY_RW                 (ADDR_TIMEZONE_RW                       + LEN_TIMEZONE_RW                       )  /* address EX LIM_POWER_AC_RW                                           */     
#define ADDR_TIMEOUT_RANGE1_RW                  (ADDR_MENU_VISIBILITY_RW                + LEN_MENU_VISIBILITY_RW                )  /* address per il valore di partenza del contatore T1                   */           
#define ADDR_TIMEOUT_RANGE2_RW                  (ADDR_TIMEOUT_RANGE1_RW                 + LEN_TIMEOUT_RANGE1_RW                 )  /* address per il valore di partenza del contatore T2                   */           
#define ADDR_PRODUCT_CODE_RW                    (ADDR_TIMEOUT_RANGE2_RW                 + LEN_TIMEOUT_RANGE2_RW                 )  /* address Codice prodotto SCAME                                        */           
#define ADDR_TECN_PRODUCT_CODE_RW               (ADDR_PRODUCT_CODE_RW                   + LEN_PRODUCT_CODE_RW                   )  /* address Codice FAKE prodotto SCAME                                   */ 
#define ADDR_CONNECTOR_N_RW                     (ADDR_TECN_PRODUCT_CODE_RW              + LEN_TECN_PRODUCT_CODE_RW              )  /* address Numero connettore nella EVSE                                 */     
#define ADDR_DISPLAY_LANGUAGES_RW               (ADDR_CONNECTOR_N_RW                    + LEN_CONNECTOR_N_RW                    )  /* address Lingua impostata e lingua di default                         */
#define ADDR_MAX_TYPICAL_CURRENT_RW             (ADDR_DISPLAY_LANGUAGES_RW              + LEN_DISPLAY_LANGUAGES_RW              )  /* address Massima corrente in modalità tipica impostata                */
#define ADDR_MAX_SIMPLIFIED_CURRENT_RW          (ADDR_MAX_TYPICAL_CURRENT_RW            + LEN_MAX_TYPICAL_CURRENT_RW            )  /* address Massima corrente in modalità semplificata                    */
#define ADDR_CHARGE_TIME_RW                     (ADDR_MAX_SIMPLIFIED_CURRENT_RW         + LEN_MAX_SIMPLIFIED_CURRENT_RW         )  /* address Flag per presenza componenti hardware (Wi-Fi, BT...)         */
#define ADDR_CHARGE_MAX_ENERGY_RW               (ADDR_CHARGE_TIME_RW                    + LEN_CHARGE_BY_TIME_RW                 )  /* address Tempo massimo di una carica                                  */
#define ADDR_PM_IMIN_RW                         (ADDR_CHARGE_MAX_ENERGY_RW              + LEN_CHARGE_BY_ENERGY_RW               )  /* address Corrente minima erogabile con funzione Power Management      */
#define ADDR_PM_PMAX_RW                         (ADDR_PM_IMIN_RW                        + LEN_PM_IMIN_RW                        )  /* address Potenza massima erogabile con funzione Power Management      */
#define ADDR_PM_FLAGS_RW                        (ADDR_PM_PMAX_RW                        + LEN_PM_PMAX_RW                        )  /* address Flag di abilitazione funzione Power Management               */
#define ADDR_PM_HPOWER_RW                       (ADDR_PM_FLAGS_RW                       + LEN_PM_FLAGS_RW                       )  /* address Isteresi massima di potenza erogabile Power Management       */
#define ADDR_PM_DSET_RW                         (ADDR_PM_HPOWER_RW                      + LEN_PM_HPOWER_RW                      )  /* address Variazione della potenza in erogazione verso l'EV            */
#define ADDR_PM_DMAX_RW                         (ADDR_PM_DSET_RW                        + LEN_PM_DSET_RW                        )  /* address Valore di isteresi potenza in eccesso erogata dall'EVSE      */     
#define ADDR_PIN_EXTERNAL_ENERGY_METER_RW       (ADDR_PM_DMAX_RW                        + LEN_PM_DMAX_RW                        )  /* address pin energy meter esterno                                     */                
#define ADDR_LIM_MAX_POWER_AC_RW                (ADDR_PIN_EXTERNAL_ENERGY_METER_RW      + LEN_PIN_EXTERNAL_ENERGY_METER_RW      )  /* address max power AC                                      */                
#define ADDR_RESERVED_A                         (ADDR_LIM_MAX_POWER_AC_RW               + LEN_LIM_MAX_POWER_AC_RW               )  /* address reserved for future use                                      */           

#define ADDR_FILE_COMMAND_RW                    ((uint16_t)0x0100                       + 0                                     )  /* address Comando per avviare l'aggiornamento SW                                           */           
#define ADDR_FILE_SIZE_RW                       (ADDR_FILE_COMMAND_RW                   + LEN_FILE_COMMAND_RW                   )  /* address Registro con indicazione dello stato di aggiornamento firmware                   */           
#define ADDR_FILE_PACKET_RW                     (ADDR_FILE_SIZE_RW                      + LEN_FILE_SIZE_RW                      )  /* address last rw register    */           
#define ADDR_END_RW_REGS_WO                     (ADDR_FILE_PACKET_RW                    + LEN_FILE_PACKET_RW                    )  /* address last rw register    */           

/****          definizioni indirizzi per l'ambiente RSE-SINAPSI                          ***************************************************************************************  */
#define ADDR_RSE_IOM_CTRL_REG                   ((uint16_t)0x0800                       + 0                                     ) /* address registro di controllo per SINAPSI-RSE                               */           
#define ADDR_RSE_M2_POT_ATT_IMM_IST_TS          (ADDR_RSE_IOM_CTRL_REG                  + LEN_IOM_CTRL_REG                      ) /* address time stamp potenza attiva immessa istantanea letta dal contatore M2 */           
#define ADDR_RSE_M2_POT_ATT_IMM_IST             (ADDR_RSE_M2_POT_ATT_IMM_IST_TS         + LEN_M2_POT_ATT_IMM_IST_TS             ) /* address  potenza attiva immessa istantanea letta dal contatore M2           */           
#define ADDR_RSE_M2_POT_CONTRATTUALE_TS         (ADDR_RSE_M2_POT_ATT_IMM_IST            + LEN_M2_POT_ATT_IMM_IST                ) /* address time stamp potenza contrattuale del contatore M2                    */           
#define ADDR_RSE_M2_POT_CONTRATTUALE            (ADDR_RSE_M2_POT_CONTRATTUALE_TS        + LEN_M2_POT_CONTRATTUALE_TS            ) /* address potenza contrattuale del contatore M2                               */           
#define ADDR_RSE_M1_POT_CONTRATTUALE_TS         (ADDR_RSE_M2_POT_CONTRATTUALE           + LEN_M2_POT_CONTRATTUALE               ) /* address time stamp potenza contrattuale del contatore M1                    */           
#define ADDR_RSE_M1_POT_CONTRATTUALE            (ADDR_RSE_M1_POT_CONTRATTUALE_TS        + LEN_M1_POT_CONTRATTUALE_TS            ) /* address potenza contrattuale del contatore M1                               */           
#define ADDR_RSE_M1_POT_DISPONIBILE_TS          (ADDR_RSE_M1_POT_CONTRATTUALE           + LEN_M1_POT_CONTRATTUALE               ) /* address time stamp potenza disponibile  del contatore M1                    */           
#define ADDR_RSE_M1_POT_DISPONIBILE             (ADDR_RSE_M1_POT_DISPONIBILE_TS         + LEN_M1_POT_DISPONIBILE_TS             ) /* address potenza disponibile  del contatore M1                               */           
#define ADDR_RSE_M1_POT_ATT_PRE_IST_TS          (ADDR_RSE_M1_POT_DISPONIBILE            + LEN_M1_POT_DISPONIBILE                ) /* address time stamp potenza attiva prelevata istantanea al contatore M1      */           
#define ADDR_RSE_M1_POT_ATT_PRE_IST             (ADDR_RSE_M1_POT_ATT_PRE_IST_TS         + LEN_M1_POT_ATT_PRE_IST_TS             ) /* address potenza attiva prelevata istantanea al contatore M1                 */           
#define ADDR_RSE_M1_POT_ATT_IMM_IST_TS          (ADDR_RSE_M1_POT_ATT_PRE_IST            + LEN_M1_POT_ATT_PRE_IST                ) /* address time stamp potenza attiva immessa istantanea al contatore M1        */           
#define ADDR_RSE_M1_POT_ATT_IMM_IST             (ADDR_RSE_M1_POT_ATT_IMM_IST_TS         + LEN_M1_POT_ATT_IMM_IST_TS             ) /* address potenza attiva immessa istantanea al contatore M1                   */           
#define ADDR_RSE_M1_RES_DISTACCO_TS             (ADDR_RSE_M1_POT_ATT_IMM_IST            + LEN_M1_POT_ATT_IMM_IST                ) /* address time stamp da cui si calcola il tempo di distacco al contatore M1   */           
#define ADDR_RSE_M1_TEMPO_RES_DIST              (ADDR_RSE_M1_RES_DISTACCO_TS            + LEN_M1_DISTACCO_TS                    ) /* address tempo di distacco al contatore M1                                   */           
#define ADDR_RSE_M1_PROF_FASCIA_ORARIA_TS       (ADDR_RSE_M1_TEMPO_RES_DIST             + LEN_M1_TEMPO_RES_DIST                 ) /* address time stamp da cui parte la fascia oraria corrente al contatore M1   */           
#define ADDR_RSE_M1_PROF_FASCIA_ORARIA          (ADDR_RSE_M1_PROF_FASCIA_ORARIA_TS      + LEN_M1_PROF_FASCIA_ORARIA_TS          ) /* address tempo di distacco al contatore M1                                   */           
#define ADDR_RSE_M1_POT_MAX_RIC_TLIM            (ADDR_RSE_M1_PROF_FASCIA_ORARIA         + LEN_M1_PROF_FASCIA_ORARIA             ) /* address potenza massima Pmaxt di ricarica a tempo limitato al contatore M1  */           
#define ADDR_RSE_M1_POT_TEMPO_LIMITE_TS         (ADDR_RSE_M1_POT_MAX_RIC_TLIM           + LEN_M1_POT_MAX_RIC_TLIM               ) /* address time stamp, data-ora fino a cui si può ricaricare a Pmaxt           */           
#define ADDR_RSE_M1_SOSP_RIC_TLIM_TS            (ADDR_RSE_M1_POT_TEMPO_LIMITE_TS        + LEN_M1_POT_TEMPO_LIMITE_TS            ) /* address time stamp, data-ora fino a cui è obbligatorio sospendere la carica */           
#define ADDR_RSE_M1_UNIXTIME_SYNC               (ADDR_RSE_M1_SOSP_RIC_TLIM_TS           + LEN_M1_SOSP_RIC_TLIM_TS               ) /* address sincronizzazione orologio nel formato unixtime                      */           
#define ADDR_RSE_SET_CONFIG_MODE                (ADDR_RSE_M1_UNIXTIME_SYNC              + LEN_M1_UNIXTIME_SYNC                  ) /* address set configuration Bluetooth board SINAPSI                           */ 
#define ADDR_RSE_END_RW_REGS                    (ADDR_RSE_SET_CONFIG_MODE               + LEN_SET_CONFIG_MODE                   ) /* address last RSE rw register                                                */           

/****          definizioni indirizzi per l'ambiente collaudo PEN  (ultimo indirizzo precedente 0x081F)  *******************************************************  */
#define ADDR_PEN_RELE_REG                       ((uint16_t)0x0500                       + 0                                     ) /* address registro di controllo per SINAPSI-RSE                               */           
#define ADDR_PEN_RELE_END                       (ADDR_PEN_RELE_REG                      + LEN_PEN_RELE_RWD                      ) /* address fine mappa per test PEN                                             */           

/****          definizioni indirizzi per simulare energy meter Lovato Ethernet   *******************************************************  */
#define ADDR_EM_LOVATO_V_SYS                    ((uint16_t)0x0550                       + 0                                     ) /* address registro lettura tensione di sistema                                */           
#define ADDR_EM_LOVATO_P_AREA                   (ADDR_EM_LOVATO_V_SYS                   + LEN_EM_LOVATO_V_SYS                   ) /* address registro lettura tensione di fase L2                                */           
#define ADDR_EM_LOVATO_END                      (ADDR_EM_LOVATO_P_AREA                  + LEN_EM_LOVATO_P_AREA                  ) /* address last LOVATO EM rw register                                                */           


/****          definizioni indirizzi per l'ambiente Macchina di collaudo  (ultimo indirizzo precedente 0x50F)  *******************************************************  */
#define ADDR_TM_MEASURED_CURRENT_RW             ((uint16_t)0x510                        + 0                                     ) /* address Corrente misurata dall'EM interno alla macchina di collaudo         */
#define ADDR_TM_MEASURED_VOLTAGE_RW             (ADDR_TM_MEASURED_CURRENT_RW            + LEN_TM_MEASURED_CURRENT_RW            ) /* address Tensione misurata dall'EM interno alla macchina di collaudo         */
#define ADDR_TM_EVSE_READY_RO                   (ADDR_TM_MEASURED_VOLTAGE_RW            + LEN_TM_MEASURED_VOLTAGE_RW            ) /* address Flag SCU pronta a proseguire i test di collaudo                     */
#define ADDR_ADDR_S_CONN_RW                     (ADDR_TM_EVSE_READY_RO                  + LEN_TM_EVSE_READY_RO                  ) /* address Codice di attivazione presa segnato anche nel manuale utente        */
#define ADDR_TM_ADDR_REQ_RW                     (ADDR_ADDR_S_CONN_RW                    + LEN_TM_ADDR_S_CONN_RW                 ) /* address richiesta indirizzamento automatico                                 */
#define ADDR_TM_ADDR_ASS_RW                     (ADDR_TM_ADDR_REQ_RW                    + LEN_TM_ADDR_REQ_RW                    ) /* address asseganzione indirizzamento automatico                              */
#define ADDR_TM_ERROR1_RO                       (ADDR_TM_ADDR_ASS_RW                    + LEN_TM_ADDR_ASS_RW                    ) /* address Codice errori in fase di collaudo                                   */
#define ADDR_TM_UID_MASTER_RW                   (ADDR_TM_ERROR1_RO                      + LEN_ADDR_TM_ERROR1_RO                 ) /* address Codice errori in fase di collaudo                                   */
#define ADDR_TM_UID_USER_RW                     (ADDR_TM_UID_MASTER_RW                  + LEN_TM_UID_MASTER_RW                  ) /* address Codice errori in fase di collaudo                                   */
#define ADDR_TM_MEASURED_CURRENT_L2_RW          (ADDR_TM_UID_USER_RW                    + LEN_TM_UID_USER_RW                    ) /* address Corrente misurata dall'EM interno alla macchina di collaudo L2      */
#define ADDR_TM_MEASURED_VOLTAGE_L2_RW          (ADDR_TM_MEASURED_CURRENT_L2_RW         + LEN_TM_MEASURED_CURRENT_L2_RW         ) /* address Tensione misurata dall'EM interno alla macchina di collaudo L2      */
#define ADDR_TM_MEASURED_CURRENT_L3_RW          (ADDR_TM_MEASURED_VOLTAGE_L2_RW         + LEN_TM_MEASURED_VOLTAGE_L2_RW         ) /* address Corrente misurata dall'EM interno alla macchina di collaudo L3      */
#define ADDR_TM_MEASURED_VOLTAGE_L3_RW          (ADDR_TM_MEASURED_CURRENT_L3_RW         + LEN_TM_MEASURED_CURRENT_L3_RW         ) /* address Tensione misurata dall'EM interno alla macchina di collaudo L3      */
#define ADDR_GET_EEPROM_RW                      (ADDR_TM_MEASURED_VOLTAGE_L3_RW         + LEN_TM_MEASURED_VOLTAGE_L3_RW         ) /* address lettura parametri in EEPROM                                         */
#define ADDR_RESERVED_B                         (ADDR_GET_EEPROM_RW                     + LEN_TM_GET_EEPROM_RW                  ) /* address reserved for future use                                             */


/****          definizioni indirizzi per l'ambiente APP - Wi-Fi  (ultimo indirizzo precedente 0x81FF)  *******************************************************  */
#define ADDR_CONNECTOR_INIT_STATUS_RO           ((uint16_t)0x8200                       + 0                                     ) /* address Stato di attivazione della presa                                    */
#define ADDR_CONNECTOR_OPERATION_STATUS_RO      (ADDR_CONNECTOR_INIT_STATUS_RO          + LEN_CONNECTOR_INIT_STATUS_RO          ) /* address Registro stato IDLE della presa, richiesto da Enrico per ios        */       
#define ADDR_PROCEDURE_RESPONSE_RO              (ADDR_CONNECTOR_OPERATION_STATUS_RO     + LEN_CONNECTOR_OPERATION_STATUS_RO     ) /* address Registro di esito procedura richiesta dalla App                     */
#define ADDR_PM_TOTAL_POWER_RO                  (ADDR_PROCEDURE_RESPONSE_RO             + LEN_PROCEDURE_RESPONSE_RO             ) /* address Energia totale esterna                                              */
#define ADDR_PM_L1_POWER_RO                     (ADDR_PM_TOTAL_POWER_RO                 + LEN_PM_TOTAL_POWER_RO                 ) /* address Energia esterna fase 1                                              */
#define ADDR_PM_L2_POWER_RO                     (ADDR_PM_L1_POWER_RO                    + LEN_PM_L1_POWER_RO                    ) /* address Energia esterna fase 2                                              */
#define ADDR_PM_L3_POWER_RO                     (ADDR_PM_L2_POWER_RO                    + LEN_PM_L2_POWER_RO                    ) /* address Energia esterna fase 3                                              */
#define ADDR_APP_LOGIN_USER_TYPE_RO             (ADDR_PM_L3_POWER_RO                    + LEN_PM_L3_POWER_RO                    ) /* address Tipologia di utente che ha fatto il login                           */
#define ADDR_CONNECTOR_CHECK_ACTIV_KEY_RW       (ADDR_APP_LOGIN_USER_TYPE_RO            + LEN_APP_LOGIN_USER_TYPE_RO            ) /* address Controllo codice di attivazione manuale utente                      */
#define ADDR_CONNECTOR_NAME_RW                  (ADDR_CONNECTOR_CHECK_ACTIV_KEY_RW      + LEN_CONNECTOR_CHECK_ACTIV_KEY_RW      ) /* address Nome della presa scelto dall'utente                                 */
#define ADDR_CONNECTOR_PIN_RW                   (ADDR_CONNECTOR_NAME_RW                 + LEN_CONNECTOR_NAME_RW                 ) /* address Pin della presa scelto dall'utente in fase di inizializzazione      */
#define ADDR_ROUTER_NET_SSID_RW                 (ADDR_CONNECTOR_PIN_RW                  + LEN_CONNECTOR_PIN_RW                  ) /* address SSID della rete del router domestico                                */
#define ADDR_ROUTER_NET_PASSWORD_RW             (ADDR_ROUTER_NET_SSID_RW                + LEN_ROUTER_NET_SSID_RW                ) /* address Password della rete del router domestico                            */
#define ADDR_CONNECTOR_ROUTER_IP_RW             (ADDR_ROUTER_NET_PASSWORD_RW            + LEN_ROUTER_NET_PASSWORD_RW            ) /* address Indirizzo IP modulo nella rete del router domestico                 */
#define ADDR_PROCEDURE_REQUEST_RW               (ADDR_CONNECTOR_ROUTER_IP_RW            + LEN_CONNECTOR_ROUTER_IP_RW            ) /* address Registro per richiesta procedura dalla App                          */
#define ADDR_SCHEDULE_FLAG1_RW                  (ADDR_PROCEDURE_REQUEST_RW              + LEN_PROCEDURE_REQUEST_RW              ) /* address Flag attivazione schedulazione 1                                    */
#define ADDR_SCHEDULE_START1_RW                 (ADDR_SCHEDULE_FLAG1_RW                 + LEN_SCHEDULE_FLAG1_RW                 ) /* address Ora inizio carica schedulazione 1                                   */
#define ADDR_SCHEDULE_STOP1_RW                  (ADDR_SCHEDULE_START1_RW                + LEN_SCHEDULE_START1_RW                ) /* address Ora fine carica schedulazione 1                                     */
#define ADDR_SCHEDULE_POWER1_RW                 (ADDR_SCHEDULE_STOP1_RW                 + LEN_SCHEDULE_STOP1_RW                 ) /* address massima potenza schedulazione 1                                     */                
#define ADDR_SCHEDULE_FLAG2_RW                  (ADDR_SCHEDULE_POWER1_RW                + LEN_SCHEDULE_POWER1_RW                ) /* address Flag attivazione schedulazione 2                                    */
#define ADDR_SCHEDULE_START2_RW                 (ADDR_SCHEDULE_FLAG2_RW                 + LEN_SCHEDULE_FLAG2_RW                 ) /* address Ora inizio carica schedulazione 2                                   */
#define ADDR_SCHEDULE_STOP2_RW                  (ADDR_SCHEDULE_START2_RW                + LEN_SCHEDULE_START2_RW                ) /* address Ora fine carica schedulazione 2                                     */
#define ADDR_SCHEDULE_POWER2_RW                 (ADDR_SCHEDULE_STOP2_RW                 + LEN_SCHEDULE_STOP2_RW                 ) /* address massima potenza schedulazione 2                                     */                
#define ADDR_SCHEDULE_FLAG3_RW                  (ADDR_SCHEDULE_POWER2_RW                + LEN_SCHEDULE_POWER2_RW                ) /* address Flag attivazione schedulazione 3                                    */
#define ADDR_SCHEDULE_START3_RW                 (ADDR_SCHEDULE_FLAG3_RW                 + LEN_SCHEDULE_FLAG3_RW                 ) /* address Ora inizio carica schedulazione 3                                   */
#define ADDR_SCHEDULE_STOP3_RW                  (ADDR_SCHEDULE_START3_RW                + LEN_SCHEDULE_START3_RW                ) /* address Ora fine carica schedulazione 3                                     */
#define ADDR_SCHEDULE_POWER3_RW                 (ADDR_SCHEDULE_STOP3_RW                 + LEN_SCHEDULE_STOP3_RW                 ) /* address massima potenza schedulazione 3                                     */                
#define ADDR_SCHEDULE_FLAG4_RW                  (ADDR_SCHEDULE_POWER3_RW                + LEN_SCHEDULE_POWER3_RW                ) /* address Flag attivazione schedulazione 4                                    */
#define ADDR_SCHEDULE_START4_RW                 (ADDR_SCHEDULE_FLAG4_RW                 + LEN_SCHEDULE_FLAG4_RW                 ) /* address Ora inizio carica schedulazione 4                                   */
#define ADDR_SCHEDULE_STOP4_RW                  (ADDR_SCHEDULE_START4_RW                + LEN_SCHEDULE_START4_RW                ) /* address Ora fine carica schedulazione 4                                     */
#define ADDR_SCHEDULE_POWER4_RW                 (ADDR_SCHEDULE_STOP4_RW                 + LEN_SCHEDULE_STOP4_RW                 ) /* address massima potenza schedulazione 4                                     */                
#define ADDR_CONNECTOR_CONNECTION_STATUS_RO     (ADDR_SCHEDULE_POWER4_RW                + LEN_SCHEDULE_POWER4_RW                ) /* address Connector connection status                                         */
#define ADDR_MAX_POWER_RO                       (ADDR_CONNECTOR_CONNECTION_STATUS_RO    + LEN_CONNECTOR_CONNECTION_STATUS_RO    ) /* address Massima potenza stazione per tachimetro app                         */                      
#define ADDR_RANDOM_DELAY_FLAG_RW               (ADDR_MAX_POWER_RO                      + LEN_MAX_POWER_RO                      ) /* address abilitazione/disabilitazione ritardo random schedulazioni           */
#define ADDR_UID_AUTHORIZATION_APP_RW           (ADDR_RANDOM_DELAY_FLAG_RW              + LEN_RANDOM_DELAY_FLAG_RW              ) /* address uid autorizzazione da app wifi                                      */        
#define ADDR_BT_SINAPSI_STATUS_RW               (ADDR_UID_AUTHORIZATION_APP_RW          + LEN_UID_AUTHORIZATION_APP_RW          ) /* address stato del bluetooth Sinapsi                                         */                
#define ADDR_FW_UPDATE_NAME_RW                  (ADDR_BT_SINAPSI_STATUS_RW              + LEN_BT_SINAPSI_STATUS_RW              ) /* address fw update name                                                      */
#define ADDR_FW_UPDATE_LEN_RW                   (ADDR_FW_UPDATE_NAME_RW                 + LEN_FW_UPDATE_NAME_RW                 ) /* address fw update length                                                    */
#define ADDR_FW_UPDATE_STATUS_RO                (ADDR_FW_UPDATE_LEN_RW                  + LEN_FW_UPDATE_LEN_RW                  ) /* address reserved for future use                                             */
#define ADDR_EVSE_POWER_MODE_RO                 (ADDR_FW_UPDATE_STATUS_RO               + LEN_FW_UPDATE_STATUS_RO               ) /* address for evse power mode                                                 */
#define ADDR_RESERVED_C                         (ADDR_EVSE_POWER_MODE_RO                + LEN_EVSE_POWER_MODE_RO                ) /* address reserved for future use                                             */

#define ADDR_UNDEF                              ((uint16_t)0xFFFF)                                                                /* address   undefined (when we use the index of the register)                 */

#define UID_AUTHORIZATION_BY_APP      0xFD

typedef __packed struct
{
  uint8_t         mfwVer[LEN_BOARD_FW_VERSION_RO * 2];                          /* Registro BOARD_FW_VERSION_RO v18b Modbus                     */
  uint8_t         rfdVer[LEN_MIFARE_FW_VERSION_RO * 2];                         /* Registro MIFARE_FW_VERSION_RO v18b Modbus                    */
  uint8_t         devSn[LEN_BOARD_SN_RO * 2];                                   /* Registro BOARD_SN_RO v18b Modbus                             */
  uint8_t         plcVer[LEN_PLC_FW_VERSION_RO * 2];                            /* Registro PLC_FW_VERSION_RO v18b Modbus                       */
  uint8_t         plcMac[LEN_PLC_MAC_ADDRESS_RO * 2];                           /* Registro PLC_MAC_ADDRES_RO v18b Modbus                       */
  uint8_t         hwRev[LEN_HW_REVISION_RO * 2];                                /* Registro HW_REVISION_RO v18b Modbus                          */
  uint8_t         macWifi[LEN_WIFI_MAC_ADDRESS_RO * 2];                         /* Registro WIFI_MAC_ADDRESS_RO v18b Modbus                     */        
  uint8_t         pwrSn[LEN_POWER_MODULE_SN_RO * 2];                            /* Registro POWER_MODULE_SN_RO v18b Modbus                      */
  uint8_t         macBle[LEN_BLE_MAC_ADDRESS_RO * 2];                           /* Registro BLE_MAC_ADDRESS_RO v18b Modbus                      */
  uint8_t         prodSn[LEN_PRODUCT_SN_RO * 2];                                /* Registro PRODUCT_SN_RO v18b Modbus                           */
  uint8_t         prodCode[LEN_PRODUCT_CODE_RO * 2];                            /* Registro PRODUCT_CODE_RO v18b Modbus                         */
  uint8_t         bootfwVer[LEN_BOOT_FW_VERSION_RO * 2];                        /* Registro BOOT CODE VERSION_RO v18b Modbus                    */
  uint16_t        modbusVersion;                                                /* Registro versione modbus                                     */
} scuMapRegInfoVer_st;

typedef __packed struct
{
  uint32_t        ntfPresences;                                                 /* Registro NOTIFY_EVSE_PRESENCE_RO v18b Modbus                 */                                                     
  uint32_t        ntfChangeRo;                                                  /* Registro NOTIFY_EVSE_CHANGE_RO v18b Modbus                   */
  uint16_t        ntfErr1;                                                      /* Registro EVSE_ERROR1_RO v18b Modbus                          */
  uint16_t        ntfErr2;                                                      /* Registro EVSE_ERROR2_RO v18b Modbus                          */
  uint16_t        ntfChangeRegRo[SCU_NUM];                                      /* Registro EVSE_CHANGE_REGISTERS_RO v18b Modbus                */        
} scuMapRegNotify_st;

typedef __packed struct
{
  uint16_t        ntfSktEvent;                                                  /* Registro EVSE_EVENT_FLAGS_RO v18b Modbus                     */
  uint16_t        ntfChgStat;                                                   /* Registro EVSE_CHARGE_STATUS_RO v18b Modbus                   */                                        
  int32_t         tempSys;                                                      /* Registro TEMPERATURE_SYSTEM_RO v18b Modbus                   */
  uint16_t        reserved3DC[LEN_RESERVED3_RDD];                               /* Registri solo per DC                                         */
  uint32_t        mtVsys;                                                       /* Registro VOLTAGE_AC_RO v18b Modbus                           */
  uint32_t        mtPh1Cur;                                                     /* Registro CURRENT_AC_L1_RO v18b Modbus                        */        
  uint32_t        mtPh2Cur;                                                     /* Registro CURRENT_AC_L2_RO v18b Modbus                        */
  uint32_t        mtPh3Cur;                                                     /* Registro CURRENT_AC_L3_RO v18b Modbus                        */
  uint32_t        mtMaxPowerStation;                                            /* Registro ACTIVE_POWER_DC_RO v22  Modbus Pmax stazione        */
  uint32_t        mtSpPower;                                                    /* Registro ACTIVE_POWER_AC_RO v18b Modbus                      */
  uint32_t        mtSpPowerL1;                                                  /* Registro potenza attiva fase 1 v24 Modbus                    */                                                      
  uint32_t        mtSqPower;                                                    /* Registro REACTIVE_POWER_AC_RO v18b Modbus                    */
  uint32_t        mtTpEnrg;                                                     /* Registro TOTAL_ACTIVE_ENERGY_AC_EV_RO v18b Modbus            */
  uint32_t        mtSysCur;                                                     /* Registro CURRENT_AC_SYS_RO v22 Modbus                        */
  uint32_t        mtTqEnrg;                                                     /* Registro TOTAL_REACTIVE_ENERGY_ENERGY_RO v18b Modbus         */
  uint32_t        mtTppEnrg;                                                    /* Registro TRANSACTION_ACTIVE_ENERGY_AC_EV_RO v18b Modbus      */
  uint32_t        mtSpPowerL2;                                                  /* Registro potenza attiva fase 3 v24 Modbus                    */                                                      
  uint32_t        mtTqpEnrg;                                                    /* Registro TRANSACTION_REACTIVE_ENERGY_AC_EV_RO v18b Modbus    */
  uint32_t        mtFreq;                                                       /* Registro FREQUENCY_SUPPLY_RO v18b Modbus                     */                                                       
  uint16_t        reserved4DC[LEN_RESERVED4_RDD];                               /* Registri solo per DC v18b Modbus                             */                               
  uint16_t        rswCurr;                                                      /* Registro MAX_CURRENT_ROTATORY_SWITCH_RO v18b Modbus          */
  uint32_t        exRscCurr;                                                    /* Registro EX_RSC_CURR_RO migrato in RW v18b Modbus            */
  uint32_t        mtSpPowerL3;                                                  /* Registro potenza attiva fase 3 v24 Modbus                    */
  uint16_t        empty_063A;
  uint16_t        pwrCurr;                                                      /* Registro MAX_POWER_RESULT_RO v24 Modbus                      */
  uint32_t        evSessionT;                                                   /* Registro TRANSACTION_TIME_RO v18b Modbus                     */
  uint32_t        evRemainT;                                                    /* Registro TRANSACTION_COUNTDOWN_RO v18b Modbus                */        
  uint16_t        evSoc;                                                        /* Registro EV_BATTERY_RO v18b Modbus                           */
  uint32_t        evSessionId;                                                  /* Registro SESSION_ID_RO v18b Modbus                           */
  uint16_t        evRstFlag;                                                    /* Registro EVSE_BOOT_EVENT_RO v18b Modbus                      */
  uint32_t        totActEnrgGrid;                                               /* Registro TOTAL_ACTIVE_ENERGY_AC_GRID_RO v18b Modbus          */
  uint32_t        totReactEnrgGrid;                                             /* Registro TOTAL_REACTIVE_ENERGY_AC_GRID_RO v18b Modbus        */
  uint32_t        transActEnrgGrid;                                             /* Registro TRANSACTION_ACTIVE_ENERGY_AC_GRID_RO v18b Modbus    */
  uint32_t        transReactEnrgGrid;                                           /* Registro TRANSACTION_REACTIVE_ENERGY_AC_GRID_RO v18b Modbus  */
  uint16_t        reservedDC6[LEN_SCU_RESERVED6];                               /* Registro TOTAL_ENERGY_DC_GRID_RO e TRANS_ENERGY_DC_GRID_RO   */
  uint8_t         uidAuth[LEN_UID_AUTHORIZATION_RO * 2];                        /* Registro UID_AUTHORIZATION_RO v18b Modbus                    */
  uint32_t        timeInCharge;                                                 /* Registro TIME_IN_CHARGE_RO v24 Modbus                        */
} scuMapRegStatusMeas_st;


typedef __packed struct
{
  uint16_t        connType;                                                     /* Registro CONNECTOR_TYPE_RW v18b Modbus                       */
  uint16_t        hwcFlags;                                                     /* Registro HWC_FLAGS_RW v18b Modbus                            */
  uint16_t        mtType;                                                       /* Registro ENERGY_METERS_RW v18b Modbus                    */
  uint16_t        pwrOutage;                                                    /* Registro POWER_OUTAGE_RW v18b Modbus                         */
  uint16_t        devAlias;                                                     /* Registro CONNECTOR_IDS_RW v18b Modbus                             */
  uint8_t         devSn[LEN_BOARD_SN_RW  * 2];                                  /* Registro BOARD_SN_RW v18b Modbus                             */
  uint8_t         prdSn[LEN_PRODUCT_SN_RW * 2];                                 /* Registro PRODUCT_SN_RW v18b Modbus                           */
  uint16_t        mstCfg;                                                       /* Registro MASTER_HW_TYPE_RW v18b Modbus                       */
  uint8_t         rtcInf[LEN_UTC_DATE_TIME_RW * 2];                             /* Registro UTC_DATE_TIME_RW v18b Modbus                        */
  uint16_t        pwrVendor;                                                    /* Registro POWER_MODULE_BRAND_RW v18b Modbus                   */
  uint16_t        pwrModel;                                                     /* Registro POWER_MODULE_MODEL_RW v18b Modbus                   */        
  uint16_t        pwrModules;                                                   /* Registro POWER_MODULE_N_RW v18b Modbus                       */
  uint16_t        tmMode;                                                       /* Registro EVSE_TM_MODE_RW v18b Modbus                         */
  uint16_t        evseMod;                                                      /* Registro EVSE_OPERATION_MODE_RW v18b Modbus                  */        
  uint16_t        cableChgSel;    /* solo DC */                                 /* Registro CHARGE_PROTOCOL_SELECTED_RW v18b Modbus             */        
  uint16_t        defDispLng;                                                   /* Registro EX_DISPLAY_LANGUAGES_RW v18b Modbus                 */
  uint16_t        hwChecks1;                                                    /* Registro HW_CHECKS1_RW v18b Modbus                           */        
  uint16_t        hwChecks2;                                                    /* Registro HW_CHECKS2_RW v18b Modbus                           */
  uint16_t        hwActuators;                                                  /* Registro HW_ACTUATORS_RW v18b Modbus                         */
  uint16_t        res7DC[LEN_SCU_RESERVED7];                                    /* Registro UNDEFINED_EX_SCU_RESERVED7 v18b Modbus              */
  uint32_t        maxTempCurr;                                                  /* Registro MAX_TEMPORARY_CURRENT_RW v18b Modbus                */                                                       
  uint16_t        empty_0033;                                                   /* Registro UNDEFINED_EX_LIM_LOW_CURR_RW v18b Modbus            */
  uint16_t        ledStrip;                                                     /* Registro LED_STRIP_RWD v24 Modbus                            */
  uint16_t        rmtCmd;                                                       /* Registro REMOTE_COMMANDS_RW v18b Modbus                      */
  uint16_t        alsBright;                                                    /* Registro ENVIRONMENT_BRIGHTNESS_RW v18b Modbus               */
  uint32_t        exPrxDist;                                                    /* Registro UNDEFINED_EX_PRX_DIST_RW v18b Modbus                */
  uint16_t        exPrxMotion;                                                  /* Registro UNDEFINED_EX_PRX_MOTION_RW v18b Modbus              */
  uint32_t        maxTempPowerAc;                                               /* Registro UNDEFINED_EX_LED_EXT_RW v18b Modbus                 */                                       
  uint16_t        pmMode;                                                       /* Registro PM_MODE_RW v22 Modbus                               */
  uint16_t        logEna;                                                       /* Registro ENABLE_LOG_RW v18b Modbus                           */
  uint16_t        authLnk;                                                      /* Registro AUTHORIZATION_FEEDBACK_RW v18b Modbus               */
  uint16_t        rtcTimeZone;                                                  /* Registro TIMEZONE_RW v18b Modbus                             */        
  uint16_t        menuVisible;                                                  /* Registro MENU_VISIBILITY_RW v18b Modbus                      */
  uint16_t        counter_T1;                                                   /* Registro TIMEOUT_RANGE1_RW v18b Modbus                       */
  uint16_t        counter_T2;                                                   /* Registro TIMEOUT_RANGE2_RW v18b Modbus                       */
  uint8_t         prdCode[LEN_PRODUCT_CODE_RW * 2];                             /* Registro PRODUCT_CODE_RW v18b Modbus                         */
  uint8_t         fakePrdCode[LEN_TECN_PRODUCT_CODE_RW * 2];                    /* Registro TECN_PRODUCT_CODE_RW v18b Modbus                    */
  uint16_t        connNumb;                                                     /* Registro CONNECTOR_N_RW v18b Modbus                          */
  uint32_t        availDispLng;                                                 /* Registro DISPLAY_LANGUAGES_RW v18b Modbus                    */
  uint16_t        maxTypCurr;                                                   /* Registro MAX_TYPICAL_CURRENT_RW v18b Modbus                  */
  uint16_t        maxSimplCurr;                                                 /* Registro MAX_SIMPLIFIED_CURRENT_RW v18b Modbus               */
  uint16_t        chgTime;                                                      /* Registro CHARGE_TIME_RW v18b Modbus                          */
  uint16_t        chgEnrg;                                                      /* Registro CHARGE_MAX_ENERGY_RW v18b Modbus                    */
  uint16_t        pmImin;                                                       /* Registro PM_IMIN_RW v18b Modbus                              */
  uint16_t        pmPmax;                                                       /* Registro PM_PMAX_RW v18b Modbus                              */
  uint16_t        pmFlags;                                                      /* Registro PM_FLAGS_RW v18b Modbus                             */
  uint16_t        pmHpower;                                                     /* Registro PM_HPOWER_RW v18b Modbus                            */
  uint16_t        pmDset;                                                       /* Registro PM_DSET_RW v18b Modbus                              */        
  uint16_t        pmDmax;                                                       /* Registro PM_DMAX_RW v18b Modbus                              */
  uint16_t        pmEmex;                                                       /* Registro PIN_EXTERNAL_ENERGY_METER_RW v21.3 Modbus           */                                
  uint32_t        limMaxPowerAc;                                                /* Registro LIM_MAX_POWER_AC_RW v24 Modbus                      */
} scuSetRegister_st;

#ifdef MODBUS_TCP_EM_LOVATO
typedef __packed struct
{
  uint16_t        sysVoltage;                                                   /* Registro versione modbus                                     */
  uint16_t        socketActivePower[SCU_NUM][3];                                /* Registro potenze attive per le possibili 16 prese trifase    */
} scuMapRegLovatoEmSim_st;
#endif

typedef __packed struct
{
  uint16_t        fileCommand;                                                       /* Registro FW_UPDATE_RW v18b Modbus                            */        
  uint32_t        fileSize;                                                          /* Registro FW_UPDATE_EVENT_RW v18b Modbus                      */  
  uint8_t         commandRx;      
  uint8_t         filesizeRx;      
} scuSetRegFwUpd_st;


/* MAPPA REGISTRI MACCHINA DI COLLAUDO */
typedef __packed struct
{
  uint16_t        tmMeasCurr;                                                   /* Registro TM_MEASURED_CURRENT_RW v18b Modbus                  */ 
  uint16_t        tmMeasVolt;                                                   /* Registro TM_MEASURED_VOLTAGE_RW v18b Modbus                  */ 
  uint16_t        tmCommand;                                                    /* Registro TM_COMMAND_RW v25 Modbus                            */ 
  uint16_t        tmAddrSconnM;                                                 /* Registro ADDR_ADDR_S_CONN_RW                                 */ 
  uint16_t        tmAddrReq;                                                    /* Registro ADDR_TM_ADDR_REQ_RW v24 Modbus                      */ 
  uint16_t        tmAddrAss;                                                    /* Registro ADDR_TM_ADDR_ASS_RW v24 Modbus                      */ 
  uint16_t        tmError1InTest;                                               /* Registro TM_ERROR1_IN_TEST_RO v25 Modbus                     */ 
  uint8_t         uidMaster[LEN_TM_UID_MASTER_RW * 2];                          /* Registro TM_UID_MASTER_RW                                    */ 
  uint8_t         uidUser[LEN_TM_UID_USER_RW * 2];                              /* Registro TM_UID_USER_RW                                      */ 
  uint16_t        tmMeasCurrL2;                                                 /* Registro TM_MEASURED_CURRENT_RW L2 v24 Modbus                */ 
  uint16_t        tmMeasVoltL2;                                                 /* Registro TM_MEASURED_VOLTAGE_RW L2 v24 Modbus                */ 
  uint16_t        tmMeasCurrL3;                                                 /* Registro TM_MEASURED_CURRENT_RW L3 v24 Modbus                */ 
  uint16_t        tmMeasVoltL3;                                                 /* Registro TM_MEASURED_VOLTAGE_RW L3 v24 Modbus                */ 
  uint16_t        tmGetEeprom;                                                  /* Registro ADDR_GET_EEPROM_RW per lettura EEPROM               */ 
} tmMapRegister_st;


/* MAPPA REGISTRI APP - WIFI (RW) */
typedef __packed struct
{
  uint16_t        connInitStat;                                                 /* Registro CONNECTOR_INIT_STATUS_RO v19.2 Modbus               */
  uint16_t        connIdleStat; /* DO NOT USE! It's used by iOS app Scame E-Mobility Registro CONNECTOR_OPERATION_STATUS_RO v19.2 Modbus        */        
  uint8_t         procResp[LEN_PROCEDURE_RESPONSE_RO * 2];                      /* Registro PROCEDURE_RESPONSE_RO v19.2 Modbus                  */
  uint32_t        pmTotPwr;                                                     /* Registro PM_TOTAL_POWER_RO v19.2 Modbus                      */
  uint32_t        pmL1Pwr;                                                      /* Registro PM_L1_POWER_RO v19.2 Modbus                         */
  uint32_t        pmL2Pwr;                                                      /* Registro PM_L2_POWER_RO v19.2 Modbus                         */
  uint32_t        pmL3Pwr;                                                      /* Registro PM_L3_POWER_RO v19.2 Modbus                         */
  uint16_t        userLogin;                                                    /* Login fatto da utente o da installatore                      */
  uint8_t         connActivKey[LEN_CONNECTOR_CHECK_ACTIV_KEY_RW * 2];           /* Registro CONNECTOR_CHECK_ACTIV_KEY_RW v19.2 Modbus           */
  uint8_t         connName[LEN_CONNECTOR_NAME_RW * 2];                          /* Registro CONNECTOR_NAME_RW v19.2 Modbus                      */
  uint8_t         connPin[LEN_CONNECTOR_PIN_RW * 2];                            /* Registro CONNECTOR_PIN_RW v19.2 Modbus                       */
  uint8_t         RoutSSID[LEN_ROUTER_NET_SSID_RW * 2];                         /* Registro ROUTER_NET_SSID_RW v19.2 Modbus                     */
  uint8_t         RoutPass[LEN_ROUTER_NET_PASSWORD_RW * 2];                     /* Registro ROUTER_NET_PASSWORD_RW v19.2 Modbus                 */
  uint8_t         RoutIP[LEN_CONNECTOR_ROUTER_IP_RW * 2];                       /* Registro CONNECTOR_ROUTER_IP_RW v19.2 Modbus                 */
  uint16_t        procReq;                                                      /* Registro PROCEDURE_REQUEST_RW v19.2 Modbus                   */
  uint16_t        schFlag1;                                                     /* Registro SCHEDULE_FLAG1_RW v19.2 Modbus                      */
  uint16_t        schStart1;                                                    /* Registro SCHEDULE_START1_RW v19.2 Modbus                     */
  uint16_t        schStop1;                                                     /* Registro SCHEDULE_STOP1_RW v19.2 Modbus                      */
  uint32_t        schPower1;                                                    /* Registro SCHEDULE_POWER1_RW v19.2 Modbus                     */
  uint16_t        schFlag2;                                                     /* Registro SCHEDULE_FLAG2_RW v19.2 Modbus                      */
  uint16_t        schStart2;                                                    /* Registro SCHEDULE_START2_RW v19.2 Modbus                     */
  uint16_t        schStop2;                                                     /* Registro SCHEDULE_STOP2_RW v19.2 Modbus                      */
  uint32_t        schPower2;                                                    /* Registro SCHEDULE_POWER2_RW v19.2 Modbus                     */
  uint16_t        schFlag3;                                                     /* Registro SCHEDULE_FLAG3_RW v19.2 Modbus                      */
  uint16_t        schStart3;                                                    /* Registro SCHEDULE_START3_RW v19.2 Modbus                     */
  uint16_t        schStop3;                                                     /* Registro SCHEDULE_STOP3_RW v19.2 Modbus                      */
  uint32_t        schPower3;                                                    /* Registro SCHEDULE_POWER3_RW v19.2 Modbus                     */
  uint16_t        schFlag4;                                                     /* Registro SCHEDULE_FLAG4_RW v19.2 Modbus                      */
  uint16_t        schStart4;                                                    /* Registro SCHEDULE_START4_RW v19.2 Modbus                     */
  uint16_t        schStop4;                                                     /* Registro SCHEDULE_STOP4_RW v19.2 Modbus                      */
  uint32_t        schPower4;                                                    /* Registro SCHEDULE_POWER4_RW v19.2 Modbus                     */
  uint16_t        connectStatus;                                                /* Registro CONNECTOR_CONNECTION_STATUS_RO v19.2 Modbus         */                
  uint32_t        maxPower;                                                     /* Registro MAX_POWER_RO v20 Modbus                             */ 
  uint16_t        randomDelay;                                                  /* Registro RANDOM_DELAY_FLAG_RW v20.2 Modbus                   */                
  uint8_t         uidAuthApp[LEN_UID_AUTHORIZATION_APP_RW * 2];                 /* Registro UID_AUTHORIZATION_APP_RW v21 Modbus                 */        
  uint16_t        btSinapsiStatus;                                              /* Registro BT_SINAPSI_STATUS_RW v21.3 Modbus                   */
  uint8_t         fwUpdateName[LEN_FW_UPDATE_NAME_RW * 2];                      /* Registro FW_UPDATE_NAME_RW v21.3 Modbus                      */                        
  uint32_t        fwUpdateLen;                                                  /* Registro FW_UPDATE_LEN_RW v21.3 Modbus                       */
  uint16_t        fwUpdateStatus;                                               /* Registro FW_UPDATE_STATUS_RO v21.3 Modbus                    */
  uint16_t        evsePwrMode;                                                  /* Registro EVSE_POWER_MODE_RO v21.3 Modbus                       */
} appMapRwRegister_st;

/* EXCHANGE AREA FORMAT: this structure data is put inside the exchange area by the SCU and used by APP during the login phase  */
typedef __packed struct
{
  uint16_t        rswCurr;                                                      /* Registro MAX_CURRENT_ROTATORY_SWITCH_RO v24 Modbus       */
  uint16_t        evsePwrMode;                                                  /* Registro EVSE_POWER_MODE_RO v24 Modbus                   */
  uint32_t        maxPower;                                                     /* Registro MAX_POWER_RO v24 Modbus                         */ 
  uint16_t        maxTypCurr;                                                   /* Registro MAX_TYPICAL_CURRENT_RO v24 Modbus               */
  uint16_t        evseMod;                                                      /* Registro EVSE_OPERATION_MODE_RO v24 Modbus               */        
  uint8_t         mfwVer[LEN_BOARD_FW_VERSION_RO * 2];                          /* Registro BOARD_FW_VERSION_RO v24 Modbus                  */
  uint8_t         rfdVer[LEN_MIFARE_FW_VERSION_RO * 2];                         /* Registro MIFARE_FW_VERSION_RO v24 Modbus                 */
  uint16_t        mtType;                                                       /* Registro ENERGY_METERS_RO v24 Modbus                     */
  uint16_t        connectStatus;                                                /* Registro CONNECTOR_CONNECTION_STATUS_RO v24 Modbus       */                
  uint8_t         RoutSSID[LEN_ROUTER_NET_SSID_RW * 2];                         /* Registro ROUTER_NET_SSID_RW v24 Modbus                   */
  uint16_t        schFlag1[20];                                                 /* Registro SCHEDULE_FLAG1_RO v24 Modbus                    */
  uint16_t        menuVisible;                                                  /* Registro MENU_VISIBILITY_RO v24 Modbus                   */
  uint16_t        pmImin;                                                       /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmPmax;                                                       /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmFlags;                                                      /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmHpower;                                                     /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmDset;                                                       /* Registro PM_PARAMETERS_RO v24 Modbus                     */        
  uint16_t        pmDmax;                                                       /* Registro PM_PARAMETERS_RO v24 Modbus                     */
  uint16_t        pmMode;                                                       /* Registro PM_MODE_RO v24 Modbus                           */
  uint16_t        hwChecks1;                                                    /* Registro HW_CHECKS1_RO v24 Modbus                        */        
  uint16_t        hwChecks2;                                                    /* Registro HW_CHECKS2_RO v24 Modbus                        */
  uint16_t        hwActuators;                                                  /* Registro HW_ACTUATORS_RO v24 Modbus                      */
} appMapRoRegister_st;

typedef __packed struct
{
  uint16_t        startAddr;
  uint16_t        endAddr;
} addrLimits_st;

typedef __packed struct
{
  addrLimits_st   inventoryData;
  addrLimits_st   notifyData;
  addrLimits_st   statusData;
} infoAddr_st;


/* MAPPA REGISTRI READ ONLY */
typedef __packed struct
{
  scuMapRegInfoVer_st     scuMapRegInfoVer;                                             // struttura che contiene informazioni sulle versioni HW e SW Start 0x0300
  scuMapRegNotify_st      scuMapRegNotify;                                              // struttura per i registri di notifica                       Start 0x0400
  scuMapRegStatusMeas_st  scuMapRegStatusMeas;                                          // struttura per i registri di status e misure                Start 0x0600
  uint8_t                 rfdUid[LEN_UID_AUTHORIZATION_RO * 2];                         // struttura per i registro di info suUID carta RFID          Start 0x0650       
} scuRoMapRegister_st;


/* MAPPA REGISTRI READ/WRITE */
typedef __packed struct
{
  scuSetRegister_st     scuSetRegister;                                                 // struttura che contiene informazioni di settings            Start 0x0000
  uint8_t               reserved_A[(uint16_t)0x100 - sizeof(scuSetRegister_st)];        // spare area 
  scuSetRegFwUpd_st     scuSetRegFwUpd;                                                 // struttura che contiene informazioni per Fw upgrade         Start 0x0100
  rseSetReg_st          rseSetReg;                                                      // struttura che contiene informazioni RSE-SINAPSI            Start 0x0800
  uint16_t              penReleReg;                                                     // struttura che contiene informazioni condi relè gig PEN     Start 0x0830
} scuRwMapRegister_st;


typedef __packed struct
{
  headerScuRx_st      headerScuRx;
  ScuMessage_u        message;
} frameScuRx_st;

typedef __packed struct
{
  ScuMessage_u        message;
} frameMdbRx_st;


/* REGISTRO EVSE_CHARGE_STATUS_RO --> Address = 0x0601, 1 word */
typedef enum
{
  INITIAL_EVSE_STATE            = 0x00,         /* Initial EVSE state modbus v19.2                      */ 
  IDLE_STATE                    = 0x01,         /* IDLE EVSE state modbus v19.2                         */ 
  PREPARING_STATE               = 0x02,         /* PREPARING EVSE state modbus v19.2                    */ 
  EV_CONNECTED_STATE,                           /* CONNECTED EVSE state modbus v19.2                    */
  CHARGING_STATE,                               /* INCHARGE EVSE state modbus v19.2                     */
  SUSPENDED_EV_STATE,                           /* SUSPENDED EV EVSE state modbus v19.2                 */
  SUSPENDED_EVSE_STATE,                         /* SUSPENDED EVSE EVSE state modbus v19.2               */
  END_CHARGE_STATE,                             /* END CHARGE EVSE state modbus v19.2                   */
  FAULTED_STATE,                                /* FAULTED EVSE state modbus v20                        */
  UNVAILABLE_STATE,                             /* UNVAILABLE EVSE state modbus v20                     */
  RESERVED_STATE,                               /* RESERVED EVSE state modbus v20                       */
  BOOTLOADER_STATE,                             /* BOOTLOADER EVSE state modbus v20                     */
  SHUTDOWN_STATE,                               /* SHUTDOWN EVSE state modbus v20                       */
  REBOOTING_STATE,                              /* REBOOTING EVSE state modbus v20                      */
  SUSPENDED_NOPOWER_STATE                       /* SUSPENDED EVSE by NO POWER state modbus v24          */
} evseChargeStatusReg_e;


/* REGISTRO EVSE_EVENT_FLAGS_RO --> Address = 0x0600, 1 word */
typedef enum
{
  EVSE_EVENT_UNDEFINED          = 0x00,         /* EVENT UNDEFINED                                      */
  SOCKET_BLOCKED                = 0x01,         /* SOCKET BLOCKED event modbus v20                      */ 
  CONNECTOR_PLUGGED_IN          = 0x02,         /* CONNECTOR PLUGGED IN event modbus v20                */ 
} evseEventFlagsReg_e;


/* REGISTRO HWC_FLAGS_RW --> Address = 0x0001, 1 word */
typedef enum
{
  HW_FLAGS_UNDEFINED            = 0x0000,       /* FLAGS UNDEFINED                                      */
  DIFF_RIARM_FLAG               = 0x0001,       /* DIFFERENZIALE RIARMABILE                             */ 
  DISPLAY_LCD_FLAG              = 0x0002,       /* DISPLAY GRAFICO + TOUCH                              */ 
  RFID_READER_FLAG              = 0x0004,       /* LETTORE RFID                                         */ 
  WIFI_CONNECTION_FLAG          = 0x0008,       /* WIFI CONNECTION                                      */
} hwFlags_e;


/* REGISTRO EVSE_OPERATION_MODE_RW --> Address = 0x0023, 1 word */
typedef enum
{
  OP_MODE_FREE                  = 0x00,         /* FREE operation mode                                  */
  OP_MODE_PERSONAL              = 0x01,         /* PERSONAL operation mode                              */ 
  OP_MODE_NET                   = 0x02,         /* NET operation mode                                   */ 
  OP_MODE_OCPP                  = 0x03          /* OCPP operation mode                                  */ 
} opMode_e;


/* REGISTRO EVSE_AVAILABILITY_RW --> Address = 0x0023, 1 word */
typedef enum
{
  EVSE_UNDEFINED_AVAILAB         = 0x00,         /* Valore non definito, init                            */        
  EVSE_DISPONIBILE               = 0x01,         /* Socket disponibile                                   */
  EVSE_NON_DISPONIBILE           = 0x02,         /* Socket non disponibile / in manutenzione             */ 
  EVSE_RISERVATO                 = 0x03          /* Socket riservata                                     */ 
} evseAvailab_e;
  

/* REGISTRO POWER_OUTAGE_TYPE_RW --> Address = 0x0003, 1 word */
typedef enum
{
  POWER_NONE                     = 0x00,         /* Power outage module NONE                             */
  POWER_BACK                     = 0x01,         /* Power outage Backup battery                          */ 
  POWER_MON                      = 0x02,         /* Power outage Monitor module                          */
  POWER_PEN                      = 0x03          /* Power outage PEN module                              */    
} powerOutage_e;


/* REGISTRO EVSE_ERROR1_RO --> Address = 0x0404, 1 word */
typedef enum
{
  ERROR1_NONE                    = 0x0000,       /* Error 1 register, value NO error                     */
  ERROR1_RCDM                    = 0x0001,       /* Error 1 register, value RCDM error                   */ 
  ERROR1_LIDE                    = 0x0002,       /* Error 1 register, value LIDE error                   */
  ERROR1_VENT                    = 0x0004,       /* Error 1 register, value ventilation error            */
  ERROR1_BLCK                    = 0x0008,       /* Error 1 register, value socket block error           */
  ERROR1_BLEF                    = 0x0010,       /* Error 1 register, value Bluetooth error              */
  ERROR1_WIFI                    = 0x0020,       /* Error 1 register, value Wi-fi error                  */
  ERROR1_MIRR                    = 0x0040,       /* Error 1 register, value Mirror error                 */
  ERROR1_RCBO                    = 0x0080,       /* Error 1 register, value magnetothermic error         */
  ERROR1_CPSE                    = 0x0100,       /* Error 1 register, value CP short circuit error       */
  ERROR1_PPSE                    = 0x0200,       /* Error 1 register, value PP short circuit error       */
  ERROR1_CPLS                    = 0x0400,       /* Error 1 register, value CP lost error                */
  ERROR1_PPLS                    = 0x0800,       /* Error 1 register, value PP lost error                */
  ERROR1_VBUS                    = 0x1000,       /* Error 1 register, value low voltage supply error     */
  ERROR1_MFRE                    = 0x2000,       /* Error 1 register, value RFID reader error            */
  ERROR1_EMTR                    = 0x4000,       /* Error 1 register, value internal energy meter error  */
  ERROR1_OVCE                    = 0x8000,       /* Error 1 register, value overcurrent error            */
} error1Reg_e;


/* REGISTRO EVSE_ERROR2_RO --> Address = 0x0405, 1 word */
typedef enum
{
  ERROR2_NONE                    = 0x0000,       /* Error 2 register, value NO error                     */
  ERROR2_RCTE                    = 0x0001,       /* Error 2 register, value rectifier diode presence error */ 
  ERROR2_EMEX                    = 0x0002,       /* Error 2 register, value external energy meter error  */
  ERROR2_CHN2                    = 0x0004,       /* Error 2 register, value chain2  error                */
  ERROR2_OFFL                    = 0x0008,       /* Error 2 register, communication error on RS485       */
  ERROR2_PENF                    = 0x0010,       /* Error 2 register, value PEN error                    */
  ERROR2_HGTP                    = 0x0020,       /* Error 2 register, value high temperature error       */
} error2Reg_e;


/* REGISTRO HW_ACTUATORS_RW --> Address = 0x0028, 1 word */
typedef enum
{
  ACT_NONE                       = 0x0000,       /* Actuator NONE value                                  */
  ACT_BLCK                       = 0x0001,       /* Actuator BLOCK                                       */ 
  ACT_MIRR                       = 0x0002,       /* Actuator MIRROR                                      */
  ACT_RCBO                       = 0x0004,       /* Actuator RCBO                                        */
  ACT_WIFI                       = 0x0008,       /* Actuator WIFI                                        */
  ACT_BACK                       = 0x0010,       /* Battery backup enable                                */
  UNSED_MASK                     = 0x00E0        /* unused bit                                           */
} actuatorsReg_e;

/* REGISTRO EVSE_OPERATION_MODE_RW --> Address = 0x0023, 1 word */
#define MASTER_MODE_LOCAL        0x100
#define MASTER_MODE_OCPP         0x200

// --------------------------------------------------------------------------------------------------------------------------- //

// -------------------------- global constats -------------------------------------------------------------------------------- //

// --------------------------------------------------------------------------------------------------------------------------- //

// -------------------------- global references ------------------------------------------------------------------------------ //
extern frameMdbRx_st*           pMsgShared;                                                      /* Variabile globale per usare il frameMdbRx anche nel File Wi-Fi tramite una copia */
extern uint16_t                 frameLength;                                                     /* Lunghezza messaggio da inviare                                                   */
extern uint8_t                  InitModbusRegisters_Stop;

extern appMapRwRegister_st*     pAppRwRegs;
// --------------------------------------------------------------------------------------------------------------------------- //

/****************** FUNCTIONS IMPLEMENTATION **************************************************************************/
void                  scuGestTask                   (void * pvParameters);
void                  scuUartRxTimeoutTask          (void * pvParameters);
void                  scuDataLinkTask               (void * pvParameters);
void                  scuSemGestTask                (void * pvParameters);
xQueueHandle          getScuDataLinkQueueHandle     (void);
uint8_t*              getBuffRxScu                  (void);
xQueueHandle          getScuQueueHandle             (void);
xQueueHandle          getScuUartRxTimeoutQueueHandle(void);
void                  getFromScuRegister            (uint16_t regAddr, uint8_t size, uint8_t lpoAddr, uint8_t function);
void                  freeTxBuffer                  (void);
void                  scuModbus_IRQHandler          (void); 
uint8_t*              getRegInfoFromIdx             (uint16_t scuIdx, scuAllRegIdx_e scuRegIdx, uint16_t* pLen);        
scuOpModes_e          getScuOpMode                  (void);
void                  setScuOpMode                  (scuOpModes_e mode);
scuTypeModes_e        getScuTypeMode                (void);
void                  setScuTypeMode                (scuTypeModes_e typeMode);
void                  txOnRs485Bus                  (uint8_t* pTxBuffer, uint16_t len); 
void                  freeSemTxBuffer               (void);
void                  getFromModbusMap              (frameMdbRx_st* pRdRxFrame, uint16_t totalLen, scuOpModes_e opMode);
void                  setModbusInpReg               (uint8_t inpSig, GPIO_PinState state);
void                  setModbusErrorTesting         (uint8_t inpSig, GPIO_PinState state);
uint8_t               getLogicalMdbAddr             (void);
uint8_t               getPhysicalMdbAddr            (void);
uint8_t               getLogicalMdbAddrSem          (void);
scuRoMapRegister_st*  getRoMdbRegs                  (uint8_t addr);
scuRwMapRegister_st*  getRwMdbRegs                  (uint8_t addr);
appMapRwRegister_st*  getAppMdbRwRegs               (uint8_t addr);
osSemaphoreId         getScuUartInitSemaphoreHandle (void);
xQueueHandle          getScuSemQueueHandle          (void);
osSemaphoreId         getScuSinapsiTxUartSemaphoreHandle  (void);

void                  setModbusRotarySwitchCurr     (rotaryPos_e position);      
void                  setModbusMaxPowerResult       (uint32_t value);  
void                  setModbusMaxCurrentResult     (uint16_t value);
void                  setSessionId                  (unsigned int numSession); 
void                  setHwFlags                    (void); 
void                  setNumberOfLeds               (void);
uint16_t              getHwFlags                    (void); 
void                  setPowerOutage                (uint8_t power); 
uint16_t              getPowerOutage                (void);
void                  setEnergyMetersType           (void); 
void                  setStationOperationMode       (void);
uint32_t              getSessionId                  (void);
void                  setErrorModbus                (uint16_t error, uint8_t errorReg);
void                  setModbusBootEvent            (void); 
void                  setFwVersion                  (char* fwVersion);
void                  setMifareFwVersion            (char* MifarefwVersion);
uint16_t              getOperationMode              (void);
void                  setHwVersion                  (char* hwVersion);
void                  iniProductSerialNumber        (char* productSn, uint8_t length);
char*                 getProductSerialNumber        (void);
char*                 getProductCode                (void);
void                  setTecnProductCode            (char* fakeCode, uint8_t length);
char*                 getFakeProductCode            (void);
void                  setConnectorNumber            (uint8_t connPos, uint8_t connNumb); 
uint16_t              setMaxTypicalCurrent          (void);
void                  setMaxSimplifiedCurrent       (void);
void                  setUtcDateTimeRegister        (void); 
void                  setSchedulationInModbusTable  (sck_schedule_t *schedulations);
void                  setUpdateFirmwareByAppResult  (void); 
void                  setUidAuthorizationByApp      (char* uidApp);
void                  getUidAuthorizationByCard     (char* dest); 
void                  setUidAuthorizationByCard     (uint8_t* uidCard); 
void                  setSinapsiStatusForApp        (uint8_t state);
uint16_t              getPmFlags                    (void);
uint16_t              getPmPmax                     (void);
uint16_t              getPmImin                     (void);
uint16_t              getPmHpower                   (void);
uint16_t              getPmDset                     (void);
uint16_t              getPmDmax                     (void);
uint16_t              getPmEmex                     (void);
void                  setPmEmexInModbus             (uint8_t emexFlag);
uint16_t              getChargeByTime               (void);
void                  setChargeByTime               (uint16_t chargeTime); 
uint16_t              getDefaultLanguage            (void);
void                  setDefaultLanguage            (uint8_t lang);
uint32_t              getAvailableLanguages         (void);
void                  setAvailableLanguages         (uint32_t availLang);
void                  setPowerManagementRegisters   (void);
uint16_t              getPmMenuVisibility           (void);
void                  setPmMenuVisibility           (uint8_t visibility);
void                  setEvsePowerMode              (void); 
void                  setChargeTimeVisibility       (uint8_t visibility);
void                  setHwChecks                   (uint16_t checks1, uint16_t checks2);
uint16_t              getHwChecks1                  (void);
uint16_t              getHwChecks2                  (void);
uint16_t              getHwActuators                (void);
void                  setHwActuators                (uint8_t actEeprom);
void                  setActuatorsInEeprom          (uint16_t actModbus);
void                  setPmMode                     (uint8_t mode); 
void                  setTimeZone                   (uint8_t timeZone);
uint8_t               getPmMode                     (); 
void                  iniBoardSerialNumber          (char* boardSn, uint8_t length);
void                  setProductSerialNumber        (char* productSn, uint8_t length);
void                  setProductCodeString           (char* pProductCode, uint8_t length);
void                  iniProductCodeString          (char* productCode, uint8_t length);
void                  setBoardSnHwVerString         (char* pBoardStr, uint8_t length);
uint16_t              getRegisterFromModbusMap      (uint16_t addr); 
uint8_t               getRandomDelay                (void);
void                  setMallocTx485                (uint8_t* pBuff);
void                  UART_SCU_DMA_Tx               (uint8_t* pTxBuffer, uint16_t len); 
uint8_t               getCollaudoRunning            (void);
void                  setCollaudoRunning            (void);
uint8_t               getCollaudoParamWritten       (void);
uint8_t               isSemMode                     (void);
void                  setModbusVersion              (uint16_t  mdbVersion); 
void                  iniProductFakeString          (char* fakeCode, uint8_t length);
void                  setConnectorType              (void); 
void                  setChargeByEnergy             (uint16_t chargeEnrg);
uint16_t              getChargeByEnergy               (void);
void                  sendAnswToSem                 (mbError_e codeError, uint8_t ixScu, uint16_t rAddr, uint16_t len, scuEvents_e ev, uint8_t funct);
uint32_t              getMaxTempPowerAc             (void);
uint16_t              getRandomId16                 (void);
tmMapRegister_st*     getTmMdbRegs                  (uint8_t addr);
scuAddModeSktNum_e    getScuAddressTypeMode         (void);
uint8_t               setScuAddressTypeMode         (scuAddModeSktNum_e addrType);
uint8_t               setNominalPower               (uint16_t ITypical); 
uint8_t               getNumSktInProduct            (void);
void                  updateScuModbusAddrr          (void);
uint16_t              getConnectorId                (void);
void                  saveMaxTypicalCurrentEeprom   (uint8_t current);
void                  saveMaxSimplifiedCurrentEeprom  (uint8_t current);
void                  savePmModeEeprom              (uint8_t pmMode);
void                  savePmPmaxEeprom              (uint8_t* pMax);
void                  savePmIminEeprom              (uint8_t iMin); 
void                  savePmHpowerEeprom            (uint8_t hPower);
void                  savePmDsetEeprom              (uint8_t* dset);
void                  savePmDmaxEeprom              (uint8_t dMax); 
void                  saveDefaultDisplayLanguageEeprom (uint8_t lang);
void                  saveDisplayLanguagesEeprom    (uint8_t* langs);
void                  saveConnectorAliasEeprom      (uint8_t alias);
void                  saveConnectorTypeEeprom       (uint8_t conn);
uint8_t               modbusToHttpSocketConverter   (uint8_t conn);
void                  saveEnergyMetersTypeEeprom    (uint8_t* em);
uint8_t               modbusToHttpEnergyMeterConverter (uint8_t em); 
void                  saveVisibleFlagsEeprom        (uint8_t flags); 
void                  saveChargeTimeEeprom          (uint8_t timeEnum);
void                  savePowerManagementFlagsEeprom (uint8_t pmFlags);
void                  saveChargeEnergyEeprom        (uint8_t enrgEnum);
uint8_t               isSlaveWaitToBeOperative      (void); 

void                  uartReintialization           (void);
void                  UART_SCU_DMA_RX_IRQHandler    (void);
uint8_t               setPmRemoteSemFlag            (uint8_t writeImm);
uint8_t               ResetPmRemoteSemFlag          (uint8_t writeImm);
uint16_t              getMaxSimplifiedCurrent       (void);
uint16_t              getMaxTypicalCurrent          (void);
void                  setInChargeTime               (uint32_t timeCharge); 
void                  setScuTypeModeFromEeprom      (void);
void                  resetSbcGardTime              (void);
uint8_t               isSemMasterFz                 (void);

uint16_t              getScuModbusTableId           ( uint16_t idFromInterface );
void                  sendScuDataLinkMsg            (scuDlEvents_e scuDlEvents); 
void                  setEmFaultTrap                (void);

#ifdef MODBUS_TCP_EM_LOVATO
scuMapRegLovatoEmSim_st* getLovatoEthRegs           (void);
xQueueHandle          getEmLovatoQueueHandle        (void);

#endif

// --------------------------------------------------------------------------------------------------------------------------- //
#endif // _SCUMDB_H






/*************** END OF FILE ******************************************************************************************/



>>>>>>> .r29
